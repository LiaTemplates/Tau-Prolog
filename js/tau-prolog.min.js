var pl,pl,pl,pl,pl,pl,pl,pl,pl,pl;!function(){var e,r={major:0,minor:3,patch:4,status:"beta"};function t(e,r,t,n){n=void 0===n?"":n,this.name=e,this.type=r,this.parent=t,this.text=n,this.created=Date.now()/1e3,this.modified=this.created}function n(e,r){this.name=e,this.parent=r,this.files={},this.length=0,this.created=Date.now()/1e3,this.modified=this.created}t.prototype.get=function(e,r){return r===this.text.length||r>this.text.length?"end_of_stream":this.text.substring(r,r+e)},t.prototype.eof=function(e){return e===this.text.length},t.prototype.put=function(e,r){return"end_of_stream"===r?(this.text+=e,!0):"past_end_of_stream"===r?null:(this.text=this.text.substring(0,r)+e+this.text.substring(r+e.length),!0)},t.prototype.get_byte=function(e){if("end_of_stream"===e)return-1;var r=Math.floor(e/2);if(this.text.length<=r)return-1;var t=s(this.text[Math.floor(e/2)],0);return e%2==0?255&t:t/256>>>0},t.prototype.put_byte=function(e,r){var t="end_of_stream"===r?this.text.length:Math.floor(r/2);if(this.text.length<t)return null;var n=this.text.length===t?-1:s(this.text[Math.floor(r/2)],0);return n=r%2==0?(255&(n=n/256>>>0))<<8|255&e:(255&e)<<8|255&(n&=255),this.text.length===t?this.text+=p(n):this.text=this.text.substring(0,t)+p(n)+this.text.substring(t+1),!0},t.prototype.flush=function(){return!0},t.prototype.close=function(){return this.modified=Date.now()/1e3,!0},t.prototype.size=function(){return this.text.length},n.prototype.lookup=function(e){return this.files.hasOwnProperty(e)?this.files[e]:null},n.prototype.push=function(e,r){this.files.hasOwnProperty(e)||this.length++,this.files[e]=r,this.modified=Date.now()/1e3},n.prototype.remove=function(e){this.files.hasOwnProperty(e)&&(this.length--,delete this.files[e],this.modified=Date.now()/1e3)},n.prototype.empty=function(){return 0===this.length},n.prototype.size=function(){return 4096},tau_file_system={files:new n("/","/",null),open:function(e,r,n){for(var i=e.replace(/\/$/,"").split("/"),a=tau_file_system.files,o=i[i.length-1],s=1;s<i.length-1;s++)if(a=a.lookup(i[s]),!U.type.is_directory(a))return null;var p=a.lookup(o);if(null===p){if("read"===n)return null;p=new t(o,r,a),a.push(o,p)}else if(!U.type.is_file(p))return null;return"write"===n&&(p.text=""),p},get:function(e){for(var r=e.replace(/\/$/,"").split("/"),t=tau_file_system.files,n=1;n<r.length;n++){if(!U.type.is_directory(t))return null;t=t.lookup(r[n])}return t}},tau_user_input={buffer:"",get:function(e,r){for(var t;tau_user_input.buffer.length<e;){if(0===(t=window.prompt()).length)return"end_of_stream";t&&(tau_user_input.buffer+=t)}return t=tau_user_input.buffer.substr(0,e),tau_user_input.buffer=tau_user_input.buffer.substr(e),t},eof:function(e){return!1}},tau_user_output={put:function(e,r){return console.log(e),!0},flush:function(){return!0}},tau_user_error={put:function(e,r){return(console.error||console.log)(e),!0},flush:function(){return!0}},nodejs_file_system={open:function(e,r,t){var n,i=require("fs");if("read"===t&&!i.existsSync(e))return null;try{n=i.openSync(e,t[0])}catch(e){return!1}return{get:function(e,r){var t=new Buffer(e);i.readSync(n,t,0,e,r);for(var a=!0,o=t.toString(),s=0;s<e&&a;s++)a="\0"===o[s];return a?"end_of_stream":t.toString()},eof:function(r){return r===i.statSync(e).size},put:function(e,r){var t=Buffer.from(e);if("end_of_stream"===r)i.writeSync(n,t);else{if("past_end_of_stream"===r)return null;i.writeSync(n,t,0,t.length,r)}return!0},get_byte:function(e){try{var r=Buffer.alloc(1);return i.readSync(n,r,0,1,e)<1?"end_of_stream":r.readUInt8(0)}catch(e){return"end_of_stream"}},put_byte:function(e,r){var t=Buffer.from([e]);if("end_of_stream"===r)i.writeSync(n,t);else{if("past_end_of_stream"===r)return null;i.writeSync(n,t,0,t.length,r)}return!0},flush:function(){return!0},close:function(){return i.closeSync(n),!0}}}},nodejs_user_input={buffer:"",get:function(e,r){for(var t,n=require("readline-sync");nodejs_user_input.buffer.length<e;)nodejs_user_input.buffer+=n.question("",{keepWhitespace:!0})+"\n";return t=nodejs_user_input.buffer.substr(0,e),nodejs_user_input.buffer=nodejs_user_input.buffer.substr(e),t},eof:function(e){return!1}},nodejs_user_output={put:function(e,r){return process.stdout.write(e),!0},flush:function(){return!0}},nodejs_user_error={put:function(e,r){return process.stderr.write(e),!0},flush:function(){return!0}},e=Array.prototype.indexOf?function(e,r){return e.indexOf(r)}:function(e,r){for(var t=e.length,n=0;n<t;n++)if(r===e[n])return n;return-1};var a,o,s,p,y,w=function(e,r){if(0!==e.length){for(var t=e[0],n=e.length,i=1;i<n;i++)t=r(t,e[i]);return t}};a=Array.prototype.map?function(e,r){return e.map(r)}:function(e,r){for(var t=[],n=e.length,i=0;i<n;i++)t.push(r(e[i]));return t},o=Array.prototype.filter?function(e,r){return e.filter(r)}:function(e,r){for(var t=[],n=e.length,i=0;i<n;i++)r(e[i])&&t.push(e[i]);return t},s=String.prototype.codePointAt?function(e,r){return e.codePointAt(r)}:function(e,r){return e.charCodeAt(r)},p=String.fromCodePoint?function(){return String.fromCodePoint.apply(null,arguments)}:function(){return String.fromCharCode.apply(null,arguments)};var l=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;y=Array.from?function(e){return Array.from(e).length}:function(e){return e.replace(l,"_").length};var _=0,u=1,c=/(\\a)|(\\b)|(\\d)|(\\e)|(\\f)|(\\n)|(\\r)|(\\s)|(\\t)|(\\v)|\\x([0-9a-fA-F]+)\\|\\([0-7]+)\\|(\\\\)|(\\')|('')|(\\")|(\\`)|(\\.)|(.)/g,m={"\\a":7,"\\b":8,"\\d":127,"\\e":27,"\\f":12,"\\n":10,"\\r":13,"\\s":32,"\\t":9,"\\v":11};function d(e,r){var t="";if("\\"===e)return null;if(e.length<2)return e;try{e=(e=(e=e.replace(/((?:\\\\)+)|\\([0-7]+)\\/g,(function(e,r,t){return r||p(parseInt(t,8))}))).replace(/((?:\\\\)+)|\\x([0-9a-fA-F]+)\\/g,(function(e,r,t){return r||p(parseInt(t,16))}))).replace(/((?:\\\\)+)|\\u([0-9a-fA-F]{4})/g,(function(e,r,t){return r||p(parseInt(t,16))}))}catch(e){return null}for(var n=0;n<e.length;n++){var i=e.charAt(n),a=e.charAt(n+1);if(i===r&&a===r)n++,t+=r;else if("\\"===i){if(-1===["a","b","f","n","r","t","v","'",'"',"\\","a","\b","\f","\n","\r","\t","\v"].indexOf(a))return null;switch(n+=1,a){case"a":t+="a";break;case"b":t+="\b";break;case"f":t+="\f";break;case"n":t+="\n";break;case"r":t+="\r";break;case"t":t+="\t";break;case"v":t+="\v";break;case"'":t+="'";break;case'"':t+='"';break;case"\\":t+="\\"}}else t+=i}return t}function f(e){var r,t,n,i=e.substr(2);switch(e.substr(0,2).toLowerCase()){case"0x":return parseInt(i,16);case"0b":return parseInt(i,2);case"0o":return parseInt(i,8);case"0'":return(r=i,t=[],n=!1,r.replace(c,(function(e,r,i,a,o,p,y,w,l,_,u,c,d,f,h,g,v,T,V,b){switch(!0){case void 0!==c:return t.push(parseInt(c,16)),"";case void 0!==d:return t.push(parseInt(d,8)),"";case void 0!==f:case void 0!==h:case void 0!==g:case void 0!==v:case void 0!==T:return t.push(s(e.substr(1),0)),"";case void 0!==b:return t.push(s(b,0)),"";case void 0!==V:n=!0;default:return t.push(m[e]),""}})),n?null:t)[0];default:return parseFloat(e)}}function h(e){return/^[#\$\&\*\+\-\.\/\:\<\=\>\?\@\^\~\\]+/.test(e)}var g={whitespace:/^\s*(?:(?:%.*)|(?:\/\*(?:\n|\r|.)*?(?:\*\/|$))|(?:\s+))\s*/,variable:/^(?:[A-Z_][a-zA-Z0-9_]*)/,atom:/^(\!|,|;|[a-z][0-9a-zA-Z_]*|[#\$\&\*\+\-\.\/\:\<\=\>\?\@\^\~\\]+|'(?:(?:'')|(?:\\\\)|(?:\\')|[^'])*')/,number:/^(?:0o[0-7]+|0x[0-9a-fA-F]+|0b[01]+|0'(?:''|\\[abdefnrstv\\'"`]|\\x?\d+\\|[^\\])|\d+(?:\.\d+(?:[eE][+-]?\d+)?)?)/,string:/^(?:"([^"]|""|\\")*"|`([^`]|``|\\`)*`)/,l_brace:/^(?:\[)/,r_brace:/^(?:\])/,l_bracket:/^(?:\{)/,r_bracket:/^(?:\})/,bar:/^(?:\|)/,l_paren:/^(?:\()/,r_paren:/^(?:\))/};function v(e){this.thread=e,this.text="",this.tokens=[]}function T(e,r,t,n,i){if(!r[t])return{type:_,value:U.error.syntax(r[t-1],"expression expected",!0)};if("0"===n){switch((l=r[t]).name){case"number":return{type:u,len:t+1,value:new U.type.Num(l.value,l.float)};case"variable":return{type:u,len:t+1,value:new U.type.Var(l.value)};case"string":var a;switch(e.get_flag("double_quotes").id){case"atom":a=new L(l.value,[]);break;case"codes":a=new L("[]",[]);for(var o=l.value.length-1;o>=0;o--)a=new L(".",[new U.type.Num(s(l.value,o),!1),a]);break;case"chars":a=new L("[]",[]);for(o=l.value.length-1;o>=0;o--)a=new L(".",[new U.type.Term(l.value.charAt(o),[]),a])}return{type:u,len:t+1,value:a};case"l_paren":return(c=T(e,r,t+1,e.__get_max_priority(),!0)).type!==u?c:r[c.len]&&"r_paren"===r[c.len].name?(c.len++,c):{type:_,derived:!0,value:U.error.syntax(r[c.len]?r[c.len]:r[c.len-1],") or operator expected",!r[c.len])};case"l_bracket":return(c=T(e,r,t+1,e.__get_max_priority(),!0)).type!==u?c:r[c.len]&&"r_bracket"===r[c.len].name?(c.len++,c.value=new L("{}",[c.value]),c):{type:_,derived:!0,value:U.error.syntax(r[c.len]?r[c.len]:r[c.len-1],"} or operator expected",!r[c.len])}}var p=function(e,r,t,n){if(!r[t]||"atom"===r[t].name&&"."===r[t].raw&&!n&&(r[t].space||!r[t+1]||"l_paren"!==r[t+1].name))return{type:_,derived:!1,value:U.error.syntax(r[t-1],"unfounded token")};var i=r[t],a=[];if("atom"===r[t].name&&","!==r[t].raw){if(r[++t-1].space)return{type:u,len:t,value:new U.type.Term(i.value,a)};if(r[t]&&"l_paren"===r[t].name){if(r[t+1]&&"r_paren"===r[t+1].name)return{type:_,derived:!0,value:U.error.syntax(r[t+1],"argument expected")};var o=T(e,r,++t,"999",!0);if(o.type===_)return o.derived?o:{type:_,derived:!0,value:U.error.syntax(r[t]?r[t]:r[t-1],"argument expected",!r[t])};for(a.push(o.value),t=o.len;r[t]&&"atom"===r[t].name&&","===r[t].value;){if((o=T(e,r,t+1,"999",!0)).type===_)return o.derived?o:{type:_,derived:!0,value:U.error.syntax(r[t+1]?r[t+1]:r[t],"argument expected",!r[t+1])};a.push(o.value),t=o.len}if(!r[t]||"r_paren"!==r[t].name)return{type:_,derived:!0,value:U.error.syntax(r[t]?r[t]:r[t-1],", or ) expected",!r[t])};t++}return{type:u,len:t,value:new U.type.Term(i.value,a)}}return{type:_,derived:!1,value:U.error.syntax(r[t],"term expected")}}(e,r,t,i);return p.type===u||p.derived?p:(p=function(e,r,t){if(!r[t])return{type:_,derived:!1,value:U.error.syntax(r[t-1],"[ expected")};if(r[t]&&"l_brace"===r[t].name){var n=T(e,r,++t,"999",!0),i=[n.value],a=void 0;if(n.type===_)return r[t]&&"r_brace"===r[t].name?{type:u,len:t+1,value:new U.type.Term("[]",[])}:{type:_,derived:!0,value:U.error.syntax(r[t],"] expected")};for(t=n.len;r[t]&&"atom"===r[t].name&&","===r[t].value;){if((n=T(e,r,t+1,"999",!0)).type===_)return n.derived?n:{type:_,derived:!0,value:U.error.syntax(r[t+1]?r[t+1]:r[t],"argument expected",!r[t+1])};i.push(n.value),t=n.len}var o=!1;if(r[t]&&"bar"===r[t].name){if(o=!0,(n=T(e,r,t+1,"999",!0)).type===_)return n.derived?n:{type:_,derived:!0,value:U.error.syntax(r[t+1]?r[t+1]:r[t],"argument expected",!r[t+1])};a=n.value,t=n.len}return r[t]&&"r_brace"===r[t].name?{type:u,len:t+1,value:N(i,a)}:{type:_,derived:!0,value:U.error.syntax(r[t]?r[t]:r[t-1],o?"] expected":", or | or ] expected",!r[t])}}return{type:_,derived:!1,value:U.error.syntax(r[t],"list expected")}}(e,r,t),p.type===u||p.derived?p:{type:_,derived:!1,value:U.error.syntax(r[t],l.error||"unexpected token")})}e.__get_max_priority();var y=e.__get_next_priority(n),w=t;if("atom"===r[t].name&&r[t+1]&&(r[t].space||"l_paren"!==r[t+1].name)){var l=r[t++];if((f=e.__lookup_operator_classes(n,l.value))&&f.indexOf("fy")>-1){if((c=T(e,r,t,n,i)).type!==_)return"-"===l.value&&!l.space&&U.type.is_number(c.value)?{value:new U.type.Num(-c.value.value,c.value.is_float),len:c.len,type:u}:{value:new U.type.Term(l.value,[c.value]),len:c.len,type:u};c}else if(f&&f.indexOf("fx")>-1){var c;if((c=T(e,r,t,y,i)).type!==_)return{value:new U.type.Term(l.value,[c.value]),len:c.len,type:u};c}}if((c=T(e,r,t=w,y,i)).type===u){l=r[t=c.len];if(r[t]&&("atom"===r[t].name&&e.__lookup_operator_classes(n,l.value)||"bar"===r[t].name&&e.__lookup_operator_classes(n,"|"))){var m=y,d=n;if((f=e.__lookup_operator_classes(n,l.value)).indexOf("xf")>-1)return{value:new U.type.Term(l.value,[c.value]),len:++c.len,type:u};if(f.indexOf("xfx")>-1)return(h=T(e,r,t+1,m,i)).type===u?{value:new U.type.Term(l.value,[c.value,h.value]),len:h.len,type:u}:(h.derived=!0,h);if(f.indexOf("xfy")>-1)return(h=T(e,r,t+1,d,i)).type===u?{value:new U.type.Term(l.value,[c.value,h.value]),len:h.len,type:u}:(h.derived=!0,h);if(c.type!==_)for(;;){var f;if(!(l=r[t=c.len])||"atom"!==l.name||!e.__lookup_operator_classes(n,l.value))break;if((f=e.__lookup_operator_classes(n,l.value)).indexOf("yf")>-1)c={value:new U.type.Term(l.value,[c.value]),len:++t,type:u};else{if(!(f.indexOf("yfx")>-1))break;var h;if((h=T(e,r,++t,m,i)).type===_)return h.derived=!0,h;t=h.len,c={value:new U.type.Term(l.value,[c.value,h.value]),len:t,type:u}}}}else({type:_,value:U.error.syntax(r[c.len-1],"operator expected")});return c}return c}function V(e,r,t){var n,i=r[t].line,a=T(e,r,t,e.__get_max_priority(),!1),o=null;if(a.type!==_){if(r[t=a.len]&&"atom"===r[t].name&&"."===r[t].raw){if(t++,U.type.is_term(a.value)){if(":-/2"===a.value.indicator)n={value:o=new U.type.Rule(a.value.args[0],A(a.value.args[1])),len:t,type:u};else if("--\x3e/2"===a.value.indicator){if(o=function(e,r){r.session.renamed_variables={},e=e.rename(r);var t=r.next_free_variable(),n=O(e.body,t,r);if(n.error)return n.value;if(e.body=n.value,",/2"===e.head.indicator){var i=e.head.args[1];e.head=e.head.args[0];var a=r.next_free_variable(),o=i;if(!U.type.is_list(o))return U.error.type("list",o,"DCG/0");if("[]/0"===o.indicator)i=n.variable;else{for(;"./2"===o.indicator&&U.type.is_list(o)&&"[]/0"!==o.args[1].indicator;)o=o.args[1];if(U.type.is_variable(o))return U.error.instantiation("DCG/0");if(!U.type.is_list(o))return U.error.type("list",i,"DCG/0");o.args[1]=n.variable}e.body=new L(",",[e.body,new L("=",[a,i])]),e.head=new L(e.head.id,e.head.args.concat([t,a]))}else{var s=e.body;U.type.is_term(s)&&",/2"===s.indicator&&(s=s.args[0]),U.type.is_term(s)&&"=/2"===s.indicator&&U.type.is_variable(s.args[0])&&s.args[0]===t&&(t=s.args[1],e.body=e.body.replace(null)),":/2"===e.head.indicator?e.head=new L(":",[new L(e.head.args[0].id,[]),new L(e.head.args[1].id,e.head.args[1].args.concat([t,n.variable]))]):e.head=new L(e.head.id,e.head.args.concat([t,n.variable]))}return e}(o=new U.type.Rule(a.value.args[0],A(a.value.args[1])),e),o.body=A(o.body),!U.type.is_rule(o))return{value:o,len:t,type:_};n={value:o,len:t,type:U.type.is_rule(o)?u:_}}else n={value:o=new U.type.Rule(a.value,null),len:t,type:u};if(o){var s=o.singleton_variables();s.length>0&&e.throw_warning(U.warning.singleton(s,o.head.indicator,i))}return n}return{type:_,value:U.error.syntax(r[t],"callable expected")}}return{type:_,value:U.error.syntax(r[t]?r[t]:r[t-1],". or operator expected")}}return a}function b(e,r,t){var n={};t=t||{},n.success=t.success?t.success:function(){},n.error=t.error?t.error:function(){},n.from=t.from?t.from:"$tau-js",n.reconsult=void 0===t.reconsult||t.reconsult,n.reconsulted=void 0===t.reconsulted?{}:t.reconsulted,n.context_module=void 0===t.context_module?"user":t.context_module,n.initialization=void 0===t.initialization?[]:t.initialization,n.current_token=void 0===t.current_token?0:t.current_token,n.tokenizer=void 0===t.tokenizer?null:t.tokenizer,n.tokens=void 0===t.tokens?null:t.tokens,n.string=r,n.term_expansion=!1;var i=n.reconsulted,a=n.tokenizer,o=n.tokens;null===a&&((a=new v(e)).new_text(r),n.tokenizer=a,o=a.get_tokens(0),n.tokens=o);for(var s=n.current_token;null!==o&&o[s];){var p=V(e,o,s);if(n.current_token=p.len,p.type===_)return void(void 0!==n.error&&n.error(new L("throw",[p.value])));var y=n.context_module,w=e.session.modules[y].rules["term_expansion/2"];if(w&&w.length>0){n.term_expansion=!0;var l=new J(e.session),u=p.value.body?new L(":-",[p.value.head,p.value.body]):p.value.head;return e.session.renamed_variables={},u=u.rename(e.session),l.query(y+":term_expansion("+u.toString({quoted:!0})+", X)."),void l.answer(function(e,r,t,n){return function(i){if(i&&!U.type.is_error(i)&&U.type.is_term(i.links.X)){var a=i.links.X,o=":-/2"===a.indicator?new H(a.args[0],a.args[1]):new H(a,null);j(e,r,t,{value:o,len:n.len,type:n.type})}else j(e,r,t,n)}}(e,n,i,p))}if(n.term_expansion=!1,j(e,n,i,p))return;s=p.len}for(var c=n.success,m=new J(e.session),d=n.initialization.length-1;d>0;d--){var f=function(e,r){return function(t){null===t?m.answer():U.type.is_error(t)?n.error(t):(m.add_goal(e),m.answer(r))}}(n.initialization[d],c);c=f}n.initialization.length>0?(m.add_goal(n.initialization[0]),m.answer(c)):c()}function x(e,r,t){var n=new J(e.session);n.__goal_expansion=!0;var i=e.next_free_variable(),a=e.next_free_variable(),o=a+" = "+t.value.head+", goal_expansion("+t.value.body.toString({quoted:!0})+", "+i.toString({quoted:!0})+").";n.query(o),n.answer((function(n){n&&!U.type.is_error(n)&&n.links[i]?(t.value.head=n.links[a],t.value.body=A(n.links[i]),x(e,r,t)):(e.add_rule(t.value,r),b(e,r.string,r))}))}function S(e,r,t){var n=new J(e.session);n.__goal_expansion=!0;var i=e.next_free_variable(),a="goal_expansion("+r.toString({quoted:!0})+", "+i.toString({quoted:!0})+").";n.query(a);var o=n.head_point().substitution.domain();n.answer((function(n){if(n&&!U.type.is_error(n)&&n.links[i]){for(var a=0;a<o.length;a++)if(o[a]!==i.id&&n.links[o[a]]){var s=new B;s.links[n.links[o[a]]]=o[a],n.links[i]=n.links[i].apply(s)}S(e,A(n.links[i]),t)}else e.add_goal(r),t.success(r),k(e,t.string,t)}))}function j(e,r,t,n){var i=!0===r.term_expansion;if(null===n.value.body&&"?-/1"===n.value.head.indicator){i=!0;var a=new J(e.session);a.add_goal(n.value.head.args[0]),a.answer((function(t){U.type.is_error(t)?e.throw_warning(t.args[0]):!1!==t&&null!==t||e.throw_warning(U.warning.failed_goal(n.value.head.args[0],n.len)),b(e,r.string,r)}))}else if(null===n.value.body&&":-/1"===n.value.head.indicator){var s=e.run_directive(n.value.head.args[0],r);(i=i||!0===s)&&b(e,r.string,r)}else{var p=r.context_module,y=n.value.head.indicator;if(":/2"===n.value.head.indicator&&(p=n.value.head.args[0].id,y=n.value.head.args[1].indicator),t.hasOwnProperty(p)||(t[p]={}),!1!==r.reconsult&&!0!==t[p][y]&&!e.is_multifile_predicate(y)){var w=e.session.modules[p];"system"!==p&&w&&w.rules[y]&&(w.rules[y]=o(w.rules[y],(function(e){return e.dynamic})),w.update_indices_predicate(y)),t[p][y]=!0}var l=e.session.modules.user.rules["goal_expansion/2"];if(null!==n.value.body&&l&&l.length>0){i=!0,e.session.renamed_variables={};x(e,r,n,A(n.value.body))}else e.add_rule(n.value,r),i&&b(e,r.string,r)}return i}function k(e,r,t){var n={},i="function"==typeof t?t:function(){};t=void 0===t||"function"==typeof t?{}:t,n.success=void 0===t.success?i:t.success,n.error=void 0===t.error?i:t.error,n.tokenizer=void 0===t.tokenizer?null:t.tokenizer,n.current_token=void 0===t.current_token?0:t.current_token,n.string=r;var a=n.tokenizer,o=n.current_token;for(null===a&&(a=new v(e),n.tokenizer=a,a.new_text(r));;){var s=a.get_tokens(o);if(null===s)break;var p=T(e,s,0,e.__get_max_priority(),!1);if(p.type===_)return void n.error(new L("throw",[p.value]));var y=p.len;if(o=p.len+1,n.current_token=o,!s[y]||"atom"!==s[y].name||"."!==s[y].raw){var w=s[y];return void n.error(new L("throw",[U.error.syntax(w||s[y-1],w&&w.error?w.error:". or operator expected",!w)]))}p.value=A(p.value);var l=e.session.modules.user.rules["goal_expansion/2"];if(!e.__goal_expansion&&l&&l.length>0)return void S(e,p.value,n);e.add_goal(p.value),n.success(p.value)}}function O(e,r,t){var n;if(U.type.is_term(e)&&"!/0"===e.indicator)return{value:new L(",",[e,new L("=",[r,n=t.next_free_variable()])]),variable:n,error:!1};if(U.type.is_term(e)&&":/2"===e.indicator)return(a=O(e.args[1],r,t)).error?a:{value:new L(":",[e.args[0],a.value]),variable:a.variable,error:!1};if(U.type.is_term(e)&&"\\+/1"===e.indicator)return(i=O(e.args[0],r,t)).error?i:(n=t.next_free_variable(),{value:new L(",",[new L(e.id,[i.value]),new L("=",[r,n])]),variable:n,error:!1});if(!U.type.is_term(e)||",/2"!==e.indicator&&"->/2"!==e.indicator){var i,a;if(U.type.is_term(e)&&";/2"===e.indicator)return(i=O(e.args[0],r,t)).error?i:(a=O(e.args[1],r,t)).error?a:{value:new L(",",[new L(";",[i.value,a.value]),new L("=",[i.variable,a.variable])]),variable:a.variable,error:!1};if(U.type.is_term(e)&&"{}/1"===e.indicator)return n=t.next_free_variable(),{value:new L(",",[e.args[0],new L("=",[r,n])]),variable:n,error:!1};if(U.type.is_empty_list(e))return{value:new L("true",[]),variable:r,error:!1};if(U.type.is_list(e)){n=t.next_free_variable();for(var o,s=e;"./2"===s.indicator;)o=s,s.ground=!1,s=s.args[1];return U.type.is_variable(s)?{value:U.error.instantiation("DCG/0"),variable:r,error:!0}:U.type.is_empty_list(s)?(o.args[1]=n,{value:new L("=",[r,e]),variable:n,error:!1}):{value:U.error.type("list",e,"DCG/0"),variable:r,error:!0}}return U.type.is_callable(e)?(n=t.next_free_variable(),{value:e=new L(e.id,e.args.concat([r,n])),variable:n,error:!1}):{value:U.error.type("callable",e,"DCG/0"),variable:r,error:!0}}return(i=O(e.args[0],r,t)).error?i:(a=O(e.args[1],i.variable,t)).error?a:{value:new L(e.id,[i.value,a.value]),variable:a.variable,error:!1}}function A(e){if(U.type.is_variable(e))return new L("call",[e]);if(U.type.is_term(e)&&-1!==[",/2",";/2","->/2"].indexOf(e.indicator))return new L(e.id,[A(e.args[0]),A(e.args[1])]);if(U.type.is_term(e)&&":/2"===e.indicator){var r=A(e.args[1]);return new L(":",[e.args[0],r])}return e}function N(e,r){for(var t=r||new L("[]",[]),n=e.length-1;n>=0;n--)t=new L(".",[e[n],t]);return t}function R(e,r){for(var t=e.length-1;t>=0;t--)e[t]===r&&e.splice(t,1)}function M(e){for(var r={},t=[],n=0;n<e.length;n++)e[n]in r||(t.push(e[n]),r[e[n]]=!0);return t}function X(e){return function(r,t,n){var i,a=n.args[0],o=n.args.slice(1,e);if(U.type.is_term(a)&&":/2"===a.indicator){if(!U.type.is_atom(a.args[0]))return void r.throw_error(U.error.type("module",a.args[0],n.indicator));i=a.args[0],a=a.args[1]}if(U.type.is_variable(a))r.throw_error(U.error.instantiation(n.indicator));else if(U.type.is_callable(a)){var s=A(new L(a.id,a.args.concat(o)));if(!U.type.is_callable(s))return void r.throw_error(U.error.type("callable",s,n.indicator));i&&(s=new L(":",[i,s])),r.prepend([new q(t.goal.replace(s),t.substitution,t)])}else r.throw_error(U.error.type("callable",a,n.indicator))}}function P(e){for(var r=e.length-1;r>=0;r--)if("/"===e.charAt(r))return new L("/",[new L(e.substring(0,r)),new C(parseInt(e.substring(r+1)),!1)])}function E(e,r){return 0===r?e:Math.abs(E(r,e%r))}function D(e){this.id=e,this.ground=!1}function C(e,r){this.is_float=void 0!==r?r:Math.trunc(e)!==e,this.value=this.is_float?e:Math.trunc(e),this.index=this.value,this.ground=!0}v.prototype.set_last_tokens=function(e){return this.tokens=e},v.prototype.new_text=function(e){this.text=e,this.tokens=[]},v.prototype.get_tokens=function(e){var r,t,n=0,i=0,a=0,o=[];e?(n=(l=this.tokens[e-1]).len,r=function(e,r){return"on"===e.get_flag("char_conversion").id?r.replace(/./g,(function(r){return e.get_char_conversion(r)})):r}(this.thread,this.text.substr(l.len)),i=l.line,a=l.start):r=this.text;if(/^\s*$/.test(r))return null;for(;""!==r;){var s=[];if(t=!1,null===/^\n/.exec(r)){for(var p in g)if(g.hasOwnProperty(p)){var y=g[p].exec(r);y&&s.push({value:y[0],name:p,matches:y})}if(!s.length)return this.set_last_tokens([{value:r,matches:[],name:"lexical",line:i,start:a}]);var l;(l=w(s,(function(e,r){return e.value.length>=r.value.length?e:r}))).start=a,l.line=i,r=r.replace(l.value,""),a+=l.value.length,n+=l.value.length;var _=(l.value.match(/\n/g)||[]).length;switch(i+=_,_>0&&(a=l.value.length-l.value.lastIndexOf("\n")-1),l.line_count=i,l.line_position=a,l.name){case"atom":l.raw=l.value,"'"===l.value.charAt(0)&&(l.value=d(l.value.substring(1,l.value.length-1),"'"),null===l.value&&(l.name="lexical",l.value=l.raw,l.error="unknown_escape_sequence"));break;case"number":var u=l.value.substring(0,2);l.raw=l.value,l.float="0x"!==u&&"0'"!==u&&null!==l.value.match(/[.eE]/),l.value=f(l.value),l.blank=t,!l.float&&"true/0"===U.flag.bounded.value.indicator&&l.value>U.flag.max_integer.value.value&&(l.name="lexical",l.value=l.raw,l.error="int_overflow");break;case"string":var c=l.value.charAt(0);l.raw=l.value,l.value=d(l.value.substring(1,l.value.length-1),c),null===l.value&&(l.name="lexical",l.value=l.raw,l.error="unknown_escape_sequence");break;case"whitespace":var m=o[o.length-1];m&&(m.space=!0),t=!0;continue;case"r_bracket":o.length>0&&"l_bracket"===o[o.length-1].name&&((l=o.pop()).name="atom",l.value="{}",l.raw="{}",l.space=!1);break;case"r_brace":o.length>0&&"l_brace"===o[o.length-1].name&&((l=o.pop()).name="atom",l.value="[]",l.raw="[]",l.space=!1)}l.len=n,o.push(l),t=!1}else i++,a=0,n++,r=r.replace(/\n/,""),t=!0}var h=this.set_last_tokens(o);return 0===h.length?null:h};var I=0;function L(e,r,t){I++,this.ref=t||I,this.id=e,this.args=r||[],this.indicator=e+"/"+this.args.length,this.index=this.indicator,this.ground=!0;for(var n=0;n<this.args.length;n++)if(this.args[n].hasOwnProperty("ground")&&!1===this.args[n].ground){this.ground=!1;break}}var F=0;function Y(e,r,t,n,i,a){this.id=F++,this.stream=e,this.mode=r,this.alias=t,this.type=void 0!==n?n:"text",this.reposition=void 0===i||i,this.eof_action=void 0!==a?a:"eof_code",this.position="append"===this.mode?"end_of_stream":0,this.output="write"===this.mode||"append"===this.mode,this.input="read"===this.mode,this.line_position=0,this.line_count=1,this.char_count=0}function B(e,r){e=e||{},r=r||{},this.links=e,this.attrs=r}function q(e,r,t){r=r||new B,t=t||null,this.goal=e,this.substitution=r,this.parent=t}function H(e,r,t){this.head=e,this.body=r,this.dynamic=t||!1}function G(e){e="number"==typeof e&&e>0?e:null,this.rename=0,this.modules={},this.modules.user=new $("user",{},"all",{session:this,dependencies:["system"]}),this.modules.system=U.modules.system,this.rules=this.modules.user.rules,this.total_threads=0,this.renamed_variables={},this.public_predicates=this.modules.user.public_predicates,this.multifile_predicates=this.modules.user.multifile_predicates,this.limit=e,this.streams={user_input:new Y(z?nodejs_user_input:tau_user_input,"read","user_input","text",!1,"reset"),user_output:new Y(z?nodejs_user_output:tau_user_output,"append","user_output","text",!1,"reset"),user_error:new Y(z?nodejs_user_error:tau_user_error,"append","user_error","text",!1,"reset")},this.file_system=z?nodejs_file_system:tau_file_system,this.standard_input=this.streams.user_input,this.standard_output=this.streams.user_output,this.standard_error=this.streams.user_error,this.current_input=this.streams.user_input,this.current_output=this.streams.user_output,this.working_directory="/",this.format_success=function(e){return e.substitution},this.format_error=function(e){return e.goal},this.flag={bounded:U.flag.bounded.value,max_integer:U.flag.max_integer.value,min_integer:U.flag.min_integer.value,integer_rounding_function:U.flag.integer_rounding_function.value,char_conversion:U.flag.char_conversion.value,debug:U.flag.debug.value,max_arity:U.flag.max_arity.value,unknown:U.flag.unknown.value,double_quotes:U.flag.double_quotes.value,occurs_check:U.flag.occurs_check.value,dialect:U.flag.dialect.value,version_data:U.flag.version_data.value,nodejs:U.flag.nodejs.value,argv:U.flag.argv.value},this.__loaded_modules=[],this.__char_conversion={},this.__operators={1200:{":-":["fx","xfx"],"--\x3e":["xfx"],"?-":["fx"]},1150:{meta_predicate:["fx"]},1100:{";":["xfy"]},1050:{"->":["xfy"],"*->":["xfy"]},1e3:{",":["xfy"]},900:{"\\+":["fy"]},700:{"=":["xfx"],"\\=":["xfx"],"==":["xfx"],"\\==":["xfx"],"@<":["xfx"],"@=<":["xfx"],"@>":["xfx"],"@>=":["xfx"],"=..":["xfx"],is:["xfx"],"=:=":["xfx"],"=\\=":["xfx"],"<":["xfx"],"=<":["xfx"],">":["xfx"],">=":["xfx"]},600:{":":["xfy"]},500:{"+":["yfx"],"-":["yfx"],"/\\":["yfx"],"\\/":["yfx"]},400:{"*":["yfx"],"/":["yfx"],"//":["yfx"],rem:["yfx"],mod:["yfx"],"<<":["yfx"],">>":["yfx"],div:["yfx"]},200:{"**":["xfx"],"^":["xfy"],"-":["fy"],"+":["fy"],"\\":["fy"]}},this.thread=new J(this)}function J(e){this.epoch=Date.now(),this.session=e,this.session.total_threads++,this.format_success=e.format_success,this.format_error=e.format_error,this.total_steps=0,this.cpu_time=0,this.points=[],this.debugger=!1,this.debugger_states=[],this.level=new L("top_level"),this.current_limit=this.session.limit,this.has_limit=null!==this.session.limit,this.warnings=[],this.__calls=[],this.__goal_expansion=!1,this.__stacks={}}function $(e,r,t,n){if((n=void 0===n?{}:n).public_predicates=void 0===n.public_predicates?{}:n.public_predicates,n.multifile_predicates=void 0===n.multifile_predicates?{}:n.multifile_predicates,n.meta_predicates=void 0===n.meta_predicates?{}:n.meta_predicates,n.session=void 0===n.session?null:n.session,n.dependencies=void 0===n.dependencies?[]:n.dependencies,this.id=e,this.rules=r,this.indexed_clauses={},this.non_indexable_clauses={},this.public_predicates=n.public_predicates,this.multifile_predicates=n.multifile_predicates,this.meta_predicates=n.meta_predicates,this.src_predicates={},this.dependencies=n.dependencies,this.exports=t,this.is_library=null===n.session,this.modules={},n.session){n.session.modules[e]=this;for(var i=0;i<n.dependencies.length;i++){var a=n.dependencies[i];n.session.modules.hasOwnProperty(a)||(n.session.modules[a]=U.modules[a])}}else U.modules[e]=this;if("all"!==t)for(i=0;i<t.length;i++)this.public_predicates[t[i]]=n.public_predicates.hasOwnProperty(t[i])&&!0===n.public_predicates[t[i]];this.update_indices_clauses()}$.prototype.exports_predicate=function(r){return"all"===this.exports||-1!==e(this.exports,r)},$.prototype.is_public_predicate=function(e){return!this.public_predicates.hasOwnProperty(e)||!0===this.public_predicates[e]},$.prototype.is_multifile_predicate=function(e){return this.multifile_predicates.hasOwnProperty(e)&&!0===this.multifile_predicates[e]},$.prototype.is_meta_predicate=function(e){return this.meta_predicates.hasOwnProperty(e)?this.meta_predicates[e]:null},$.prototype.update_indices_clauses=function(){for(var e in this.indexed_clauses={},this.non_indexable_clauses={},this.rules)this.update_indices_predicate(e)},$.prototype.update_indices_predicate=function(e){if(this.indexed_clauses[e]={},this.non_indexable_clauses[e]=[],Array.isArray(this.rules[e]))for(var r=0;r<this.rules[e].length;r++){var t=this.rules[e][r];this.add_index_predicate(t)}},$.prototype.add_index_predicate=function(e){var r=e.head.indicator;if(n=e.head.args.length>0?e.head.args[0].index:void 0){if(this.indexed_clauses.hasOwnProperty(r)||(this.indexed_clauses[r]={}),!this.indexed_clauses[r].hasOwnProperty(n)&&(this.indexed_clauses[r][n]=[],this.non_indexable_clauses.hasOwnProperty(r)))for(var t=0;t<this.non_indexable_clauses[r].length;t++)this.indexed_clauses[r][n].push(this.non_indexable_clauses[r][t]);this.indexed_clauses[r][n].push(e)}else for(var n in this.non_indexable_clauses.hasOwnProperty(r)||(this.non_indexable_clauses[r]=[]),this.non_indexable_clauses[r].push(e),this.indexed_clauses[r])this.indexed_clauses[r][n].push(e)},D.prototype.unify=function(r,t){if(t&&-1!==e(r.variables(),this.id)&&!U.type.is_variable(r))return null;var n={};return n[this.id]=r,new B(n)},C.prototype.unify=function(e,r){return U.type.is_number(e)&&this.value===e.value&&this.is_float===e.is_float?new B:null},L.prototype.unify=function(e,r){if(!U.type.is_term(e)&&void 0!==e.unify)return e.unify(this,r);if(U.type.is_term(e)&&this.indicator===e.indicator){for(var t=new B,n=0;n<this.args.length;n++){var i=U.unify(this.args[n].apply(t),e.args[n].apply(t),r);if(null===i)return null;for(var a in i.links)t.links[a]=i.links[a];t=t.apply(i)}return t}return null},Y.prototype.unify=function(e,r){return U.type.is_stream(e)&&this.id===e.id?new B:null},Y.prototype.compare=function(e){return this.id<e.id?-1:this.id===e.id?0:1},D.prototype.toString=function(e){if((e=void 0===e?{}:e).variable_names)for(var r=e.variable_names;U.type.is_term(r)&&"./2"===r.indicator;){var t=r.args[0];if(U.type.is_term(t)&&"=/2"===t.indicator&&U.type.is_variable(t.args[1])&&t.args[1].id===this.id&&U.type.is_atom(t.args[0]))return t.args[0].id;r=r.args[1]}return this.id},C.prototype.toString=function(r){var t=this.value.toString();return-1!==t.indexOf("e")?-1!==t.indexOf(".")?t:t.replace("e",".0e"):this.is_float&&-1===e(t,".")?this.value+".0":t},L.prototype.toString=function(r,t,n){(r=r||{}).quoted=void 0!==r.quoted&&r.quoted,r.ignore_ops=void 0!==r.ignore_ops&&r.ignore_ops,r.numbervars=void 0!==r.numbervars&&r.numbervars,r.variable_names=void 0!==r.variable_names&&r.variable_names,t=void 0===t?{priority:1200,class:"",indicator:""}:t,n=void 0===n?"":n;var i={priority:999,class:"",indicator:""};if(r.numbervars&&"$VAR/1"===this.indicator&&U.type.is_integer(this.args[0])&&this.args[0].value>=0){var o=this.args[0].value,s=Math.floor(o/26);return"ABCDEFGHIJKLMNOPQRSTUVWXYZ"[o%26]+(0!==s?s:"")}switch(this.indicator){case"[]/0":case"{}/0":case"!/0":return this.id;case"{}/1":return!1===r.ignore_ops?"{"+this.args[0].toString(r)+"}":"{}("+this.args[0].toString(r)+")";case"./2":if(!1===r.ignore_ops){for(var p="["+this.args[0].toString(r,i),y=this.args[1];"./2"===y.indicator;)p+=","+y.args[0].toString(r,i),y=y.args[1];return"[]/0"!==y.indicator&&(p+="|"+y.toString(r,i)),p+="]"}default:var w=this.id,l=r.session?r.session.lookup_operator(this.id,this.args.length):null;if(void 0===r.session||r.ignore_ops||null===l)return r.quoted&&(!/^(!|[a-z][0-9a-zA-Z_]*|[#\$\&\*\+\-\.\/\:\<\=\>\?\@\^\~\\]+)$/.test(w)&&"{}"!==w&&"[]"!==w||-1!==e([".",",",";"],w)||"/*"===w.substring(0,2))&&(w="'"+function(e){for(var r="",t=0;t<e.length;t++)switch(e.charAt(t)){case"'":r+="\\'";break;case"\\":r+="\\\\";break;case"\b":r+="\\b";break;case"\f":r+="\\f";break;case"\n":r+="\\n";break;case"\r":r+="\\r";break;case"\t":r+="\\t";break;case"\v":r+="\\v";break;default:r+=e.charAt(t)}return r}(w)+"'"),0===this.args.length&&h(this.id)&&""!==t.indicator?"("+w+")":w+(this.args.length>0?"("+a(this.args,(function(e){return e.toString(r,i)})).join(",")+")":"");var _=parseInt(l.priority),u=parseInt(t.priority),c=_>u||_===u&&("xfx"===l.class||"xfy"===l.class&&this.indicator!==t.indicator||"yfx"===l.class&&this.indicator!==t.indicator||this.indicator===t.indicator&&"yfx"===l.class&&"right"===n||this.indicator===t.indicator&&"xfy"===l.class&&"left"===n||this.indicator===t.indicator&&"xf"===l.class&&"left"===n||this.indicator===t.indicator&&"fx"===l.class&&"right"===n);l.indicator=this.indicator;var m=c?"(":"",d=c?")":"",f=!h(this.id)&&","!==this.id&&";"!==this.id||2===l.class.length||3===l.class.length&&U.type.is_number(this.args[1])&&this.args[1].value<0?" ":"";return 0===this.args.length?m+this.id+d:-1!==["fy","fx"].indexOf(l.class)?m+w+f+this.args[0].toString(r,l,"right")+d:-1!==["yf","xf"].indexOf(l.class)?m+this.args[0].toString(r,l,"left")+f+w+d:m+this.args[0].toString(r,l,"left")+f+this.id+f+this.args[1].toString(r,l,"right")+d}},Y.prototype.toString=function(e){return"<stream>("+this.id+")"},B.prototype.toString=function(e){var r="{";for(var t in this.links)this.links.hasOwnProperty(t)&&("{"!==r&&(r+=", "),r+=t+"/"+this.links[t].toString(e));return r+="}"},q.prototype.toString=function(e){return null===this.goal?"<"+this.substitution.toString(e)+">":"<"+this.goal.toString(e)+", "+this.substitution.toString(e)+">"},H.prototype.toString=function(e){return this.body?this.head.toString(e,1200,"left")+" :- "+this.body.toString(e,1200,"right")+".":this.head.toString(e)+"."},G.prototype.toString=function(e){var r="";for(var t in this.modules)this.modules.hasOwnProperty(t)&&this.modules[t].is_library&&(r+=":- use_module(library("+this.modules[t]+")).\n");for(var n in r+="\n",this.modules.user.rules)if(this.modules.user.rules.hasOwnProperty(n))for(i=0;i<this.modules.user.rules[n].length;i++)r+=this.modules.user.rules[n][i].toString(e),r+="\n";return r},D.prototype.clone=function(){return new D(this.id)},C.prototype.clone=function(){return new C(this.value,this.is_float)},L.prototype.clone=function(){var e=new L(this.id,a(this.args,(function(e){return e.clone()})));return this.definition_module&&(e.definition_module=this.definition_module),e},Y.prototype.clone=function(){return new Y(this.stream,this.mode,this.alias,this.type,this.reposition,this.eof_action)},B.prototype.clone=function(){var e={},r={};for(var t in this.links)this.links.hasOwnProperty(t)&&(e[t]=this.links[t].clone());for(var n in this.attrs)if(this.attrs.hasOwnProperty(r))for(var i in r[n]={},this.attrs[n])this.attrs[n].hasOwnProperty(i)&&(r[n][i]=this.attrs[n][i].clone());return new B(e,r)},q.prototype.clone=function(){return new q(this.goal.clone(),this.substitution.clone(),this.parent)},H.prototype.clone=function(){return new H(this.head.clone(),null!==this.body?this.body.clone():null)},D.prototype.equals=function(e){return U.type.is_variable(e)&&this.id===e.id},C.prototype.equals=function(e){return U.type.is_number(e)&&this.value===e.value&&this.is_float===e.is_float},L.prototype.equals=function(e){if(!U.type.is_term(e)||this.indicator!==e.indicator)return!1;for(var r=0;r<this.args.length;r++)if(!this.args[r].equals(e.args[r]))return!1;return!0},Y.prototype.equals=function(e){return U.type.is_stream(e)&&this.id===e.id},B.prototype.equals=function(e){var r;if(!U.type.is_substitution(e))return!1;for(r in this.links)if(this.links.hasOwnProperty(r)&&(!e.links[r]||!this.links[r].equals(e.links[r])))return!1;for(r in e.links)if(e.links.hasOwnProperty(r)&&!this.links[r])return!1;return!0},q.prototype.equals=function(e){return U.type.is_state(e)&&this.goal.equals(e.goal)&&this.substitution.equals(e.substitution)&&this.parent===e.parent},H.prototype.equals=function(e){return U.type.is_rule(e)&&this.head.equals(e.head)&&(null===this.body&&null===e.body||null!==this.body&&this.body.equals(e.body))},D.prototype.rename=function(e){return e.get_free_variable(this)},C.prototype.rename=function(e){return this},L.prototype.rename=function(e){if(this.ground)return new L(this.id,this.args);if("./2"===this.indicator){for(var r=[],t=this;"./2"===t.indicator&&!t.ground;){var n=t.args[0].rename(e);r.push(n),t=t.args[1]}for(var i=t.rename(e),a=r.length-1;a>=0;a--)i=new L(".",[r[a],i]);return i}var o=[];for(a=0;a<this.args.length;a++){n=this.args[a].rename(e);o.push(n)}return new L(this.id,o)},Y.prototype.rename=function(e){return this},H.prototype.rename=function(e){return new H(this.head.rename(e),null!==this.body?this.body.rename(e):null)},D.prototype.is_rename=function(e,r){return r=r||{},!(!U.type.is_variable(e)||r.hasOwnProperty(this.id)&&r[this.id]!==e.id||r.hasOwnProperty(e.id)&&r[e.id]!==this.id)&&(r[this.id]=e.id,r[e.id]=this.id,!0)},C.prototype.is_rename=function(e,r){return this.equals(e)},L.prototype.is_rename=function(e,r){if(r=r||{},!U.type.is_term(e)||this.indicator!==e.indicator)return!1;for(var t=0;t<this.args.length;t++)if(!U.is_rename(this.args[t],e.args[t],r))return!1;return!0},Y.prototype.is_rename=function(e,r){return this.equals(e)},D.prototype.variables=function(){return[this.id]},C.prototype.variables=function(){return[]},L.prototype.variables=function(){return this.ground?[]:[].concat.apply([],a(this.args,(function(e){return e.variables()})))},Y.prototype.variables=function(){return[]},H.prototype.variables=function(){return null===this.body?this.head.variables():this.head.variables().concat(this.body.variables())},D.prototype.apply=function(e){return e.lookup(this.id)?e.lookup(this.id):this},C.prototype.apply=function(e){return this},L.prototype.apply=function(e){if(this.ground)return this;if("./2"===this.indicator){for(var r=[],t=this;"./2"===t.indicator&&!t.ground;){var n=t.args[0].apply(e);r.push(n),t=t.args[1]}for(var i=t.apply(e),a=r.length-1;a>=0;a--)i=new L(".",[r[a],i]);return i}var o=[];for(a=0;a<this.args.length;a++){n=this.args[a].apply(e);o.push(n)}return new L(this.id,o,this.ref)},Y.prototype.apply=function(e){return this},H.prototype.apply=function(e){return new H(this.head.apply(e),null!==this.body?this.body.apply(e):null)},B.prototype.apply=function(e){var r,t,n,i={},a={};for(r in this.links)this.links.hasOwnProperty(r)&&(i[r]=this.links[r].apply(e));for(t in this.attrs)if(this.attrs.hasOwnProperty(t))for(n in a[t]={},this.attrs[t])this.attrs[t].hasOwnProperty(n)&&(a[t][n]=this.attrs[t][n].apply(e));return new B(i,a)},L.prototype.select=function(){for(var e=this;U.type.is_term(e)&&",/2"===e.indicator;)e=e.args[0];return e},L.prototype.replace=function(e){return",/2"===this.indicator?",/2"===this.args[0].indicator?new L(",",[this.args[0].replace(e),this.args[1]]):null===e?this.args[1]:new L(",",[e,this.args[1]]):e},L.prototype.search=function(e){if(this==e||this.ref===e.ref)return!0;for(var r=0;r<this.args.length;r++)if(U.type.is_term(this.args[r])&&this.args[r].search(e))return!0;return!1},G.prototype.push_global_stack=function(e,r){return this.thread.push_global_stack(e,r)},J.prototype.push_global_stack=function(e,r){this.__stacks.hasOwnProperty(e)||(this.__stacks[e]=[]),this.__stacks[e].push(r)},G.prototype.flush_global_stack=function(e,r){return this.thread.push_global_stack(e,r)},J.prototype.flush_global_stack=function(e,r){var t=r||new L("[]",[]);if(this.__stacks.hasOwnProperty(e)){for(;this.__stacks[e].length>0;)t=new L(".",[this.__stacks[e].pop(),t]);delete this.__stacks[e]}return t},G.prototype.setMaxInferences=function(e){this.limit="number"==typeof e&&e>0?e:null},J.prototype.setMaxInferences=function(e){this.session.setMaxInferences(e),this.current_limit=this.session.limit,this.has_limit=null!==this.session.limit},G.prototype.format_answer=function(e,r){return this.thread.format_answer(e,r)},J.prototype.format_answer=function(e,r){return U.format_answer(e,this,r)},G.prototype.get_current_input=function(){return this.current_input},J.prototype.get_current_input=function(){return this.session.get_current_input()},G.prototype.get_current_output=function(){return this.current_output},J.prototype.get_current_output=function(){return this.session.get_current_output()},G.prototype.set_current_input=function(e){this.current_input=e},J.prototype.set_current_input=function(e){return this.session.set_current_input(e)},G.prototype.set_current_output=function(e){this.current_output=e},J.prototype.set_current_output=function(e){return this.session.set_current_output(e)},G.prototype.get_stream_by_alias=function(e){return this.streams[e]},J.prototype.get_stream_by_alias=function(e){return this.session.get_stream_by_alias(e)},G.prototype.file_system_open=function(e,r,t){return"false/0"===this.get_flag("nodejs").indicator&&(e=this.absolute_file_name(e)),this.file_system.open(e,r,t)},J.prototype.file_system_open=function(e,r,t){return this.session.file_system_open(e,r,t)},G.prototype.absolute_file_name=function(e){var r;if("true/0"===this.get_flag("nodejs").indicator){var t=require("path");for(var n in r=e,process.env)process.env.hasOwnProperty(n)&&(r=r.replace(new RegExp("\\$"+n,"g"),process.env[n]));return t.resolve(r)}for(var i=this.working_directory,a=(r=(r="/"===e[0]?e:i+("/"===i[i.length-1]?e:"/"+e)).replace(/\/\.\//g,"/")).split("/"),o=[],s=0;s<a.length;s++)".."!==a[s]?o.push(a[s]):0!==o.length&&o.pop();return r=o.join("/").replace(/\/\.$/,"/")},J.prototype.absolute_file_name=function(e,r){return this.session.absolute_file_name(e,r)},G.prototype.get_char_conversion=function(e){return this.__char_conversion[e]||e},J.prototype.get_char_conversion=function(e){return this.session.get_char_conversion(e)},G.prototype.parse=function(e){return this.thread.parse(e)},J.prototype.parse=function(e){var r=new v(this);r.new_text(e);var t=r.get_tokens();if(null===t)return!1;var n=T(this,t,0,this.__get_max_priority(),!1);return n.len===t.length&&{value:n.value,expr:n,tokens:t}},G.prototype.get_flag=function(e){return this.flag[e]},J.prototype.get_flag=function(e){return this.session.get_flag(e)},G.prototype.add_rule=function(e,r){return this.thread.add_rule(e,r)},J.prototype.add_rule=function(e,r){var t,n;if((r=r||{}).from=r.from?r.from:"$tau-js",U.type.is_term(e.head)&&":/2"===e.head.indicator){if(!U.type.is_atom(e.head.args[0]))return void this.throw_warning(U.error.type("module",e.head.args[0],"top_level/0"));t=e.head.args[0].id,e.head=e.head.args[1]}return t?(n=this.session.modules[t],U.type.is_module(n)||(n=new $(t,{},"all",{session:this.session}),this.session.modules[t]=n)):n=this.session.modules[r.context_module],n.src_predicates[e.head.indicator]=r.from,n.rules.hasOwnProperty(e.head.indicator)||(n.rules[e.head.indicator]=[]),n.rules[e.head.indicator].push(e),n.public_predicates.hasOwnProperty(e.head.indicator)||(n.public_predicates[e.head.indicator]=!1),n.add_index_predicate(e),!0},G.prototype.run_directive=function(e,r){return this.thread.run_directive(e,r)},J.prototype.run_directive=function(e,r){return!!U.type.is_directive(e)&&(U.directive[e.indicator]?U.directive[e.indicator](this,e,r):U.directive[e.id+"/*"](this,e,r))},G.prototype.__get_max_priority=function(){return"1200"},J.prototype.__get_max_priority=function(){return this.session.__get_max_priority()},G.prototype.__get_next_priority=function(e){var r=0;for(var t in e=parseInt(e),this.__operators)if(this.__operators.hasOwnProperty(t)){var n=parseInt(t);n>r&&n<e&&(r=n)}return r.toString()},J.prototype.__get_next_priority=function(e){return this.session.__get_next_priority(e)},G.prototype.__lookup_operator_classes=function(e,r){return this.__operators.hasOwnProperty(e)&&this.__operators[e][r]instanceof Array&&this.__operators[e][r]||!1},J.prototype.__lookup_operator_classes=function(e,r){return this.session.__lookup_operator_classes(e,r)},G.prototype.lookup_operator=function(e,r){for(var t in this.__operators)if(this.__operators[t][e])for(var n=0;n<this.__operators[t][e].length;n++)if(this.__operators[t][e][n].length===r+1)return{priority:t,class:this.__operators[t][e][n]};return null},J.prototype.lookup_operator=function(e,r){return this.session.lookup_operator(e,r)},G.prototype.throw_warning=function(e){this.thread.throw_warning(e)},J.prototype.throw_warning=function(e){this.warnings.push(e)},G.prototype.get_warnings=function(){return this.thread.get_warnings()},J.prototype.get_warnings=function(){return this.warnings},G.prototype.add_goal=function(e,r){this.thread.add_goal(e,r)},J.prototype.add_goal=function(e,r,t){t=t||null,!0===r&&(this.points=[]);for(var n=e.variables(),i={},a=0;a<n.length;a++)i[n[a]]=new D(n[a]);this.points.push(new q(e,new B(i),t))},G.prototype.consult=function(e,r){return this.thread.consult(e,r)},J.prototype.consult=function(e,r){var t="",n=!1,i={},a="function"==typeof r?r:function(){};if(r=void 0===r||"function"==typeof r?{}:r,i.context_module=void 0===r.context_module?"user":r.context_module,i.text=void 0===r.text||r.text,i.html=void 0===r.html||r.html,i.url=void 0===r.url||r.url,i.file=void 0===r.file||r.file,i.script=void 0===r.script||r.script,i.success=void 0===r.success?a:r.success,i.error=void 0===r.error?a:r.error,"string"==typeof e){if(t=e,i.script&&"false/0"===this.get_flag("nodejs").indicator&&""!=e&&document.getElementById(t)){var o=document.getElementById(t),s=o.getAttribute("type");null!==s&&"text/prolog"===s.replace(/ /g,"").toLowerCase()&&(t=o.text,n=!0)}if(!n&&i.file&&"true/0"===this.get_flag("nodejs").indicator){var p=require("fs"),y=this;return void p.readFile(e,(function(r,t){r?(i.file=!1,y.consult(e,i)):b(y,t.toString(),i)}))}if(!n&&"false/0"===this.get_flag("nodejs").indicator&&i.url&&""!==e&&!/\s/.test(e))try{var w=new XMLHttpRequest;y=this;return w.onreadystatechange=function(){4==this.readyState&&(200==this.status?(t=w.responseText,n=!0,b(y,t,i)):(i.url=!1,y.consult(e,i)))},w.open("GET",e,!0),void w.send()}catch(e){return void i.error(e)}!n&&i.text&&(n=!0)}else if(i.html&&e.nodeName)switch(e.nodeName.toLowerCase()){case"input":case"textarea":t=e.value,n=!0;break;default:t=e.innerHTML,n=!0}else i.error(U.error.existence("source_sink",new L(t),"top_level/0"));this.warnings=[],b(this,t,i)},G.prototype.query=function(e,r){return this.thread.query(e,r)},J.prototype.query=function(e,r){return this.points=[],this.debugger_states=[],this.level=new L("top_level"),k(this,e,r)},G.prototype.head_point=function(){return this.thread.head_point()},J.prototype.head_point=function(){return this.points[this.points.length-1]},G.prototype.get_free_variable=function(e){return this.thread.get_free_variable(e)},J.prototype.get_free_variable=function(r){var t=[];if("_"===r.id||void 0===this.session.renamed_variables[r.id]){for(this.session.rename++,this.current_point&&(t=this.current_point.substitution.domain());-1!==e(t,U.format_variable(this.session.rename,r.id));)this.session.rename++;if("_"===r.id)return new D(U.format_variable(this.session.rename,r.id));this.session.renamed_variables[r.id]=U.format_variable(this.session.rename,r.id)}return new D(this.session.renamed_variables[r.id])},G.prototype.next_free_variable=function(){return this.thread.next_free_variable()},J.prototype.next_free_variable=function(){this.session.rename++;var r=[];for(this.current_point&&(r=this.current_point.substitution.domain());-1!==e(r,U.format_variable(this.session.rename));)this.session.rename++;return new D(U.format_variable(this.session.rename))},G.prototype.is_public_predicate=function(e,r){return r=void 0===r?"user":r,U.type.is_module(this.modules[r])&&this.modules[r].is_public_predicate(e)},J.prototype.is_public_predicate=function(e,r){return this.session.is_public_predicate(e,r)},G.prototype.is_multifile_predicate=function(e,r){return r=void 0===r?"user":r,U.type.is_module(this.modules[r])&&this.modules[r].is_multifile_predicate(e)},J.prototype.is_multifile_predicate=function(e,r){return this.session.is_multifile_predicate(e,r)},G.prototype.is_meta_predicate=function(e,r){return r=void 0===r?"user":r,U.type.is_module(this.modules[r])?this.modules[r].is_meta_predicate(e):null},J.prototype.is_meta_predicate=function(e,r){return this.session.is_meta_predicate(e,r)},G.prototype.prepend=function(e){return this.thread.prepend(e)},J.prototype.prepend=function(e){for(var r=e.length-1;r>=0;r--)this.points.push(e[r])},G.prototype.success=function(e,r){return this.thread.success(e,r)},J.prototype.success=function(e,r){r=void 0===r?e:r;this.prepend([new q(e.goal.replace(null),e.substitution,r)])},G.prototype.throw_error=function(e){return this.thread.throw_error(e)},J.prototype.throw_error=function(e){U.type.is_variable(e)&&(e=U.error.instantiation(this.level.indicator));var r=new q(new L("throw",[e]),new B,null);r.error=!0,this.prepend([r])},G.prototype.lookup_module=function(e,r){return this.thread.lookup_module(e,r)},J.prototype.lookup_module=function(e,r){var t=this.session.modules[r];if(U.type.is_module(t)||(t=this.session.modules.user),t.rules.hasOwnProperty(e.indicator)&&(t.exports_predicate(e.indicator)||t.rules.hasOwnProperty(this.level.indicator)||r===t.id))return t;for(var n in t.modules.system=U.modules.system,t.modules.user=this.session.modules.user,t.modules){if(this.session.modules.hasOwnProperty(n))if((t=this.session.modules[n]).rules.hasOwnProperty(e.indicator)&&(t.exports_predicate(e.indicator)||t.rules.hasOwnProperty(this.level.indicator)||r===t.id))return t}return null},G.prototype.expand_meta_predicate=function(e,r,t){return this.thread.expand_meta_predicate(e,r,t)},J.prototype.expand_meta_predicate=function(r,t,n){var i=this.session.modules[t];if(i){var a=i.is_meta_predicate(r.indicator);if(a)for(var o=0;o<a.args.length;o++)if(U.type.is_integer(a.args[o])||U.type.is_atom(a.args[o])&&-1!==e([":"],a.args[o].id))U.type.is_term(r.args[o])&&":/2"===r.args[o].indicator||(r.args[o]=new L(":",[new L(n),r.args[o]]));else if(U.type.is_atom(a.args[o])&&"^"===a.args[o].id){for(var s=r,p=o,y=r.args[o];U.type.is_term(y)&&"^/2"===y.indicator;)s=y,p=1,y=y.args[1];U.type.is_term(y)&&":/2"===y.indicator||(s.args[p]=new L(":",[new L(n),y]))}}},G.prototype.step=function(){return this.thread.step()},J.prototype.step=function(){if(0!==this.points.length){var e=!1,r=this.points.pop();this.current_point=r,this.debugger&&this.debugger_states.push(r);var t=U.type.is_term(r.goal)?r.goal.select():r.goal;if(U.type.is_term(t)&&(":/2"!==t.indicator||U.type.is_term(t.args[1]))){var n=null,i=[];if(null!==t){this.total_steps++;for(var a=r;null!==a.parent&&a.parent.goal.search(t);)a=a.parent;if(null===a.parent?this.level=new L("top_level"):(this.level=a.parent.goal.select(),":/2"===this.level.indicator&&(this.level=this.level.args[1])),U.type.is_term(t)&&":/2"===t.indicator){if(n=t.args[0],t=t.args[1],!U.type.is_atom(n))return void this.throw_error(U.error.type("module",n,this.level.indicator));n=n.id}else n=this.level.definition_module?this.level.definition_module:"user";if(t.context_module=n,",/2"===t.indicator)return void this.prepend([new q(r.goal.replace(new L(",",[new L(":",[new L(n),t.args[0]]),new L(":",[new L(n),t.args[1]])])),r.substitution,r)]);this.__call_indicator=t.indicator;var o=this.lookup_module(t,n);t.definition_module=U.type.is_module(o)?o.id:"user",this.expand_meta_predicate(t,t.definition_module,n);var s=null;if(null===(s=o&&t.args.length>0&&t.args[0].index&&o.indexed_clauses.hasOwnProperty(t.indicator)&&o.indexed_clauses[t.indicator].hasOwnProperty(t.args[0].index)?o.indexed_clauses[t.indicator][t.args[0].index]:null===o?null:o.rules[t.indicator]))this.session.modules.user.rules.hasOwnProperty(t.indicator)||("error"===this.get_flag("unknown").id?this.throw_error(U.error.existence("procedure",t.indicator,this.level.indicator)):"warning"===this.get_flag("unknown").id&&this.throw_warning("unknown procedure "+t.indicator+" (from "+this.level.indicator+")"));else if(s instanceof Function)e=s(this,r,t);else{this.__goal_expansion&&"goal_expansion/2"===t.indicator&&(s=s.concat(U.builtin.rules["goal_expansion/2"]));for(var p=0;p<s.length;p++){this.session.renamed_variables={};var y=s[p].rename(this),w="true/0"===this.get_flag("occurs_check").indicator,l=U.unify(t,y.head,w);if(null!==l){var _=new q;_.goal=r.goal.replace(y.body),null!==_.goal&&(_.goal=_.goal.apply(l)),_.substitution=r.substitution.apply(l),_.parent=r,i.push(_)}}this.prepend(i)}}}else{var u=U.type.is_term(t)&&":/2"===t.indicator?t.args[1]:t;U.type.is_variable(u)?this.throw_error(U.error.instantiation(this.level.indicator)):this.throw_error(U.error.type("callable",u,this.level.indicator))}return e}},G.prototype.answer=function(e){return this.thread.answer(e)},J.prototype.answer=function(e){var r={};"function"==typeof(e=e||function(){})?r={success:e,error:e,fail:e,limit:e}:(r.success=void 0===e.success?function(){}:e.success,r.error=void 0===e.error?function(){}:e.error,r.fail=void 0===e.fail?function(){}:e.fail,r.limit=void 0===e.limit?function(){}:e.limit),this.__calls.push(r),this.__calls.length>1||this.again()},G.prototype.answers=function(e,r,t){return this.thread.answers(e,r,t)},J.prototype.answers=function(e,r,t){var n=void 0===r?1e3:r,i=this;n<=0?t&&t():this.answer((function(r){e(r),!1!==r?setTimeout((function(){i.answers(e,n-1,t)}),0):t&&t()}))},G.prototype.again=function(e){return this.thread.again(e)},J.prototype.again=function(e){for(;this.__calls.length>0;){for(this.warnings=[],!1!==e&&(this.current_limit=this.session.limit);(!this.has_limit||this.current_limit>0)&&this.points.length>0&&null!==this.head_point().goal&&!U.type.is_error_state(this.head_point());){this.has_limit&&this.current_limit--;var r=Date.now(),t=this.step(),n=Date.now();if(this.cpu_time+=n-r,!0===t)return}var i=this.__calls.shift();if(this.has_limit&&this.current_limit<=0)!function(e){setTimeout((function(){e.limit(null)}),0)}(i);else if(0===this.points.length)!function(e){setTimeout((function(){e.fail(!1)}),0)}(i);else if(U.type.is_error(this.head_point().goal)){var a=this.format_error(this.points.pop());this.points=[],function(e,r){setTimeout((function(){r.error(e)}),0)}(a,i)}else{this.debugger&&this.debugger_states.push(this.head_point()),function(e,r){setTimeout((function(){r.success(e)}),0)}(this.format_success(this.points.pop()),i)}}},G.prototype.unfold=function(r){if(null===r.body)return!1;var t=r.head,n=r.body,i=n.select(),a=new J(this),o=[];a.add_goal(i),a.step();for(var s=a.points.length-1;s>=0;s--){var p=a.points[s],y=t.apply(p.substitution),w=n.replace(p.goal);null!==w&&(w=w.apply(p.substitution)),o.push(new H(y,w))}var l=this.modules.user.rules[t.indicator],_=e(l,r);return o.length>0&&-1!==_&&(l.splice.apply(l,[_,1].concat(o)),!0)},J.prototype.unfold=function(e){return this.session.unfold(e)},D.prototype.interpret=function(e){return U.error.instantiation(e.level.indicator)},C.prototype.interpret=function(e){return this},L.prototype.interpret=function(e){return U.type.is_unitary_list(this)?this.args[0].interpret(e):U.operate(e,this)},D.prototype.compare=function(e){return this.id<e.id?-1:this.id>e.id?1:0},C.prototype.compare=function(e){return this.value===e.value&&this.is_float===e.is_float?0:this.value<e.value||this.value===e.value&&this.is_float&&!e.is_float?-1:this.value>e.value?1:void 0},L.prototype.compare=function(e){if(this.args.length<e.args.length||this.args.length===e.args.length&&this.id<e.id)return-1;if(this.args.length>e.args.length||this.args.length===e.args.length&&this.id>e.id)return 1;for(var r=0;r<this.args.length;r++){var t=U.compare(this.args[r],e.args[r]);if(0!==t)return t}return 0},B.prototype.lookup=function(e){return this.links[e]?this.links[e]:null},B.prototype.filter=function(e){var r={};for(var t in this.links)if(this.links.hasOwnProperty(t)){var n=this.links[t];e(t,n)&&(r[t]=n)}return new B(r,this.attrs)},B.prototype.exclude=function(r){var t={};for(var n in this.links)this.links.hasOwnProperty(n)&&-1===e(r,n)&&(t[n]=this.links[n]);return new B(t,this.attrs)},B.prototype.add=function(e,r){this.links[e]=r},B.prototype.domain=function(e){var r=!0===e?function(e){return e}:function(e){return new D(e)},t=[];for(var n in this.links)t.push(r(n));return t},B.prototype.get_attribute=function(e,r){if(this.attrs[e])return this.attrs[e][r]},B.prototype.set_attribute=function(e,r,t){var n=new B(this.links);for(var i in this.attrs)if(i===e)for(var a in n.attrs[i]={},this.attrs[i])n.attrs[i][a]=this.attrs[i][a];else n.attrs[i]=this.attrs[i];return n.attrs[e]||(n.attrs[e]={}),n.attrs[e][r]=t,n},B.prototype.has_attributes=function(e){return this.attrs[e]&&this.attrs[e]!=={}},D.prototype.compile=function(){return'new pl.type.Var("'+this.id.toString()+'")'},C.prototype.compile=function(){return"new pl.type.Num("+this.value.toString()+", "+this.is_float.toString()+")"},L.prototype.compile=function(){return'new pl.type.Term("'+this.id.replace(/"/g,'\\"')+'", ['+a(this.args,(function(e){return e.compile()}))+"])"},H.prototype.compile=function(){return"new pl.type.Rule("+this.head.compile()+", "+(null===this.body?"null":this.body.compile())+")"},G.prototype.compile=function(){var e,r,t=[];for(var n in this.modules.user.rules)if(this.modules.user.rules.hasOwnProperty(n)){var i=this.modules.user.rules[n];r=[],e='"'+n+'": [';for(var a=0;a<i.length;a++)r.push(i[a].compile());e+=r.join(),e+="]",t.push(e)}return"{"+t.join()+"};"},$.prototype.compile=function(){var e=0,r=0,t="var pl;\n";for(var n in t+="(function(pl) {\n",t+='\tvar name = "'+this.id+'";\n',t+="\tvar predicates = function() {\n",t+="\t\treturn {\n",this.rules){if(e>0&&(t+=",\n"),t+='\t\t\t"'+n+'": ',"function"==typeof this.rules[n])t+=this.rules[n];else{t+="[\n";for(var i=0;i<this.rules[n].length;i++)t+="\t\t\t\t"+this.rules[n][i].compile(),i<this.rules[n].length-1&&(t+=","),t+="\n";t+="\t\t\t]"}e++}t+="\n\t\t};\n",t+="\t};\n",t+="\tvar exports = [";for(i=0;i<this.exports.length;i++)i>0&&(t+=", "),t+='"'+this.exports[i]+'"';for(var n in t+="];\n",t+="\tvar options = function() {\n",t+="\t\treturn {\n",t+="\t\t\tdependencies: [",this.modules)r>0&&(t+=", "),t+='"'+n+'"',r++;return t+="]\n",t+="\t\t};\n",t+="};\n",t+="\tif(typeof module !== 'undefined') {\n",t+="\t\tmodule.exports = function(p) {\n",t+="\t\t\tpl = p;\n",t+="\t\t\tnew pl.type.Module(name, predicates(), exports, options());\n",t+="\t\t};\n",t+="\t} else {\n",t+="\t\tnew pl.type.Module(name, predicates(), exports, options());\n",t+="\t}\n",t+="})(pl);\n"},D.prototype.toJavaScript=function(){return this.toString()},C.prototype.toJavaScript=function(){return this.value},L.prototype.toJavaScript=function(e){if(0===this.args.length&&"[]/0"!==this.indicator)return this.toString(e);if(U.type.is_list(this)){for(var r,t=!0,n=[],i={},a=this;"./2"===a.indicator;)r=a.args[0].toJavaScript(e),n.push(r),(t=t&&U.type.is_term(a.args[0])&&"-/2"===a.args[0].indicator&&U.type.is_atom(a.args[0].args[0]))&&(i[a.args[0].args[0].id]=a.args[0].args[1].toJavaScript(e)),a=a.args[1];if("[]/0"===a.indicator)return t&&n.length>0?i:n}return this.toString(e)},H.prototype.singleton_variables=function(e){e=e||!1;var r=this.head.variables(),t={},n=[];null!==this.body&&(r=r.concat(this.body.variables()));for(var i=0;i<r.length;i++)void 0===t[r[i]]&&(t[r[i]]=0),t[r[i]]++;for(var a in t)if(t.hasOwnProperty(a)&&1===t[a]){var o=s(a,1);if((!e||"_"===a)&&("_"===a||"_"===a[0]&&(95===o||o>=65&&o<=90)))continue;n.push(a)}return n};var z="undefined"!=typeof process&&!process.browser,Z=z?N(a(process.argv.slice(1),(function(e){return new L(e)}))):new L("[]",[]),U={__env:z?global:window,modules:{},version:r,parser:{tokenizer:v,expression:T},utils:{str_indicator:P,codePointAt:s,fromCodePoint:p,stringLength:y},statistics:{getCountTerms:function(){return I}},fromJavaScript:{test:{boolean:function(e,r){return!0===e||!1===e},number:function(e,r){return"number"==typeof e},string:function(e,r){return"string"==typeof e},list:function(e,r){return e instanceof Array},variable:function(e,r){return void 0===e},object:function(e,r){return(r=void 0!==r&&r)&&!(e instanceof Array)&&"object"==typeof e},any:function(e,r){return!0}},conversion:{boolean:function(e,r){return new L(e?"true":"false",[])},number:function(e,r){return new C(e,e%1!=0)},string:function(e,r){return new L(e,[])},list:function(e,r){r=void 0!==r&&r;for(var t,n=[],i=0;i<e.length;i++){if(void 0===(t=U.fromJavaScript.apply(e[i],r)))return;n.push(t)}return N(n)},variable:function(e,r){return new D("_")},object:function(e,r){r=void 0!==r&&r;new L("[]",[]);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(new L("-",[U.fromJavaScript.apply(n,r),U.fromJavaScript.apply(e[n],r)]));return N(t)},any:function(e,r){}},apply:function(e,r){for(var t in r=void 0!==r&&r,U.fromJavaScript.test)if("any"!==t&&U.fromJavaScript.test[t](e,r))return U.fromJavaScript.conversion[t](e,r);return U.fromJavaScript.conversion.any(e,r)}},type:{Var:D,Num:C,Term:L,Rule:H,State:q,Stream:Y,Module:$,Thread:J,Session:G,Substitution:B,File:t,Directory:n,order:[D,C,L,Y],compare:function(r,t){var n=e(U.type.order,r.constructor),i=e(U.type.order,t.constructor);if(n<i)return-1;if(n>i)return 1;if(r.constructor===C){if(r.is_float&&t.is_float)return 0;if(r.is_float)return-1;if(t.is_float)return 1}return 0},is_substitution:function(e){return e instanceof B},is_state:function(e){return e instanceof q},is_rule:function(e){return e instanceof H},is_variable:function(e){return e instanceof D},is_stream:function(e){return e instanceof Y},is_anonymous_var:function(e){return e instanceof D&&"_"===e.id},is_callable:function(r){return r instanceof L&&(-1===e([",/2",";/2","->/2"],r.indicator)||U.type.is_callable(r.args[0])&&U.type.is_callable(r.args[1]))||r instanceof D},is_number:function(e){return e instanceof C},is_integer:function(e){return e instanceof C&&!e.is_float},is_float:function(e){return e instanceof C&&e.is_float},is_term:function(e){return e instanceof L},is_atom:function(e){return e instanceof L&&0===e.args.length},is_ground:function(e){if(e instanceof D)return!1;if(e instanceof L)for(var r=0;r<e.args.length;r++)if(!U.type.is_ground(e.args[r]))return!1;return!0},is_atomic:function(e){return e instanceof L&&0===e.args.length||e instanceof C},is_compound:function(e){return e instanceof L&&e.args.length>0},is_list:function(e){return e instanceof L&&("[]/0"===e.indicator||"./2"===e.indicator)},is_empty_list:function(e){return e instanceof L&&"[]/0"===e.indicator},is_non_empty_list:function(e){return e instanceof L&&"./2"===e.indicator},is_fully_list:function(e){for(;e instanceof L&&"./2"===e.indicator;)e=e.args[1];return e instanceof D||e instanceof L&&"[]/0"===e.indicator},is_instantiated_list:function(e){for(;e instanceof L&&"./2"===e.indicator;)e=e.args[1];return e instanceof L&&"[]/0"===e.indicator},is_unitary_list:function(e){return e instanceof L&&"./2"===e.indicator&&e.args[1]instanceof L&&"[]/0"===e.args[1].indicator},is_character:function(e){return e instanceof L&&0===e.args.length&&(1===e.id.length||e.id.length>0&&e.id.length<=2&&s(e.id,0)>=65536)},is_in_character:function(e){return e instanceof L&&("end_of_file/0"===e.indicator||1===e.id.length||e.id.length>0&&e.id.length<=2&&s(e.id,0)>=65536)},is_character_code:function(e){return e instanceof C&&!e.is_float&&e.value>=0&&e.value<=1114111},is_in_character_code:function(e){return e instanceof C&&!e.is_float&&e.value>=-1&&e.value<=1114111},is_byte:function(e){return e instanceof C&&!e.is_float&&e.value>=0&&e.value<=255},is_in_byte:function(e){return e instanceof C&&!e.is_float&&e.value>=-1&&e.value<=255},is_operator:function(e){return e instanceof L&&U.arithmetic.evaluation[e.indicator]},is_directive:function(e){return e instanceof L&&(void 0!==U.directive[e.indicator]||void 0!==U.directive[e.id+"/*"])},is_builtin:function(e){return e instanceof L&&U.builtin.rules.hasOwnProperty(e.indicator)&&"goal_expansion/2"!==e.indicator},is_error:function(e){return e instanceof L&&"throw/1"===e.indicator},is_error_state:function(e){return U.type.is_state(e)&&e.error&&!0===e.error},is_predicate_indicator:function(e){return e instanceof L&&"//2"===e.indicator&&e.args[0]instanceof L&&0===e.args[0].args.length&&e.args[1]instanceof C&&!1===e.args[1].is_float},is_flag:function(e){return e instanceof L&&0===e.args.length&&void 0!==U.flag[e.id]},is_value_flag:function(e,r){if(!U.type.is_flag(e))return!1;for(var t in U.flag[e.id].allowed)if(U.flag[e.id].allowed.hasOwnProperty(t)&&U.flag[e.id].allowed[t].equals(r))return!0;return!1},is_io_mode:function(e){return U.type.is_atom(e)&&-1!==["read","write","append"].indexOf(e.id)},is_stream_option:function(e){return U.type.is_term(e)&&("alias/1"===e.indicator&&U.type.is_atom(e.args[0])||"reposition/1"===e.indicator&&U.type.is_atom(e.args[0])&&("true"===e.args[0].id||"false"===e.args[0].id)||"type/1"===e.indicator&&U.type.is_atom(e.args[0])&&("text"===e.args[0].id||"binary"===e.args[0].id)||"eof_action/1"===e.indicator&&U.type.is_atom(e.args[0])&&("error"===e.args[0].id||"eof_code"===e.args[0].id||"reset"===e.args[0].id))},is_stream_position:function(e){return U.type.is_term(e)&&("end_of_stream/0"===e.indicator||"past_end_of_stream/0"===e.indicator||"position/3"===e.indicator&&U.type.is_integer(e.args[0])&&U.type.is_integer(e.args[1])&&U.type.is_integer(e.args[2]))},is_stream_property:function(e){return U.type.is_term(e)&&("input/0"===e.indicator||"output/0"===e.indicator||"alias/1"===e.indicator&&(U.type.is_variable(e.args[0])||U.type.is_atom(e.args[0]))||"file_name/1"===e.indicator&&(U.type.is_variable(e.args[0])||U.type.is_atom(e.args[0]))||"reposition/1"===e.indicator&&(U.type.is_variable(e.args[0])||U.type.is_atom(e.args[0])&&("true"===e.args[0].id||"false"===e.args[0].id))||"type/1"===e.indicator&&(U.type.is_variable(e.args[0])||U.type.is_atom(e.args[0])&&("text"===e.args[0].id||"binary"===e.args[0].id))||"mode/1"===e.indicator&&(U.type.is_variable(e.args[0])||U.type.is_atom(e.args[0])&&("read"===e.args[0].id||"write"===e.args[0].id||"append"===e.args[0].id))||"eof_action/1"===e.indicator&&(U.type.is_variable(e.args[0])||U.type.is_atom(e.args[0])&&("error"===e.args[0].id||"eof_code"===e.args[0].id||"reset"===e.args[0].id))||"end_of_stream/1"===e.indicator&&(U.type.is_variable(e.args[0])||U.type.is_atom(e.args[0])&&("at"===e.args[0].id||"past"===e.args[0].id||"not"===e.args[0].id))||"position/1"===e.indicator&&(U.type.is_variable(e.args[0])||U.type.is_term(e.args[0])&&"position/3"===e.args[0].indicator&&(U.type.is_variable(e.args[0].args[0])||U.type.is_integer(e.args[0].args[0]))&&(U.type.is_variable(e.args[0].args[1])||U.type.is_integer(e.args[0].args[1]))&&(U.type.is_variable(e.args[0].args[2])||U.type.is_integer(e.args[0].args[2]))))},is_streamable:function(e){return void 0!==e.__proto__.stream},is_read_option:function(e){return U.type.is_term(e)&&-1!==["variables/1","variable_names/1","singletons/1"].indexOf(e.indicator)},is_write_option:function(e){return U.type.is_term(e)&&("quoted/1"===e.indicator&&U.type.is_atom(e.args[0])&&("true"===e.args[0].id||"false"===e.args[0].id)||"ignore_ops/1"===e.indicator&&U.type.is_atom(e.args[0])&&("true"===e.args[0].id||"false"===e.args[0].id)||"numbervars/1"===e.indicator&&U.type.is_atom(e.args[0])&&("true"===e.args[0].id||"false"===e.args[0].id)||"variable_names/1"===e.indicator&&U.type.is_fully_list(e.args[0]))},is_close_option:function(e){return U.type.is_term(e)&&"force/1"===e.indicator&&U.type.is_atom(e.args[0])&&("true"===e.args[0].id||"false"===e.args[0].id)},is_modifiable_flag:function(e){return U.type.is_flag(e)&&U.flag[e.id].changeable},is_module:function(e){return e instanceof $},is_file:function(e){return e instanceof t},is_directory:function(e){return e instanceof n},is_predicate_property:function(e){return U.type.is_term(e)&&("built_in/0"===e.indicator||"static/0"===e.indicator||"dynamic/0"===e.indicator||"native_code/0"===e.indicator||"multifile/0"===e.indicator||"meta_predicate/1"===e.indicator)},is_meta_argument_specifier:function(r){return U.type.is_integer(r)&&r.value>=0||U.type.is_atom(r)&&-1!==e(["+","-","?","*","^",":","//"],r.id)},is_time_property:function(r){return U.type.is_term(r)&&1===r.args.length&&(U.type.is_variable(r.args[0])||U.type.is_integer(r.args[0]))&&-1!==e(["year","month","day","hours","minutes","seconds","milliseconds","weekday"],r.id)}},arithmetic:{evaluation:{"e/0":{type_args:null,type_result:!0,fn:function(e){return Math.E}},"pi/0":{type_args:null,type_result:!0,fn:function(e){return Math.PI}},"tau/0":{type_args:null,type_result:!0,fn:function(e){return 2*Math.PI}},"epsilon/0":{type_args:null,type_result:!0,fn:function(e){return Number.EPSILON}},"+/1":{type_args:null,type_result:null,fn:function(e,r){return e}},"-/1":{type_args:null,type_result:null,fn:function(e,r){return-e}},"\\/1":{type_args:!1,type_result:!1,fn:function(e,r){return~e}},"abs/1":{type_args:null,type_result:null,fn:function(e,r){return Math.abs(e)}},"sign/1":{type_args:null,type_result:null,fn:function(e,r){return Math.sign(e)}},"float_integer_part/1":{type_args:!0,type_result:!1,fn:function(e,r){return parseInt(e)}},"float_fractional_part/1":{type_args:!0,type_result:!0,fn:function(e,r){return e-parseInt(e)}},"float/1":{type_args:null,type_result:!0,fn:function(e,r){return parseFloat(e)}},"floor/1":{type_args:!0,type_result:!1,fn:function(e,r){return Math.floor(e)}},"truncate/1":{type_args:!0,type_result:!1,fn:function(e,r){return parseInt(e)}},"round/1":{type_args:!0,type_result:!1,fn:function(e,r){return Math.round(e)}},"ceiling/1":{type_args:!0,type_result:!1,fn:function(e,r){return Math.ceil(e)}},"sin/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.sin(e)}},"cos/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.cos(e)}},"tan/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.tan(e)}},"asin/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.abs(e)<=1?Math.asin(e):U.error.evaluation("undefined",r.__call_indicator)}},"acos/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.abs(e)<=1?Math.acos(e):U.error.evaluation("undefined",r.__call_indicator)}},"atan/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.atan(e)}},"atan2/2":{type_args:null,type_result:!0,fn:function(e,r,t){return 0===e&&0===r?U.error.evaluation("undefined",t.__call_indicator):Math.atan2(e,r)}},"acosh/1":{type_args:null,type_result:!0,fn:function(e,r){return e>=1?Math.acosh(e):U.error.evaluation("undefined",r.__call_indicator)}},"asinh/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.asinh(e)}},"atanh/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.abs(e)<1?Math.atanh(e):U.error.evaluation("undefined",r.__call_indicator)}},"cosh/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.cosh(e)}},"sinh/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.sinh(e)}},"tanh/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.tanh(e)}},"exp/1":{type_args:null,type_result:!0,fn:function(e,r){return Math.exp(e)}},"sqrt/1":{type_args:null,type_result:!0,fn:function(e,r){return e>=0?Math.sqrt(e):U.error.evaluation("undefined",r.__call_indicator)}},"log/1":{type_args:null,type_result:!0,fn:function(e,r){return e>0?Math.log(e):U.error.evaluation("undefined",r.__call_indicator)}},"log/2":{type_args:null,type_result:!0,fn:function(e,r,t){return e>0&&r>0?Math.log(r)/Math.log(e):U.error.evaluation("undefined",t.__call_indicator)}},"log10/1":{type_args:null,type_result:!0,fn:function(e,r){return e>0?Math.log(e)/Math.log(10):U.error.evaluation("undefined",r.__call_indicator)}},"+/2":{type_args:null,type_result:null,fn:function(e,r,t){return e+r}},"-/2":{type_args:null,type_result:null,fn:function(e,r,t){return e-r}},"*/2":{type_args:null,type_result:null,fn:function(e,r,t){return e*r}},"//2":{type_args:null,type_result:!0,fn:function(e,r,t){return r?e/r:U.error.evaluation("zero_divisor",t.__call_indicator)}},"///2":{type_args:!1,type_result:!1,fn:function(e,r,t){return r?Math.trunc(e/r):U.error.evaluation("zero_divisor",t.__call_indicator)}},"div/2":{type_args:!1,type_result:!1,fn:function(e,r,t){return r?Math.floor(e/r):U.error.evaluation("zero_divisor",t.__call_indicator)}},"**/2":{type_args:null,type_result:!0,fn:function(e,r,t){return 0==e&&r<0?U.error.evaluation("zero_divisor",t.__call_indicator):Math.pow(e,r)}},"^/2":{type_args:null,type_result:null,fn:function(e,r,t){return 0==e&&r<0?U.error.evaluation("zero_divisor",t.__call_indicator):Math.pow(e,r)}},"<</2":{type_args:!1,type_result:!1,fn:function(e,r,t){return e<<r}},">>/2":{type_args:!1,type_result:!1,fn:function(e,r,t){return e>>r}},"/\\/2":{type_args:!1,type_result:!1,fn:function(e,r,t){return e&r}},"\\//2":{type_args:!1,type_result:!1,fn:function(e,r,t){return e|r}},"xor/2":{type_args:!1,type_result:!1,fn:function(e,r,t){return e^r}},"rem/2":{type_args:!1,type_result:!1,fn:function(e,r,t){return r?e%r:U.error.evaluation("zero_divisor",t.__call_indicator)}},"mod/2":{type_args:!1,type_result:!1,fn:function(e,r,t){return r?e-Math.floor(e/r)*r:U.error.evaluation("zero_divisor",t.__call_indicator)}},"max/2":{type_args:null,type_result:null,fn:function(e,r,t){return Math.max(e,r)}},"min/2":{type_args:null,type_result:null,fn:function(e,r,t){return Math.min(e,r)}},"gcd/2":{type_args:!1,type_result:!1,fn:function(e,r,t){return E(e,r)}}}},directive:{"dynamic/1":function(e,r,t){var n=r.args[0];U.type.is_list(n)||(n=N([n]));for(var i=n;U.type.is_term(i)&&"./2"===i.indicator;){if(indicator=i.args[0],U.type.is_variable(indicator))e.throw_warning(U.error.instantiation(r.indicator));else if(U.type.is_compound(indicator)&&"//2"===indicator.indicator)if(U.type.is_variable(indicator.args[0])||U.type.is_variable(indicator.args[1]))e.throw_warning(U.error.instantiation(r.indicator));else if(U.type.is_atom(indicator.args[0]))if(U.type.is_integer(indicator.args[1])){var a=indicator.args[0].id+"/"+indicator.args[1].value,o=e.session.modules[t.context_module];o.public_predicates[a]=!0,o.rules[a]||(o.rules[a]=[])}else e.throw_warning(U.error.type("integer",indicator.args[1],r.indicator));else e.throw_warning(U.error.type("atom",indicator.args[0],r.indicator));else e.throw_warning(U.error.type("predicate_indicator",indicator,r.indicator));i=i.args[1]}U.type.is_variable(i)?e.throw_warning(U.error.instantiation(r.indicator)):U.type.is_term(i)&&"[]/0"===i.indicator||e.throw_warning(U.error.type("predicate_indicator",indicator,r.indicator))},"dynamic/*":function(e,r){for(var t=0;t<r.args.length;t++)U.directive["dynamic/1"](e,new L("dynamic",[r.args[t]]))},"multifile/1":function(e,r,t){var n=r.args[0];if(U.type.is_variable(n))e.throw_warning(U.error.instantiation(r.indicator));else if(U.type.is_compound(n)&&"//2"===n.indicator)if(U.type.is_variable(n.args[0])||U.type.is_variable(n.args[1]))e.throw_warning(U.error.instantiation(r.indicator));else if(U.type.is_atom(n.args[0]))if(U.type.is_integer(n.args[1])){var i=r.args[0].args[0].id+"/"+r.args[0].args[1].value,a=e.session.modules[t.context_module];a.multifile_predicates[i]=!0,a.rules.hasOwnProperty(i)||(a.rules[i]=[],a.public_predicates[i]=!1)}else e.throw_warning(U.error.type("integer",n.args[1],r.indicator));else e.throw_warning(U.error.type("atom",n.args[0],r.indicator));else e.throw_warning(U.error.type("predicate_indicator",n,r.indicator))},"meta_predicate/1":function(e,r,t){t=void 0===t?{}:t;var n=r.args[0];if(U.type.is_variable(n))e.throw_warning(U.error.instantiation(r.indicator));else if(U.type.is_callable(n)){for(var i=0;i<n.args.length;i++){var a=n.args[i];if(!U.type.is_meta_argument_specifier(a))return void e.throw_warning(U.error.type("meta_argument_specifier",a,r.indicator))}e.session.modules[t.context_module].meta_predicates[n.indicator]=n}else e.throw_warning(U.error.type("callable",n,r.indicator))},"set_prolog_flag/2":function(e,r){var t=r.args[0],n=r.args[1];U.type.is_variable(t)||U.type.is_variable(n)?e.throw_warning(U.error.instantiation(r.indicator)):U.type.is_atom(t)?U.type.is_flag(t)?U.type.is_modifiable_flag(t)?U.type.is_value_flag(t,n)?e.session.flag[t.id]=n:e.throw_warning(U.error.domain("flag_value",new L("+",[t,n]),r.indicator)):e.throw_warning(U.error.permission("modify","flag",t,r.indicator)):e.throw_warning(U.error.domain("prolog_flag",t,r.indicator)):e.throw_warning(U.error.type("atom",t,r.indicator))},"module/2":function(e,r,t){(t=void 0===t?{}:t).context_module=void 0===t.context_module?"user":t.context_module;var n=r.args[0],i=r.args[1];if(U.type.is_variable(n)||U.type.is_variable(i))e.throw_warning(U.error.instantiation(r.indicator));else if(U.type.is_atom(n))if(U.type.is_list(i))if(U.type.is_module(e.session.modules[n.indicator]))e.throw_warning(U.error.permission("create","module",n,r.indicator));else{for(var a=i,o=[];U.type.is_term(a)&&"./2"===a.indicator;){var s=a.args[0];U.type.is_predicate_indicator(s)?o.push(s.args[0].id+"/"+s.args[1].value):e.throw_warning(U.error.type("predicate_indicator",s,r.indicator)),a=a.args[1]}U.type.is_variable(a)?e.throw_warning(U.error.instantiation(r.indicator)):U.type.is_empty_list(a)||e.throw_warning(U.error.type("list",i,r.indicator));var p=new $(n.id,{},o,{session:e.session});e.session.modules[n.id]=p,e.session.modules[t.context_module].modules[n.id]=p,t.context_module=n.id}else e.throw_warning(U.error.type("list",i,r.indicator));else e.throw_warning(U.error.type("atom",n,r.indicator))},"use_module/1":function(e,r,t){(t=void 0===t?{}:t).context_module=void 0===t.context_module?"user":t.context_module;var n=r.args[0];if(U.type.is_variable(n))e.throw_warning(U.error.instantiation(r.indicator));else if(U.type.is_term(n)){if("library/1"!==n.indicator){i=n.id;return e.consult(i,{context_module:t.context_module,text:!1,success:function(){b(e,t.string,t)},error:function(){t.error(U.error.existence("module",n,r.indicator))}}),!0}var i=n.args[0].id,a=U.modules[i];if(U.type.is_module(a)){if(!e.session.modules[t.context_module].modules.hasOwnProperty(i)){e.session.modules[i]=a,e.session.modules[t.context_module].modules[i]=a;for(var o=0;o<a.dependencies.length;o++){var s=new L("use_module",[new L("library",[new L(a.dependencies[o])])]);U.directive["use_module/1"](e,s,{context_module:i})}}}else e.throw_warning(U.error.existence("module",n,r.indicator))}else e.throw_warning(U.error.type("term",n,r.indicator))},"char_conversion/2":function(e,r,t){var n=r.args[0],i=r.args[1];if(U.type.is_variable(n)||U.type.is_variable(i))e.throw_warning(U.error.instantiation(r.indicator));else if(U.type.is_character(n)){if(U.type.is_character(i))return n.id===i.id?delete e.session.__char_conversion[n.id]:e.session.__char_conversion[n.id]=i.id,t.tokens=t.tokenizer.get_tokens(t.current_token),t.current_token=0,!0;e.throw_warning(U.error.type("character",i,r.indicator))}else e.throw_warning(U.error.type("character",n,r.indicator))},"op/3":function(r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(U.type.is_atom(a)&&(a=new L(".",[a,new L("[]")])),U.type.is_variable(n)||U.type.is_variable(i)||U.type.is_variable(a))r.throw_warning(U.error.instantiation(t.indicator));else if(U.type.is_integer(n))if(U.type.is_atom(i))if(U.type.is_list(a))if(U.type.is_empty_list(a))r.throw_warning(U.error.permission("create","operator",a,t.indicator));else{for(var o=a;U.type.is_term(o)&&"./2"===o.indicator;){var s=o.args[0];if(o=o.args[1],U.type.is_variable(s))r.throw_warning(U.error.instantiation(t.indicator));else if(U.type.is_atom(s))if(n.value<0||n.value>1200)r.throw_warning(U.error.domain("operator_priority",n,t.indicator));else if(","===s.id)r.throw_error(U.error.permission("modify","operator",s,t.indicator));else if("{}"===s.id)r.throw_warning(U.error.permission("create","operator",s,t.indicator));else if("[]"===s.id)r.throw_warning(U.error.permission("create","operator",s,t.indicator));else if("|"===s.id&&0!==n.value&&(n.value<1001||3!==i.id.length))r.throw_warning(U.error.permission("create","operator",s,t.indicator));else if(-1===["fy","fx","yf","xf","xfx","yfx","xfy"].indexOf(i.id))r.throw_warning(U.error.domain("operator_specifier",i,t.indicator));else{var p,y={prefix:null,infix:null,postfix:null};for(var w in r.session.__operators)if(r.session.__operators.hasOwnProperty(w)){var l=r.session.__operators[w][s.id];l&&(-1!==e(l,"fx")&&(y.prefix={priority:w,type:"fx"}),-1!==e(l,"fy")&&(y.prefix={priority:w,type:"fy"}),-1!==e(l,"xf")&&(y.postfix={priority:w,type:"xf"}),-1!==e(l,"yf")&&(y.postfix={priority:w,type:"yf"}),-1!==e(l,"xfx")&&(y.infix={priority:w,type:"xfx"}),-1!==e(l,"xfy")&&(y.infix={priority:w,type:"xfy"}),-1!==e(l,"yfx")&&(y.infix={priority:w,type:"yfx"}))}switch(i.id){case"fy":case"fx":p="prefix";break;case"yf":case"xf":p="postfix";break;default:p="infix"}y.infix&&"postfix"===p||y.postfix&&"infix"===p?r.throw_warning(U.error.permission("create","operator",s,t.indicator)):(y[p]&&(R(r.session.__operators[y[p].priority][s.id],y[p].type),0===r.session.__operators[y[p].priority][s.id].length&&delete r.session.__operators[y[p].priority][s.id]),n.value>0&&(r.session.__operators[n.value]||(r.session.__operators[n.value.toString()]={}),r.session.__operators[n.value][s.id]||(r.session.__operators[n.value][s.id]=[]),r.session.__operators[n.value][s.id].push(i.id)))}else r.throw_warning(U.error.type("atom",s,t.indicator))}if(U.type.is_variable(o))return void r.throw_warning(U.error.instantiation(t.indicator));if(!U.type.is_term(o)||"[]/0"!==o.indicator)return void r.throw_warning(U.error.type("list",a,t.indicator))}else r.throw_warning(U.error.type("list",a,t.indicator));else r.throw_warning(U.error.type("atom",i,t.indicator));else r.throw_warning(U.error.type("integer",n,t.indicator))},"initialization/1":function(e,r,t){var n=r.args[0];t.initialization.push(n)}},flag:{bounded:{allowed:[new L("true"),new L("false")],value:new L("true"),changeable:!1},max_integer:{allowed:[new C(Number.MAX_SAFE_INTEGER)],value:new C(Number.MAX_SAFE_INTEGER),changeable:!1},min_integer:{allowed:[new C(Number.MIN_SAFE_INTEGER)],value:new C(Number.MIN_SAFE_INTEGER),changeable:!1},integer_rounding_function:{allowed:[new L("down"),new L("toward_zero")],value:new L("toward_zero"),changeable:!1},char_conversion:{allowed:[new L("on"),new L("off")],value:new L("on"),changeable:!0},debug:{allowed:[new L("on"),new L("off")],value:new L("off"),changeable:!0},max_arity:{allowed:[new L("unbounded")],value:new L("unbounded"),changeable:!1},unknown:{allowed:[new L("error"),new L("fail"),new L("warning")],value:new L("error"),changeable:!0},double_quotes:{allowed:[new L("chars"),new L("codes"),new L("atom")],value:new L("chars"),changeable:!0},occurs_check:{allowed:[new L("false"),new L("true")],value:new L("false"),changeable:!0},dialect:{allowed:[new L("tau")],value:new L("tau"),changeable:!1},version_data:{allowed:[new L("tau",[new C(r.major,!1),new C(r.minor,!1),new C(r.patch,!1),new L(r.status)])],value:new L("tau",[new C(r.major,!1),new C(r.minor,!1),new C(r.patch,!1),new L(r.status)]),changeable:!1},nodejs:{allowed:[new L("true"),new L("false")],value:new L(z?"true":"false"),changeable:!1},argv:{allowed:[Z],value:Z,changeble:!1}},unify:function(r,t,n){n=void 0!==n&&n;var i=Array.isArray(r)?r:[r],a=Array.isArray(t)?t:[t];if(i.length!==a.length)return null;for(var o=new B;i.length>0;){var s=i.pop(),p=a.pop();if(U.type.is_variable(s)&&(s=s.apply(o)),U.type.is_variable(p)&&(p=p.apply(o)),s!=p)if(U.type.is_term(s)&&U.type.is_term(p)){if(s.indicator!==p.indicator)return null;for(var y=s.args.length-1;y>=0;y--)i.push(s.args[y]),a.push(p.args[y])}else if(U.type.is_number(s)&&U.type.is_number(p)){if(s.value!==p.value||s.is_float!==p.is_float)return null}else if(U.type.is_variable(s)){if(p=p.apply(o),U.type.is_variable(p)&&s.id===p.id)continue;if(!0===n&&-1!==e(p.variables(),s.id))return null;"_"!==s.id&&o.add(s.id,p)}else if(U.type.is_variable(p))i.push(p),a.push(s);else{if(void 0===s.unify)return null;var w=s.apply(o).unify(p.apply(o),n);if(null==w)return null;for(var y in w.links)o.add(y,w.links[y])}}return o.apply(o)},is_rename:function(e,r,t){return t=t||{},e.is_rename&&r.is_rename?e.is_rename(r,t):!(!e.equals||!r.equals)&&e.equals(r)},compare:function(e,r){var t=U.type.compare(e,r);return 0!==t?t:e.compare(r)},arithmetic_compare:function(e,r,t){var n=r.interpret(e);if(U.type.is_number(n)){var i=t.interpret(e);return U.type.is_number(i)?n.value<i.value?-1:n.value>i.value?1:0:i}return n},operate:function(e,r){if(U.type.is_operator(r)){for(var t,n=U.type.is_operator(r),i=[],a=!1,o=0;o<r.args.length;o++){if(t=r.args[o].interpret(e),!U.type.is_number(t))return t;if(null!==n.type_args&&t.is_float!==n.type_args)return U.error.type(n.type_args?"float":"integer",t,e.__call_indicator);i.push(t.value),a=a||t.is_float}return i.push(e),t=U.arithmetic.evaluation[r.indicator].fn.apply(this,i),"^/2"!==r.indicator||a||t===parseInt(t,10)?(a=null===n.type_result?a:n.type_result,U.type.is_term(t)?t:t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY?U.error.evaluation("float_overflow",e.__call_indicator):!1===a&&"true"===e.get_flag("bounded").id&&(t>e.get_flag("max_integer").value||t<e.get_flag("min_integer").value)?U.error.evaluation("int_overflow",e.__call_indicator):new C(t,a)):U.error.type("float",new C(i[0],!1),e.__call_indicator)}return U.error.type("evaluable",P(r.indicator),e.__call_indicator)},error:{existence:function(e,r,t){return"string"==typeof r&&(r=P(r)),new L("error",[new L("existence_error",[new L(e),r]),P(t)])},type:function(e,r,t){return new L("error",[new L("type_error",[new L(e),r]),P(t)])},instantiation:function(e){return new L("error",[new L("instantiation_error"),P(e)])},uninstantiation:function(e,r){return new L("error",[new L("uninstantiation_error",[new L(e)]),P(r)])},domain:function(e,r,t){return new L("error",[new L("domain_error",[new L(e),r]),P(t)])},representation:function(e,r){return new L("error",[new L("representation_error",[new L(e)]),P(r)])},permission:function(e,r,t,n){return new L("error",[new L("permission_error",[new L(e),new L(r),t]),P(n)])},evaluation:function(e,r){return new L("error",[new L("evaluation_error",[new L(e)]),P(r)])},syntax:function(e,r,t){e=e||{value:"",line:0,column:0,matches:[""],start:0};var n=t&&e.matches.length>0?e.start+e.matches[0].length:e.start,i=t?new L("token_not_found"):new L("found",[new L(e.value.toString())]),a=new L(".",[new L("line",[new C(e.line+1)]),new L(".",[new L("column",[new C(n)]),new L(".",[i,new L("[]",[])])])]);return new L("error",[new L("syntax_error",[new L(r)]),a])},syntax_by_predicate:function(e,r){return new L("error",[new L("syntax_error",[new L(e)]),P(r)])}},warning:{singleton:function(e,r,t){for(var n=new L("[]"),i=e.length-1;i>=0;i--)n=new L(".",[new D(e[i]),n]);return new L("warning",[new L("singleton_variables",[n,P(r)]),new L(".",[new L("line",[new C(t,!1)]),new L("[]")])])},failed_goal:function(e,r){return new L("warning",[new L("failed_goal",[e]),new L(".",[new L("line",[new C(r,!1)]),new L("[]")])])}},format_variable:function(e,r){var t=r&&r.length>0?s(r,1):0;return"_"===r||r&&"_"===r[0]&&(95===t||t>=65&&t<=90)?"__"+e:"_"+e},format_answer:function(r,t,n){if(t instanceof G&&(t=t.thread),(n=n||{}).session=t?t.session:void 0,U.type.is_error(r))return"uncaught exception: "+r.args[0].toString(n);if(!1===r)return"false";if(null===r)return"limit exceeded";var i=0,a="";if(U.type.is_substitution(r)){var o=r.domain(!0);for(var s in r.links)if(r.links.hasOwnProperty(s)&&U.type.is_variable(r.links[s])){var p={};p[r.links[s].id]=new D(s),r=r.apply(new B(p))}r=r.filter((function(t,n){return!U.type.is_variable(n)||U.type.is_variable(n)&&r.has_attributes(t)||-1!==e(o,n.id)&&t!==n.id}))}for(var s in r.links)if(r.links.hasOwnProperty(s))if(U.type.is_variable(r.links[s])&&s===r.links[s].id){var y=r.attrs[s];for(var w in y)y.hasOwnProperty(w)&&(i++,""!==a&&(a+=", "),a+="put_attr("+s+", "+w+", "+y[w].toString(n)+")")}else i++,""!==a&&(a+=", "),a+=s.toString(n)+" = "+r.links[s].toString(n,{priority:"700",class:"xfx",indicator:"=/2"},"right");return 0===i?"true":a},flatten_error:function(e){if(!U.type.is_error(e))return null;e=e.args[0];var r={};return r.type=e.args[0].id,r.thrown="syntax_error"===r.type?null:e.args[1].id,r.expected=null,r.found=null,r.representation=null,r.existence=null,r.existence_type=null,r.line=null,r.column=null,r.permission_operation=null,r.permission_type=null,r.evaluation_type=null,"type_error"===r.type||"domain_error"===r.type?(r.expected=e.args[0].args[0].id,r.found=e.args[0].args[1].toString()):"syntax_error"===r.type?"./2"===e.args[1].indicator?(r.expected=e.args[0].args[0].id,r.found=e.args[1].args[1].args[1].args[0],r.found="token_not_found"===r.found.id?r.found.id:r.found.args[0].id,r.line=e.args[1].args[0].args[0].value,r.column=e.args[1].args[1].args[0].args[0].value):r.thrown=e.args[1].id:"permission_error"===r.type?(r.found=e.args[0].args[2].toString(),r.permission_operation=e.args[0].args[0].id,r.permission_type=e.args[0].args[1].id):"evaluation_error"===r.type?r.evaluation_type=e.args[0].args[0].id:"representation_error"===r.type?r.representation=e.args[0].args[0].id:"existence_error"===r.type&&(r.existence=e.args[0].args[1].toString(),r.existence_type=e.args[0].args[0].id),r},create:function(e){return new U.type.Session(e)}};U.builtin=new $("system",{"goal_expansion/2":[new H(new L("goal_expansion",[new L(",",[new D("X"),new D("Y")]),new L(",",[new D("X_"),new D("Y_")])]),new L(";",[new L(",",[new L("goal_expansion",[new D("X"),new D("X_")]),new L(";",[new L("goal_expansion",[new D("Y"),new D("Y_")]),new L("=",[new D("Y_"),new D("Y")])])]),new L(",",[new L("=",[new D("X"),new D("X_")]),new L("goal_expansion",[new D("Y"),new D("Y_")])])])),new H(new L("goal_expansion",[new L(";",[new D("X"),new D("Y")]),new L(";",[new D("X_"),new D("Y_")])]),new L(";",[new L(",",[new L("goal_expansion",[new D("X"),new D("X_")]),new L(";",[new L("goal_expansion",[new D("Y"),new D("Y_")]),new L("=",[new D("Y_"),new D("Y")])])]),new L(",",[new L("=",[new D("X"),new D("X_")]),new L("goal_expansion",[new D("Y"),new D("Y_")])])])),new H(new L("goal_expansion",[new L("->",[new D("X"),new D("Y")]),new L("->",[new D("X_"),new D("Y_")])]),new L(";",[new L(",",[new L("goal_expansion",[new D("X"),new D("X_")]),new L(";",[new L("goal_expansion",[new D("Y"),new D("Y_")]),new L("=",[new D("Y_"),new D("Y")])])]),new L(",",[new L("=",[new D("X"),new D("X_")]),new L("goal_expansion",[new D("Y"),new D("Y_")])])])),new H(new L("goal_expansion",[new L("catch",[new D("X"),new D("Y"),new D("Z")]),new L("catch",[new D("X_"),new D("Y"),new D("Z_")])]),new L(";",[new L(",",[new L("goal_expansion",[new D("X"),new D("X_")]),new L(";",[new L("goal_expansion",[new D("Z"),new D("Z_")]),new L("=",[new D("Z_"),new D("Z")])])]),new L(",",[new L("=",[new D("X_"),new D("X")]),new L("goal_expansion",[new D("Z"),new D("Z_")])])])),new H(new L("goal_expansion",[new L("\\+",[new D("X")]),new L("\\+",[new D("X_")])]),new L(",",[new L("nonvar",[new D("X")]),new L("goal_expansion",[new D("X"),new D("X_")])])),new H(new L("goal_expansion",[new L("once",[new D("X")]),new L("once",[new D("X_")])]),new L(",",[new L("nonvar",[new D("X")]),new L("goal_expansion",[new D("X"),new D("X_")])])),new H(new L("goal_expansion",[new L("findall",[new D("X"),new D("Y"),new D("Z")]),new L("findall",[new D("X"),new D("Y_"),new D("Z")])]),new L("goal_expansion",[new D("Y"),new D("Y_")])),new H(new L("goal_expansion",[new L("setof",[new D("X"),new D("Y"),new D("Z")]),new L("findall",[new D("X"),new D("Y_"),new D("Z")])]),new L("goal_expansion",[new D("Y"),new D("Y_")])),new H(new L("goal_expansion",[new L("bagof",[new D("X"),new D("Y"),new D("Z")]),new L("findall",[new D("X"),new D("Y_"),new D("Z")])]),new L("goal_expansion",[new D("Y"),new D("Y_")])),new H(new L("goal_expansion",[new L("call",[new D("X")]),new L("call",[new D("X_")])]),new L(",",[new L("nonvar",[new D("X")]),new L("goal_expansion",[new D("X"),new D("X_")])])),new H(new L("goal_expansion",[new L("call",[new D("X"),new D("A1")]),new L("call",[new D("F_")])]),new L(",",[new L("=..",[new D("F"),new L(".",[new D("X"),new L(".",[new D("A1"),new L("[]",[])])])]),new L("goal_expansion",[new D("F"),new D("F_")])])),new H(new L("goal_expansion",[new L("call",[new D("X"),new D("A1"),new D("A2")]),new L("call",[new D("F_")])]),new L(",",[new L("=..",[new D("F"),new L(".",[new D("X"),new L(".",[new D("A1"),new L(".",[new D("A2"),new L("[]",[])])])])]),new L("goal_expansion",[new D("F"),new D("F_")])])),new H(new L("goal_expansion",[new L("call",[new D("X"),new D("A1"),new D("A2"),new D("A3")]),new L("call",[new D("F_")])]),new L(",",[new L("=..",[new D("F"),new L(".",[new D("X"),new L(".",[new D("A1"),new L(".",[new D("A2"),new L(".",[new D("A3"),new L("[]",[])])])])])]),new L("goal_expansion",[new D("F"),new D("F_")])])),new H(new L("goal_expansion",[new L("call",[new D("X"),new D("A1"),new D("A2"),new D("A3"),new D("A4")]),new L("call",[new D("F_")])]),new L(",",[new L("=..",[new D("F"),new L(".",[new D("X"),new L(".",[new D("A1"),new L(".",[new D("A2"),new L(".",[new D("A3"),new L(".",[new D("A4"),new L("[]",[])])])])])])]),new L("goal_expansion",[new D("F"),new D("F_")])])),new H(new L("goal_expansion",[new L("call",[new D("X"),new D("A1"),new D("A2"),new D("A3"),new D("A4"),new D("A5")]),new L("call",[new D("F_")])]),new L(",",[new L("=..",[new D("F"),new L(".",[new D("X"),new L(".",[new D("A1"),new L(".",[new D("A2"),new L(".",[new D("A3"),new L(".",[new D("A4"),new L(".",[new D("A5"),new L("[]",[])])])])])])])]),new L("goal_expansion",[new D("F"),new D("F_")])])),new H(new L("goal_expansion",[new L("call",[new D("X"),new D("A1"),new D("A2"),new D("A3"),new D("A4"),new D("A5"),new D("A6")]),new L("call",[new D("F_")])]),new L(",",[new L("=..",[new D("F"),new L(".",[new D("X"),new L(".",[new D("A1"),new L(".",[new D("A2"),new L(".",[new D("A3"),new L(".",[new D("A4"),new L(".",[new D("A5"),new L(".",[new D("A6"),new L("[]",[])])])])])])])])]),new L("goal_expansion",[new D("F"),new D("F_")])])),new H(new L("goal_expansion",[new L("call",[new D("X"),new D("A1"),new D("A2"),new D("A3"),new D("A4"),new D("A5"),new D("A6"),new D("A7")]),new L("call",[new D("F_")])]),new L(",",[new L("=..",[new D("F"),new L(".",[new D("X"),new L(".",[new D("A1"),new L(".",[new D("A2"),new L(".",[new D("A3"),new L(".",[new D("A4"),new L(".",[new D("A5"),new L(".",[new D("A6"),new L(".",[new D("A7"),new L("[]",[])])])])])])])])])]),new L("goal_expansion",[new D("F"),new D("F_")])]))],"$push_global_stack/2":function(e,r,t){var n=t.args[0],i=t.args[1];U.type.is_variable(n)?(e.push_global_stack(n.id,i),e.success(r)):e.throw_error(U.error.instantiation(t.indicator))},"$flush_global_stack/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(U.type.is_variable(n)){var o=e.flush_global_stack(n.id,a);e.prepend([new q(r.goal.replace(new L("=",[i,o])),r.substitution,r)])}else e.throw_error(U.error.instantiation(t.indicator))},"$free_variable_set/3":function(r,t,n){for(var i=n.args[0],o=n.args[1],s=n.args[2],p=[],y=i;U.type.is_term(y)&&"^/2"===y.indicator;)p=p.concat(y.args[0].variables()),y=y.args[1];var w=y.variables(),l=N(a(function(r,t){for(var n=[],i=0;i<r.length;i++)-1===e(n,r[i])&&-1===e(t,r[i])&&n.push(r[i]);return n}(w,p),(function(e){return new D(e)})));r.prepend([new q(t.goal.replace(new L(",",[new L("=",[o,y]),new L("=",[s,l])])),t.substitution,t)])},"$member/2":[new U.type.Rule(new U.type.Term("$member",[new U.type.Var("X"),new U.type.Term(".",[new U.type.Var("X"),new U.type.Var("_")])]),null),new U.type.Rule(new U.type.Term("$member",[new U.type.Var("X"),new U.type.Term(".",[new U.type.Var("_"),new U.type.Var("Xs")])]),new U.type.Term("$member",[new U.type.Var("X"),new U.type.Var("Xs")]))],"$bind_bagof_keys/2":[new U.type.Rule(new U.type.Term("$bind_bagof_keys",[new U.type.Term("[]",[]),new U.type.Var("_")]),null),new U.type.Rule(new U.type.Term("$bind_bagof_keys",[new U.type.Term(".",[new U.type.Term("-",[new U.type.Var("Key"),new U.type.Var("_")]),new U.type.Var("Bag")]),new U.type.Var("Vars")]),new U.type.Term(",",[new U.type.Term("term_variables",[new U.type.Var("Key"),new U.type.Var("Vars"),new U.type.Var("_")]),new U.type.Term("$bind_bagof_keys",[new U.type.Var("Bag"),new U.type.Var("Vars")])]))],"$findall/4":[new U.type.Rule(new U.type.Term("$findall",[new U.type.Var("Template0"),new U.type.Var("Goal0"),new U.type.Var("Instances"),new U.type.Var("Tail")]),new U.type.Term(";",[new U.type.Term(",",[new U.type.Term("copy_term",[new U.type.Term("-",[new U.type.Var("Template0"),new U.type.Var("Goal0")]),new U.type.Term("-",[new U.type.Var("Template1"),new U.type.Var("Goal1")])]),new U.type.Term(",",[new U.type.Term("call",[new U.type.Var("Goal1")]),new U.type.Term(",",[new U.type.Term("copy_term",[new U.type.Var("Template1"),new U.type.Var("Template2")]),new U.type.Term(",",[new U.type.Term("$push_global_stack",[new U.type.Var("Var"),new U.type.Var("Template2")]),new U.type.Term("false",[])])])])]),new U.type.Term("$flush_global_stack",[new U.type.Var("Var"),new U.type.Var("Instances"),new U.type.Var("Tail")])]))],"$bagof/3":[new U.type.Rule(new U.type.Term("$bagof",[new U.type.Var("Template"),new U.type.Var("Goal0"),new U.type.Var("Answer")]),new U.type.Term(",",[new U.type.Term("$free_variable_set",[new U.type.Term("^",[new U.type.Var("Template"),new U.type.Var("Goal0")]),new U.type.Var("Goal1"),new U.type.Var("FV")]),new U.type.Term(",",[new U.type.Term("findall",[new U.type.Term("-",[new U.type.Var("FV"),new U.type.Var("Template")]),new U.type.Var("Goal1"),new U.type.Var("Answers"),new U.type.Term("[]",[])]),new U.type.Term(",",[new U.type.Term("$bind_bagof_keys",[new U.type.Var("Answers"),new U.type.Var("_")]),new U.type.Term(",",[new U.type.Term("keygroup",[new U.type.Var("Answers"),new U.type.Var("KeyGroups")]),new U.type.Term(",",[new U.type.Term("keysort",[new U.type.Var("KeyGroups"),new U.type.Var("KeySorted")]),new U.type.Term("$member",[new U.type.Term("-",[new U.type.Var("FV"),new U.type.Var("Answer")]),new U.type.Var("KeySorted")])])])])])]))],"$setof/3":[new U.type.Rule(new U.type.Term("$setof",[new U.type.Var("Template"),new U.type.Var("Goal0"),new U.type.Var("Answer")]),new U.type.Term(",",[new U.type.Term("$free_variable_set",[new U.type.Term("^",[new U.type.Var("Template"),new U.type.Var("Goal0")]),new U.type.Var("Goal1"),new U.type.Var("FV")]),new U.type.Term(",",[new U.type.Term("findall",[new U.type.Term("-",[new U.type.Var("FV"),new U.type.Var("Template")]),new U.type.Var("Goal1"),new U.type.Var("Answers"),new U.type.Term("[]",[])]),new U.type.Term(",",[new U.type.Term("$bind_bagof_keys",[new U.type.Var("Answers"),new U.type.Var("_")]),new U.type.Term(",",[new U.type.Term("keygroup",[new U.type.Var("Answers"),new U.type.Var("KeyGroups")]),new U.type.Term(",",[new U.type.Term("keysort",[new U.type.Var("KeyGroups"),new U.type.Var("KeySorted")]),new U.type.Term(",",[new U.type.Term("$member",[new U.type.Term("-",[new U.type.Var("FV"),new U.type.Var("Unsorted")]),new U.type.Var("KeySorted")]),new U.type.Term("sort",[new U.type.Var("Unsorted"),new U.type.Var("Answer")])])])])])])]))],"$if/3":[new U.type.Rule(new U.type.Term("$if",[new U.type.Var("If"),new U.type.Var("Then"),new U.type.Var("Else")]),new U.type.Term(";",[new U.type.Term(",",[new U.type.Term("call",[new U.type.Var("If")]),new U.type.Term(",",[new U.type.Term("$push_global_stack",[new U.type.Var("Stack"),new U.type.Var("_")]),new U.type.Term("call",[new U.type.Var("Then")])])]),new U.type.Term(",",[new U.type.Term("$flush_global_stack",[new U.type.Var("Stack"),new U.type.Term("[]",[]),new U.type.Term("[]",[])]),new U.type.Term("call",[new U.type.Var("Else")])])]))],"put_attr/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(U.type.is_variable(n))if(U.type.is_atom(i)){var o=r.substitution.set_attribute(n.id,i,a);e.prepend([new q(r.goal.replace(null),o,r)])}else e.throw_error(U.error.type("atom",i,t.indicator));else e.throw_error(U.error.type("variable",n,t.indicator))},"get_attr/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(U.type.is_variable(n))if(U.type.is_atom(i)){var o=r.substitution.get_attribute(n.id,i);o&&e.prepend([new q(r.goal.replace(new L("=",[a,o])),r.substitution,r)])}else e.throw_error(U.error.type("atom",i,t.indicator));else e.throw_error(U.error.type("variable",n,t.indicator))},"op/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(U.type.is_atom(o)&&(o=new L(".",[o,new L("[]")])),U.type.is_variable(i)||U.type.is_variable(a)||U.type.is_variable(o))r.throw_error(U.error.instantiation(n.indicator));else if(U.type.is_integer(i))if(U.type.is_atom(a))if(U.type.is_list(o))if(U.type.is_empty_list(o))r.throw_error(U.error.permission("create","operator",o,n.indicator));else{for(var s=o;U.type.is_term(s)&&"./2"===s.indicator;){var p=s.args[0];if(s=s.args[1],U.type.is_variable(p))return void r.throw_error(U.error.instantiation(n.indicator));if(!U.type.is_atom(p))return void r.throw_error(U.error.type("atom",p,n.indicator));if(i.value<0||i.value>1200)return void r.throw_error(U.error.domain("operator_priority",i,n.indicator));if(","===p.id)return void r.throw_error(U.error.permission("modify","operator",p,n.indicator));if("{}"===p.id)return void r.throw_error(U.error.permission("create","operator",p,n.indicator));if("[]"===p.id)return void r.throw_error(U.error.permission("create","operator",p,n.indicator));if("|"===p.id&&0!==i.value&&(i.value<1001||3!==a.id.length))return void r.throw_error(U.error.permission("create","operator",p,n.indicator));if(-1===["fy","fx","yf","xf","xfx","yfx","xfy"].indexOf(a.id))return void r.throw_error(U.error.domain("operator_specifier",a,n.indicator));var y,w={prefix:null,infix:null,postfix:null};for(var l in r.session.__operators)if(r.session.__operators.hasOwnProperty(l)){var _=r.session.__operators[l][p.id];_&&(-1!==e(_,"fx")&&(w.prefix={priority:l,type:"fx"}),-1!==e(_,"fy")&&(w.prefix={priority:l,type:"fy"}),-1!==e(_,"xf")&&(w.postfix={priority:l,type:"xf"}),-1!==e(_,"yf")&&(w.postfix={priority:l,type:"yf"}),-1!==e(_,"xfx")&&(w.infix={priority:l,type:"xfx"}),-1!==e(_,"xfy")&&(w.infix={priority:l,type:"xfy"}),-1!==e(_,"yfx")&&(w.infix={priority:l,type:"yfx"}))}switch(a.id){case"fy":case"fx":y="prefix";break;case"yf":case"xf":y="postfix";break;default:y="infix"}if(w.infix&&"postfix"===y||w.postfix&&"infix"===y)return void r.throw_error(U.error.permission("create","operator",p,n.indicator));w[y]&&(R(r.session.__operators[w[y].priority][p.id],w[y].type),0===r.session.__operators[w[y].priority][p.id].length&&delete r.session.__operators[w[y].priority][p.id]),i.value>0&&(r.session.__operators[i.value]||(r.session.__operators[i.value.toString()]={}),r.session.__operators[i.value][p.id]||(r.session.__operators[i.value][p.id]=[]),r.session.__operators[i.value][p.id].push(a.id))}if(U.type.is_variable(s))return void r.throw_error(U.error.instantiation(n.indicator));if(!U.type.is_term(s)||"[]/0"!==s.indicator)return void r.throw_error(U.error.type("list",o,n.indicator));r.success(t)}else r.throw_error(U.error.type("list",o,n.indicator));else r.throw_error(U.error.type("atom",a,n.indicator));else r.throw_error(U.error.type("integer",i,n.indicator))},"current_op/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2],s=[];if(U.type.is_variable(i)||U.type.is_integer(i))if(U.type.is_integer(i)&&(i.value<0||i.value>1200))r.throw_error(U.error.domain("operator_priority",i,n.indicator));else if(U.type.is_variable(a)||U.type.is_atom(a))if(U.type.is_atom(a)&&-1===e(["fy","fx","yf","xf","xfx","yfx","xfy"],a.id))r.throw_error(U.error.domain("operator_specifier",a,n.indicator));else if(U.type.is_variable(o)||U.type.is_atom(o)){for(var p in r.session.__operators)for(var y in r.session.__operators[p])for(var w=0;w<r.session.__operators[p][y].length;w++)s.push(new q(t.goal.replace(new L(",",[new L("=",[new C(p,!1),i]),new L(",",[new L("=",[new L(r.session.__operators[p][y][w],[]),a]),new L("=",[new L(y,[]),o])])])),t.substitution,t));r.prepend(s)}else r.throw_error(U.error.type("atom",o,n.indicator));else r.throw_error(U.error.type("atom",a,n.indicator));else r.throw_error(U.error.type("integer",i,n.indicator))},";/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=n.args[0],o=":/2"===n.indicator?n.args[1]:n;if(U.type.is_term(o)&&"->/2"===o.indicator){var s=":/2"===n.indicator?new L(":",[a,new L("call",[o.args[0]])]):o.args[0],p=":/2"===n.indicator?new L(":",[a,o.args[1]]):o.args[1],y=i,w=r.goal.replace(new L(",",[s,new L(",",[new L("!"),p])])),l=r.goal.replace(new L(",",[new L("!"),y]));e.prepend([new q(w,r.substitution,r),new q(l,r.substitution,r)])}else if(U.type.is_term(o)&&"*->/2"===o.indicator){s=":/2"===n.indicator?new L(":",[a,o.args[0]]):o.args[0],p=":/2"===n.indicator?new L(":",[a,o.args[1]]):o.args[1],y=i;e.prepend([new q(r.goal.replace(new L("$if",[s,p,y])),r.substitution,r)])}else e.prepend([new q(r.goal.replace(n),r.substitution,r),new q(r.goal.replace(i),r.substitution,r)])},"!/0":function(e,r,t){var n,i,a=[];for(n=r,i=null;null!==n.parent&&n.parent.goal.search(t);)if(i=n,null!==(n=n.parent).goal){var o=n.goal.select();if(o&&":/2"===o.indicator&&(o=o.args[1]),o&&"call"===o.id&&o.search(t)){n=i;break}}for(var s=null,p=e.points.length-1;p>=0;p--){for(var y=e.points[p],w=y.parent;null!==w&&w!==n.parent;)w=w.parent;null===w&&w!==n.parent?a.push(y):y.setup_call_cleanup_goal&&(s=y.setup_call_cleanup_goal)}e.points=a.reverse(),e.prepend([new q(r.goal.replace(s),r.substitution,r)])},"\\+/1":function(e,r,t){var n=t.args[0];U.type.is_variable(n)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_callable(n)?e.prepend([new q(r.goal.replace(new L(",",[new L(",",[new L("call",[n]),new L("!",[])]),new L("fail",[])])),r.substitution,r),new q(r.goal.replace(null),r.substitution,r)]):e.throw_error(U.error.type("callable",n,t.indicator))},"->/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=r.goal.replace(new L(",",[new L("call",[n]),new L(",",[new L("!"),i])]));e.prepend([new q(a,r.substitution,r)])},"*->/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=r.goal.replace(new L(",",[new L("call",[n]),i]));e.prepend([new q(a,r.substitution,r)])},"fail/0":function(e,r,t){},"false/0":function(e,r,t){},"true/0":function(e,r,t){e.success(r)},"call/1":X(1),"call/2":X(2),"call/3":X(3),"call/4":X(4),"call/5":X(5),"call/6":X(6),"call/7":X(7),"call/8":X(8),"once/1":function(e,r,t){var n=t.args[0];e.prepend([new q(r.goal.replace(new L(",",[new L("call",[n]),new L("!",[])])),r.substitution,r)])},"forall/2":function(e,r,t){var n=t.args[0],i=t.args[1];e.prepend([new q(r.goal.replace(new L("\\+",[new L(",",[new L("call",[n]),new L("\\+",[new L("call",[i])])])])),r.substitution,r)])},"repeat/0":function(e,r,t){e.prepend([new q(r.goal.replace(null),r.substitution,r),r])},"throw/1":function(e,r,t){var n=t.args[0];if(U.type.is_variable(n))e.throw_error(U.error.instantiation(e.level.indicator));else{for(var i=0;i<e.points.length;i++){var a=e.points[i];if(a.setup_call_cleanup_catch)return void(e.points=[new q(new L(",",[new L("catch",[a.setup_call_cleanup_catch,new D("_"),new L("throw",[n])]),new L("throw",[n])]),r.substitution,r)])}e.throw_error(n)}},"catch/3":function(e,r,t){var n,i=t.args[0],a=t.args[1],o=t.args[2];r.catch?n=r.catch:((n=new J(e.session)).debugger=e.debugger,n.format_success=function(e){return e.substitution},n.format_error=function(e){return e.goal},n.add_goal(i,!0,r),r.catch=n);return n.answer((function(t){if(U.type.is_error(t)){var n="true/0"===e.get_flag("occurs_check").indicator,i=new q,s=U.unify(t.args[0],a,n);null!==s?(i.substitution=r.substitution.apply(s),i.goal=r.goal.replace(o).apply(s),i.parent=r,e.prepend([i])):e.throw_error(t.args[0])}else if(!1!==t&&null!==t){i=null===t?[]:new q(r.goal.apply(t).replace(null),r.substitution.apply(t),r);e.prepend([i,r])}else null===t&&(e.prepend([r]),e.has_limit&&(e.current_limit=0));e.again(null!==t)})),!0},"call_cleanup/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(U.type.is_variable(n)||U.type.is_variable(i))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_callable(n)){if(U.type.is_callable(i)){var a,o;if(r.hasOwnProperty("setup_call_cleanup_thread"))a=r.setup_call_cleanup_thread,o=r.setup_call_cleanup_callback;else{var s=new L("call",[n]);(a=new J(e.session)).add_goal(s,!0,r),o=function(t){if(null===t)(s=new q(r.goal,r.substitution,r)).setup_call_cleanup_thread=a,s.setup_call_cleanup_callback=o,e.prepend([s]);else if(!1===t){var n=new L(",",[new L("call",[i]),new L("fail")]),s=new q(r.goal.replace(n),r.substitution,r);e.prepend([s])}else if(U.type.is_error(t)){var p=new L(",",[new L("call",[i]),t]);s=new q(r.goal.replace(p),r.substitution,r);e.prepend([s])}else if(0===a.points.length){s=new q(r.goal.replace(new L("call",[i])).apply(t),r.substitution.apply(t),r);e.prepend([s])}else{var y=new q(r.goal.apply(t).replace(null),r.substitution.apply(t),r),w=new q(r.goal,r.substitution,r);w.setup_call_cleanup_thread=a,w.setup_call_cleanup_callback=o,w.setup_call_cleanup_goal=i.apply(t),w.setup_call_cleanup_catch=i,e.prepend([y,w])}e.again()}}return a.answer(o),!0}e.throw_error(U.error.type("callable",i,t.indicator))}else e.throw_error(U.error.type("callable",n,t.indicator))},"setup_call_cleanup/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];U.type.is_variable(n)||U.type.is_variable(i)||U.type.is_variable(a)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_callable(n)?U.type.is_callable(i)?U.type.is_callable(a)?e.prepend([new q(r.goal.replace(new L(",",[new L("once",[n]),new L("call_cleanup",[i,a])])),r.substitution,r)]):e.throw_error(U.error.type("callable",a,t.indicator)):e.throw_error(U.error.type("callable",i,t.indicator)):e.throw_error(U.error.type("callable",n,t.indicator))},"=/2":function(e,r,t){var n="true/0"===e.get_flag("occurs_check").indicator,i=new q,a=U.unify(t.args[0],t.args[1],n);null!==a&&(i.goal=r.goal.apply(a).replace(null),i.substitution=r.substitution.apply(a),i.parent=r,e.prepend([i]))},"unify_with_occurs_check/2":function(e,r,t){var n=new q,i=U.unify(t.args[0],t.args[1],!0);null!==i&&(n.goal=r.goal.apply(i).replace(null),n.substitution=r.substitution.apply(i),n.parent=r,e.prepend([n]))},"\\=/2":function(e,r,t){var n="true/0"===e.get_flag("occurs_check").indicator;null===U.unify(t.args[0],t.args[1],n)&&e.success(r)},"subsumes_term/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=e.next_free_variable(),o=e.next_free_variable();e.prepend([new q(r.goal.replace(new L("\\+",[new L("\\+",[new L(",",[new L("term_variables",[i,a]),new L(",",[new L("unify_with_occurs_check",[n,i]),new L(",",[new L("term_variables",[a,o]),new L("==",[a,o])])])])])])),r.substitution,r)])},"findall/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2],o=new L("[]",[]);e.prepend([new q(r.goal.replace(new L("findall",[n,i,a,o])),r.substitution,r)])},"findall/4":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2],o=t.args[3],s=i;U.type.is_term(i)&&":/2"===i.indicator&&(s=i.args[1]),U.type.is_variable(s)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_callable(s)?U.type.is_variable(a)||U.type.is_list(a)?U.type.is_variable(o)||U.type.is_list(o)?e.prepend([new q(r.goal.replace(new L("$findall",[n,i,a,o])),r.substitution,r)]):e.throw_error(U.error.type("list",o,t.indicator)):e.throw_error(U.error.type("list",a,t.indicator)):e.throw_error(U.error.type("callable",i,t.indicator))},"bagof/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];U.type.is_variable(i)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_callable(i)?U.type.is_variable(a)||U.type.is_list(a)?e.prepend([new q(r.goal.replace(new L("$bagof",[n,i,a])),r.substitution,r)]):e.throw_error(U.error.type("list",a,t.indicator)):e.throw_error(U.error.type("callable",i,t.indicator))},"setof/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];U.type.is_variable(i)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_callable(i)?U.type.is_variable(a)||U.type.is_list(a)?e.prepend([new q(r.goal.replace(new L("$setof",[n,i,a])),r.substitution,r)]):e.throw_error(U.error.type("list",a,t.indicator)):e.throw_error(U.error.type("callable",i,t.indicator))},"functor/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(U.type.is_variable(n)&&(U.type.is_variable(i)||U.type.is_variable(a)))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(a)||U.type.is_integer(a))if(U.type.is_variable(i)||U.type.is_atomic(i))if(U.type.is_variable(n)&&!U.type.is_atom(i)&&U.type.is_integer(a)&&a.value>0)e.throw_error(U.error.type("atom",t.args[1],t.indicator));else if(U.type.is_variable(n)&&U.type.is_integer(a)&&a.value<0)e.throw_error(U.error.domain("not_less_than_zero",t.args[2],t.indicator));else if(U.type.is_variable(n)){if(t.args[2].value>=0){for(var o=[],s=0;s<a.value;s++)o.push(e.next_free_variable());var p=U.type.is_number(i)?i:new L(i.id,o);e.prepend([new q(r.goal.replace(new L("=",[n,p])),r.substitution,r)])}}else{var y=U.type.is_number(n)?n:new L(n.id,[]),w=U.type.is_number(n)?new C(0,!1):new C(n.args.length,!1),l=new L(",",[new L("=",[y,i]),new L("=",[w,a])]);e.prepend([new q(r.goal.replace(l),r.substitution,r)])}else e.throw_error(U.error.type("atomic",t.args[1],t.indicator));else e.throw_error(U.error.type("integer",t.args[2],t.indicator))},"arg/3":function(e,r,t){if(U.type.is_variable(t.args[0])||U.type.is_variable(t.args[1]))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_integer(t.args[0]))if(t.args[0].value<0)e.throw_error(U.error.domain("not_less_than_zero",t.args[0],t.indicator));else if(U.type.is_compound(t.args[1])){var n=t.args[0].value;if(n>0&&n<=t.args[1].args.length){var i=new L("=",[t.args[1].args[n-1],t.args[2]]);e.prepend([new q(r.goal.replace(i),r.substitution,r)])}}else e.throw_error(U.error.type("compound",t.args[1],t.indicator));else e.throw_error(U.error.type("integer",t.args[0],t.indicator))},"=../2":function(e,r,t){var n;if(U.type.is_variable(t.args[0])&&(U.type.is_variable(t.args[1])||U.type.is_non_empty_list(t.args[1])&&U.type.is_variable(t.args[1].args[0])))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_fully_list(t.args[1]))if(U.type.is_variable(t.args[0])&&U.type.is_empty_list(t.args[1]))e.throw_error(U.error.domain("non_empty_list",t.args[1],t.indicator));else if(U.type.is_variable(t.args[0])){if(!U.type.is_variable(t.args[1])){var i=[];for(n=t.args[1].args[1];"./2"===n.indicator;)i.push(n.args[0]),n=n.args[1];U.type.is_variable(t.args[0])&&U.type.is_variable(n)?e.throw_error(U.error.instantiation(t.indicator)):0===i.length&&U.type.is_compound(t.args[1].args[0])?e.throw_error(U.error.type("atomic",t.args[1].args[0],t.indicator)):i.length>0&&(U.type.is_compound(t.args[1].args[0])||U.type.is_number(t.args[1].args[0]))?e.throw_error(U.error.type("atom",t.args[1].args[0],t.indicator)):0===i.length?e.prepend([new q(r.goal.replace(new L("=",[t.args[1].args[0],t.args[0]],r)),r.substitution,r)]):e.prepend([new q(r.goal.replace(new L("=",[new L(t.args[1].args[0].id,i),t.args[0]])),r.substitution,r)])}}else{if(U.type.is_term(t.args[0])&&t.args[0].args.length>0){n=new L("[]");for(var a=t.args[0].args.length-1;a>=0;a--)n=new L(".",[t.args[0].args[a],n]);n=new L(".",[new L(t.args[0].id),n])}else n=new L(".",[t.args[0],new L("[]")]);e.prepend([new q(r.goal.replace(new L("=",[n,t.args[1]])),r.substitution,r)])}else e.throw_error(U.error.type("list",t.args[1],t.indicator))},"copy_term/2":function(e,r,t){var n=t.args[0],i=t.args[1];e.session.renamed_variables={};var a=n.rename(e);e.session.renamed_variables={},e.prepend([new q(r.goal.replace(new L("=",[i,a])),r.substitution,r)])},"term_variables/2":[new U.type.Rule(new U.type.Term("term_variables",[new U.type.Var("Term"),new U.type.Var("Vars")]),new U.type.Term("term_variables",[new U.type.Var("Term"),new U.type.Var("Vars"),new U.type.Term("[]",[])]))],"term_variables/3":function(e,r,t){var n=t.args[0],i=t.args[1],o=t.args[2];if(U.type.is_fully_list(i)){var s=N(a(M(n.variables()),(function(e){return new D(e)})),o);e.prepend([new q(r.goal.replace(new L("=",[i,s])),r.substitution,r)])}else e.throw_error(U.error.type("list",i,t.indicator))},"numbervars/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(U.type.is_variable(i))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_integer(i))if(U.type.is_variable(a)||U.type.is_integer(a)){for(var o=M(n.variables()),s=i.value,p=new L("true"),y=0;y<o.length;y++)p=new L(",",[new L("=",[new D(o[y]),new L("$VAR",[new C(s,!1)])]),p]),s++;var w=new L("=",[a,new C(s,!1)]);(U.type.is_variable(a)||a.value===s)&&e.prepend([new q(r.goal.replace(new L(",",[p,w])),r.substitution,r)])}else e.throw_error(U.error.type("integer",a,t.indicator));else e.throw_error(U.error.type("integer",i,t.indicator))},"clause/2":function(e,r,t){var n=t.args[0],i=t.args[1],a="user";if(U.type.is_term(n)&&":/2"===n.indicator){if(!U.type.is_atom(n.args[0]))return void e.throw_error(U.error.type("module",n.args[0],t.indicator));a=n.args[0].id,n=n.args[1]}var o=e.session.modules[a];if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_callable(n))if(U.type.is_variable(i)||U.type.is_callable(i)){if(",/2"===n.indicator||e.session.modules.system.rules.hasOwnProperty(n.indicator))e.throw_error(U.error.permission("access","private_procedure",P(n.indicator),t.indicator));else if(U.type.is_module(o)&&o.rules[n.indicator])if(o.is_public_predicate(n.indicator)){var s=[];if("function"==typeof o.rules[n.indicator])return void e.throw_error(U.error.permission("modify","static_procedure",P(n.indicator),t.indicator));for(var p=0;p<o.rules[n.indicator].length;p++){var y=o.rules[n.indicator][p];e.session.renamed_variables={},null===(y=y.rename(e)).body&&(y.body=new L("true"));var w=new L(",",[new L("=",[y.head,n]),new L("=",[y.body,i])]);s.push(new q(r.goal.replace(w),r.substitution,r))}e.prepend(s)}else e.throw_error(U.error.permission("access","private_procedure",P(n.indicator),t.indicator))}else e.throw_error(U.error.type("callable",i,t.indicator));else e.throw_error(U.error.type("callable",n,t.indicator))},"current_predicate/1":function(e,r,t){var n,i=t.args[0];if(U.type.is_term(i)&&":/2"===i.indicator){if(!U.type.is_atom(i.args[0]))return void e.throw_error(U.error.type("module",i.args[0],t.indicator));n=i.args[0].id,i=i.args[1]}else n="user";if(U.type.is_variable(i)||U.type.is_compound(i)&&"//2"===i.indicator)if(U.type.is_variable(i)||U.type.is_variable(i.args[0])||U.type.is_atom(i.args[0]))if(U.type.is_variable(i)||U.type.is_variable(i.args[1])||U.type.is_integer(i.args[1]))if(!U.type.is_variable(i)&&U.type.is_integer(i.args[1])&&i.args[1].value<0)e.throw_error(U.error.domain("not_less_than_zero",i.args[1],t.indicator));else{var a=[],o=e.session.modules[n];if(U.type.is_module(o)){for(var s in o.rules)if(o.rules.hasOwnProperty(s)){var p=new L("=",[P(s),i]);a.push(new q(r.goal.replace(p),r.substitution,r))}e.prepend(a)}}else e.throw_error(U.error.type("integer",i.args[1],t.indicator));else e.throw_error(U.error.type("atom",i.args[0],t.indicator));else e.throw_error(U.error.type("predicate_indicator",i,t.indicator))},"current_module/1":function(e,r,t){var n=t.args[0];if(U.type.is_variable(n)||U.type.is_atom(n))if(U.type.is_variable(n)){var i=[];for(var a in e.session.modules)e.session.modules.hasOwnProperty(a)&&i.push(new q(r.goal.replace(new L("=",[n,new L(a)])),r.substitution,r));e.prepend(i)}else e.session.modules.hasOwnProperty(n.id)&&e.success(r);else e.throw_error(U.error.type("atom",n,t.indicator))},"predicate_property/2":function(e,r,t){var n,i=t.args[0],a=t.args[1];if(U.type.is_term(i)&&":/2"===i.indicator){if(!U.type.is_atom(i.args[0]))return void e.throw_error(U.error.type("module",i.args[0],t.indicator));n=i.args[0].id,i=i.args[1]}if(U.type.is_variable(i)||U.type.is_callable(i))if(U.type.is_variable(a)||U.type.is_predicate_property(a)){var o=n?e.session.modules[n]:e.session.modules.user,s=[];if(U.type.is_variable(i)){if(!n)for(var p in U.builtin.rules)if(U.builtin.rules.hasOwnProperty(p)){for(var y=P(p),w=[],l=0;l<y.args[1].value;l++)w.push(e.next_free_variable());var _=new L(y.args[0].id,w),u=[new L("static"),new L("built_in"),new L("native_code")];U.builtin.meta_predicates.hasOwnProperty(p)&&u.push(new L("meta_predicate",[U.builtin.meta_predicates[p]]));for(l=0;l<u.length;l++)(U.type.is_variable(a)||u[l].indicator===a.indicator)&&s.push(new q(r.goal.replace(new L(",",[new L("=",[i,_]),new L("=",[a,u[l]])])),r.substitution,r))}if(U.type.is_module(o))for(var p in o.rules)if(o.rules.hasOwnProperty(p)){for(y=P(p),w=[],l=0;l<y.args[1].value;l++)w.push(e.next_free_variable());_=new L(y.args[0].id,w),u=[];e.is_public_predicate(p,n)?u.push(new L("dynamic")):u.push(new L("static")),o.rules[p]instanceof Function&&u.push(new L("native_code")),e.is_multifile_predicate(p,n)&&u.push(new L("multifile")),o.meta_predicates.hasOwnProperty(p)&&u.push(new L("meta_predicate",[o.meta_predicates[p]]));for(l=0;l<u.length;l++)(U.type.is_variable(a)||u[l].indicator===a.indicator)&&s.push(new q(r.goal.replace(new L(",",[new L("=",[i,_]),new L("=",[a,u[l]])])),r.substitution,r))}}else{var c=!n&&U.type.is_builtin(i),m=c?U.builtin.rules[i.indicator]:o.rules[i.indicator];if(o=c?U.builtin:o,m){c?u=[new L("static"),new L("built_in"),new L("native_code")]:(u=[],e.is_public_predicate(i.indicator,n)?u.push(new L("dynamic")):u.push(new L("static")),m instanceof Function&&u.push(new L("native_code")),e.is_multifile_predicate(i.indicator,n)&&u.push(new L("multifile"))),o.meta_predicates.hasOwnProperty(i.indicator)&&u.push(new L("meta_predicate",[o.meta_predicates[i.indicator]]));for(w=[],l=0;l<i.args.length;l++)w.push(e.next_free_variable());for(_=new L(i.id,w),l=0;l<u.length;l++)(U.type.is_variable(a)||u[l].indicator===a.indicator)&&s.push(new q(r.goal.replace(new L(",",[new L("=",[i,_]),new L("=",[a,u[l]])])),r.substitution,r))}}e.prepend(s)}else e.throw_error(U.error.domain("predicate_property",a,t.indicator));else e.throw_error(U.error.type("callable",i,t.indicator))},"listing/0":function(e,r,t){var n=t.context_module?t.context_module:"user",i={};U.type.is_module(e.session.modules[n])&&(i=e.session.modules[n].rules);var a="";for(var o in i)if(i.hasOwnProperty(o)){var s=i[o];if(a+="% "+o+"\n",s instanceof Array)for(var p=0;p<s.length;p++)a+=s[p].toString({session:e.session})+"\n";else a+="/*\n"+s.toString()+"\n*/";a+="\n"}e.prepend([new q(r.goal.replace(new L("write",[new L(a,[])])),r.substitution,r)])},"listing/1":function(e,r,t){var n=t.args[0],i="user";if(":/2"===n.indicator&&(i=n.args[0].id,n=n.args[1]),U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_predicate_indicator(n)){var a={};U.type.is_module(e.session.modules[i])&&(a=e.session.modules[i].rules);var o="",s=n.args[0].id+"/"+n.args[1].value;if(a.hasOwnProperty(s)){var p=a[s];if(p instanceof Array)for(var y=0;y<p.length;y++)o+=p[y].toString({session:e.session})+"\n";else o+="/*\n"+p.toString()+"\n*/";o+="\n"}e.prepend([new q(r.goal.replace(new L("write",[new L(o,[])])),r.substitution,r)])}else e.throw_error(U.error.type("predicate_indicator",n,t.indicator))},"sort/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_fully_list(i)){for(var a=[],o=n;"./2"===o.indicator;)a.push(o.args[0]),o=o.args[1];if(U.type.is_variable(o))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_empty_list(o)){for(var s=a.sort(U.compare),p=s.length-1;p>0;p--)s[p].equals(s[p-1])&&s.splice(p,1);var y=new L("[]");for(p=s.length-1;p>=0;p--)y=new L(".",[s[p],y]);e.prepend([new q(r.goal.replace(new L("=",[y,i])),r.substitution,r)])}else e.throw_error(U.error.type("list",n,t.indicator))}else e.throw_error(U.error.type("list",i,t.indicator))},"keysort/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_fully_list(i)){for(var a,o=[],s=n;"./2"===s.indicator;){if(a=s.args[0],U.type.is_variable(a))return void e.throw_error(U.error.instantiation(t.indicator));if(!U.type.is_term(a)||"-/2"!==a.indicator)return void e.throw_error(U.error.type("pair",a,t.indicator));a.args[0].pair=a.args[1],o.push(a.args[0]),s=s.args[1]}if(U.type.is_variable(s))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_empty_list(s)){if(!U.type.is_variable(i)){for(s=i;U.type.is_term(s)&&"./2"===s.indicator;){var p=s.args[0];if(!(U.type.is_variable(p)||U.type.is_term(p)&&"-/2"===p.indicator))return void e.throw_error(U.error.type("pair",p,t.indicator));s=s.args[1]}if(!U.type.is_variable(s)&&!U.type.is_empty_list(s))return void e.throw_error(U.error.type("list",i,t.indicator))}for(var y=o.sort(U.compare),w=new U.type.Term("[]"),l=y.length-1;l>=0;l--)w=new U.type.Term(".",[new U.type.Term("-",[y[l],y[l].pair]),w]),delete y[l].pair;e.prepend([new U.type.State(r.goal.replace(new U.type.Term("=",[w,i])),r.substitution,r)])}else e.throw_error(U.error.type("list",n,t.indicator))}else e.throw_error(U.error.type("list",i,t.indicator))},"keygroup/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_fully_list(i)){for(var a=[],o=[],s=n;U.type.is_term(s)&&"./2"===s.indicator;){var p=s.args[0];if(U.type.is_variable(p))return void e.throw_error(U.error.instantiation(t.indicator));if(!U.type.is_term(p)||"-/2"!==p.indicator)return void e.throw_error(U.error.type("pair",p,t.indicator));for(var y=p.args[0],w=p.args[1],l=-1,_=0;_<a.length;_++)if(0===U.compare(y,a[_])){l=_;break}-1===l&&(l=a.length,a.push(y),o.push([])),o[l].push(w),s=s.args[1]}if(U.type.is_variable(s))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_empty_list(s)){if(!U.type.is_variable(i)){for(s=i;U.type.is_term(s)&&"./2"===s.indicator;){var u=s.args[0];if(!(U.type.is_variable(u)||U.type.is_term(u)&&"-/2"===u.indicator))return void e.throw_error(U.error.type("pair",u,t.indicator));s=s.args[1]}if(!U.type.is_variable(s)&&!U.type.is_empty_list(s))return void e.throw_error(U.error.type("list",i,t.indicator))}group=new L("[]",[]);for(_=a.length-1;_>=0;_--)group=new L(".",[new L("-",[a[_],N(o[_])]),group]);e.prepend([new q(r.goal.replace(new U.type.Term("=",[i,group])),r.substitution,r)])}else e.throw_error(U.error.type("list",n,t.indicator))}else e.throw_error(U.error.type("list",i,t.indicator))},"asserta/1":function(e,r,t){var n=t.args[0],i="user";if(U.type.is_term(n)&&":/2"===n.indicator&&(i=n.args[0].id,n=n.args[1]),U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_callable(n)){var a,o,s;":-/2"===n.indicator?(a=n.args[0],o=A(n.args[1])):(a=n,o=null),U.type.is_variable(a)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_callable(a)?null===o||U.type.is_callable(o)?U.type.is_module(e.session.modules[i])&&!e.is_public_predicate(a.indicator,i)||",/2"===a.indicator||e.session.modules.system.rules.hasOwnProperty(a.indicator)?e.throw_error(U.error.permission("modify","static_procedure",P(a.indicator),t.indicator)):(U.type.is_module(e.session.modules[i])?s=e.session.modules[i]:(s=new $(i,{},"all",{session:e.session}),e.session.modules[i]=s),void 0===s.rules[a.indicator]&&(s.rules[a.indicator]=[]),s.public_predicates[a.indicator]=!0,s.rules[a.indicator]=[new H(a,o,!0)].concat(s.rules[a.indicator]),s.update_indices_predicate(a.indicator),e.success(r)):e.throw_error(U.error.type("callable",o,t.indicator)):e.throw_error(U.error.type("callable",a,t.indicator))}else e.throw_error(U.error.type("callable",n,t.indicator))},"assertz/1":function(e,r,t){var n=t.args[0],i="user";if(U.type.is_term(n)&&":/2"===n.indicator&&(i=n.args[0].id,n=n.args[1]),U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_callable(n)){var a,o,s;":-/2"===n.indicator?(a=n.args[0],o=A(n.args[1])):(a=n,o=null),U.type.is_variable(a)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_callable(a)?null===o||U.type.is_callable(o)?U.type.is_module(e.session.modules[i])&&!e.is_public_predicate(a.indicator,i)||",/2"===a.indicator||e.session.modules.system.rules.hasOwnProperty(a.indicator)?e.throw_error(U.error.permission("modify","static_procedure",P(a.indicator),t.indicator)):(U.type.is_module(e.session.modules[i])?s=e.session.modules[i]:(s=new $(i,{},"all",{session:e.session}),e.session.modules[i]=s),void 0===s.rules[a.indicator]&&(s.rules[a.indicator]=[]),s.public_predicates[a.indicator]=!0,s.rules[a.indicator].push(new H(a,o,!0)),s.update_indices_predicate(a.indicator),e.success(r)):e.throw_error(U.error.type("callable",o,t.indicator)):e.throw_error(U.error.type("callable",a,t.indicator))}else e.throw_error(U.error.type("callable",n,t.indicator))},"retract/1":function(e,r,t){var n=t.args[0];if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_callable(n)){var i,a,o,s;if(":/2"===n.indicator){if(o=n.args[0],n=n.args[1],!U.type.is_atom(o))return void e.throw_error(U.error.type("module",o,t.indicator))}else o=new L("user");if(":-/2"===n.indicator?(i=n.args[0],a=n.args[1]):(i=n,a=new L("true")),U.type.is_variable(i))return void e.throw_error(U.error.instantiation(t.indicator));if(!U.type.is_callable(i))return void e.throw_error(U.error.type("callable",i,t.indicator));s=o.id;var p=e.session.modules[s];if(!U.type.is_module(p))return;if(r.retract)!function(e,r,t,n,i){if(i.rules[t])for(var a=0;a<i.rules[t].length;a++)if(i.rules[t][a]===n){i.rules[t].splice(a,1),i.update_indices_predicate(t),e.success(r);break}}(e,r,i.indicator,r.retract,p);else if(e.is_public_predicate(i.indicator,s)&&",/2"!==i.indicator&&!e.session.modules.system.rules.hasOwnProperty(i.indicator)){if(void 0!==p.rules[i.indicator]){var y=[];if("function"==typeof p.rules[i.indicator])return void e.throw_error(U.error.permission("modify","static_procedure",P(i.indicator),t.indicator));for(var w=0;w<p.rules[i.indicator].length;w++){e.session.renamed_variables={};var l=p.rules[i.indicator][w],_=l.rename(e);null===_.body&&(_.body=new L("true",[]));var u="true/0"===e.get_flag("occurs_check").indicator;if(null!==U.unify(new L(",",[i,a]),new L(",",[_.head,_.body]),u)){var c=new q(r.goal.replace(new L(",",[new L(":",[o,new L("retract",[new L(":-",[i,a])])]),new L(",",[new L("=",[i,_.head]),new L("=",[a,_.body])])])),r.substitution,r);c.retract=l,y.push(c)}}e.prepend(y)}}else e.throw_error(U.error.permission("modify","static_procedure",P(i.indicator),t.indicator))}else e.throw_error(U.error.type("callable",n,t.indicator))},"retractall/1":function(e,r,t){var n=t.args[0],i="user";U.type.is_term(n)&&":/2"===n.indicator&&(i=n.args[0].id,n=n.args[1]),U.type.is_variable(n)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_callable(n)?!e.is_public_predicate(n.indicator,i)||",/2"===n.indicator||e.session.modules.system.rules.hasOwnProperty(n.indicator)?e.throw_error(U.error.permission("modify","static_procedure",P(n.indicator),t.indicator)):e.prepend([new q(r.goal.replace(new L(",",[new L(":",[new L(i),new L("retract",[new U.type.Term(":-",[n,new D("_")])])]),new L("fail",[])])),r.substitution,r),new q(r.goal.replace(null),r.substitution,r)]):e.throw_error(U.error.type("callable",n,t.indicator))},"abolish/1":function(e,r,t){var n,i=t.args[0];if(U.type.is_term(i)&&":/2"===i.indicator){if(!U.type.is_atom(i.args[0]))return void e.throw_error(U.error.type("module",i.args[0],t.indicator));n=i.args[0].id,i=i.args[1]}else n="user";if(U.type.is_variable(i)||U.type.is_term(i)&&"//2"===i.indicator&&(U.type.is_variable(i.args[0])||U.type.is_variable(i.args[1])))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_term(i)&&"//2"===i.indicator)if(U.type.is_atom(i.args[0]))if(U.type.is_integer(i.args[1]))if(i.args[1].value<0)e.throw_error(U.error.domain("not_less_than_zero",i.args[1],t.indicator));else if(U.type.is_number(e.get_flag("max_arity"))&&i.args[1].value>e.get_flag("max_arity").value)e.throw_error(U.error.representation("max_arity",t.indicator));else{var a=e.session.modules[n];if(U.type.is_module(a)){var o=i.args[0].id+"/"+i.args[1].value;e.is_public_predicate(o,n)&&",/2"!==o&&!e.session.modules.system.rules.hasOwnProperty(o)?(delete a.rules[o],delete a.indexed_clauses[o],delete a.non_indexable_clauses[o],delete a.public_predicates[o],delete a.multifile_predicates[o],e.success(r)):e.throw_error(U.error.permission("modify","static_procedure",t.args[0],t.indicator))}else e.success(r)}else e.throw_error(U.error.type("integer",i.args[1],t.indicator));else e.throw_error(U.error.type("atom",i.args[0],t.indicator));else e.throw_error(U.error.type("predicate_indicator",i,t.indicator))},"atom_length/2":function(e,r,t){if(U.type.is_variable(t.args[0]))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_atom(t.args[0]))if(U.type.is_variable(t.args[1])||U.type.is_integer(t.args[1]))if(U.type.is_integer(t.args[1])&&t.args[1].value<0)e.throw_error(U.error.domain("not_less_than_zero",t.args[1],t.indicator));else{var n=new C(y(t.args[0].id),!1);e.prepend([new q(r.goal.replace(new L("=",[n,t.args[1]])),r.substitution,r)])}else e.throw_error(U.error.type("integer",t.args[1],t.indicator));else e.throw_error(U.error.type("atom",t.args[0],t.indicator))},"atom_concat/3":function(e,r,t){var n,i,a=t.args[0],o=t.args[1],s=t.args[2];if(U.type.is_variable(s)&&(U.type.is_variable(a)||U.type.is_variable(o)))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(a)||U.type.is_atom(a))if(U.type.is_variable(o)||U.type.is_atom(o))if(U.type.is_variable(s)||U.type.is_atom(s)){var p=U.type.is_variable(a),y=U.type.is_variable(o);if(p||y)if(p&&!y)(n=s.id.substr(0,s.id.length-o.id.length))+o.id===s.id&&(i=new L("=",[a,new L(n)]),e.prepend([new q(r.goal.replace(i),r.substitution,r)]));else if(y&&!p)n=s.id.substr(a.id.length),a.id+n===s.id&&(i=new L("=",[o,new L(n)]),e.prepend([new q(r.goal.replace(i),r.substitution,r)]));else{for(var w=[],l=0;l<=s.id.length;l++){var _=new L(s.id.substr(0,l)),u=new L(s.id.substr(l));i=new L(",",[new L("=",[_,a]),new L("=",[u,o])]),w.push(new q(r.goal.replace(i),r.substitution,r))}e.prepend(w)}else i=new L("=",[s,new L(a.id+o.id)]),e.prepend([new q(r.goal.replace(i),r.substitution,r)])}else e.throw_error(U.error.type("atom",s,t.indicator));else e.throw_error(U.error.type("atom",o,t.indicator));else e.throw_error(U.error.type("atom",a,t.indicator))},"sub_atom/5":function(r,t,n){var i,a=n.args[0],o=n.args[1],s=n.args[2],p=n.args[3],y=n.args[4];if(U.type.is_variable(a))r.throw_error(U.error.instantiation(n.indicator));else if(U.type.is_atom(a))if(U.type.is_variable(o)||U.type.is_integer(o))if(U.type.is_variable(s)||U.type.is_integer(s))if(U.type.is_variable(p)||U.type.is_integer(p))if(U.type.is_integer(o)&&o.value<0)r.throw_error(U.error.domain("not_less_than_zero",o,n.indicator));else if(U.type.is_integer(s)&&s.value<0)r.throw_error(U.error.domain("not_less_than_zero",s,n.indicator));else if(U.type.is_integer(p)&&p.value<0)r.throw_error(U.error.domain("not_less_than_zero",p,n.indicator));else if(U.type.is_variable(y)||U.type.is_atom(y)){var w=[],l=[],_=[];if(U.type.is_variable(o))for(i=0;i<=a.id.length;i++)w.push(i);else w.push(o.value);if(U.type.is_variable(s))for(i=0;i<=a.id.length;i++)l.push(i);else l.push(s.value);if(U.type.is_variable(p))for(i=0;i<=a.id.length;i++)_.push(i);else _.push(p.value);var u=[];for(var c in w)if(w.hasOwnProperty(c))for(var m in i=w[c],l)if(l.hasOwnProperty(m)){var d=l[m],f=a.id.length-i-d;if(-1!==e(_,f)&&i+d+f===a.id.length){var h=a.id.substr(i,d);if(a.id===a.id.substr(0,i)+h+a.id.substr(i+d,f)){var g=new L("=",[new L(h),y]),v=new L("=",[o,new C(i)]),T=new L("=",[s,new C(d)]),V=new L("=",[p,new C(f)]),b=new L(",",[new L(",",[new L(",",[v,T]),V]),g]);u.push(new q(t.goal.replace(b),t.substitution,t))}}}r.prepend(u)}else r.throw_error(U.error.type("atom",y,n.indicator));else r.throw_error(U.error.type("integer",p,n.indicator));else r.throw_error(U.error.type("integer",s,n.indicator));else r.throw_error(U.error.type("integer",o,n.indicator));else r.throw_error(U.error.type("atom",a,n.indicator))},"atom_chars/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(U.type.is_variable(n)&&U.type.is_variable(i))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(n)||U.type.is_atom(n))if(U.type.is_variable(n)){s=i;for(var a=U.type.is_variable(n),o="";"./2"===s.indicator;){if(U.type.is_character(s.args[0]))o+=s.args[0].id;else{if(U.type.is_variable(s.args[0])&&a)return void e.throw_error(U.error.instantiation(t.indicator));if(!U.type.is_variable(s.args[0]))return void e.throw_error(U.error.type("character",s.args[0],t.indicator))}s=s.args[1]}U.type.is_variable(s)&&a?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_empty_list(s)||U.type.is_variable(s)?e.prepend([new q(r.goal.replace(new L("=",[new L(o),n])),r.substitution,r)]):e.throw_error(U.error.type("list",i,t.indicator))}else{if(!U.type.is_variable(i))for(var s=i;U.type.is_term(s)&&"./2"===s.indicator;){if(!U.type.is_character(s.args[0])&&!U.type.is_variable(s.args[0]))return void e.throw_error(U.error.type("character",s.args[0],t.indicator));s=s.args[1]}for(var p=new L("[]"),w=y(n.id)-1;w>=0;w--)p=new L(".",[new L(n.id.charAt(w)),p]);e.prepend([new q(r.goal.replace(new L("=",[i,p])),r.substitution,r)])}else e.throw_error(U.error.type("atom",n,t.indicator))},"atom_codes/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(U.type.is_variable(n)&&U.type.is_variable(i))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(n)||U.type.is_atom(n))if(U.type.is_variable(n)){w=i;for(var a=U.type.is_variable(n),o="";"./2"===w.indicator;){if(U.type.is_character_code(w.args[0]))o+=p(w.args[0].value);else{if(U.type.is_variable(w.args[0])&&a)return void e.throw_error(U.error.instantiation(t.indicator));if(!U.type.is_variable(w.args[0]))return void e.throw_error(U.error.representation("character_code",t.indicator))}w=w.args[1]}U.type.is_variable(w)&&a?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_empty_list(w)||U.type.is_variable(w)?e.prepend([new q(r.goal.replace(new L("=",[new L(o),n])),r.substitution,r)]):e.throw_error(U.error.type("list",i,t.indicator))}else{if(!U.type.is_variable(i))for(var w=i;U.type.is_term(w)&&"./2"===w.indicator;){if(!U.type.is_character_code(w.args[0])&&!U.type.is_variable(w.args[0]))return void e.throw_error(U.error.type("integer",w.args[0],t.indicator));w=w.args[1]}for(var l=new L("[]"),_=y(n.id)-1;_>=0;_--)l=new L(".",[new C(s(n.id,_),!1),l]);e.prepend([new q(r.goal.replace(new L("=",[i,l])),r.substitution,r)])}else e.throw_error(U.error.type("atom",n,t.indicator))},"char_code/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(U.type.is_variable(n)&&U.type.is_variable(i))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(n)||U.type.is_character(n))if(U.type.is_variable(i)||U.type.is_integer(i))if(U.type.is_variable(i)||U.type.is_character_code(i))if(U.type.is_variable(i)){var a=new C(s(n.id,0),!1);e.prepend([new q(r.goal.replace(new L("=",[a,i])),r.substitution,r)])}else{var o=new L(p(i.value));e.prepend([new q(r.goal.replace(new L("=",[o,n])),r.substitution,r)])}else e.throw_error(U.error.representation("character_code",t.indicator));else e.throw_error(U.error.type("integer",i,t.indicator));else e.throw_error(U.error.type("character",n,t.indicator))},"number_chars/2":function(e,r,t){var n,i=t.args[0],a=t.args[1];if(U.type.is_variable(i)&&U.type.is_variable(a))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_number(i))if(U.type.is_variable(a)||U.type.is_list(a)){var o=U.type.is_variable(i);if(!U.type.is_variable(a)){var s=a,p=!0;for(n="";"./2"===s.indicator;){if(U.type.is_character(s.args[0]))n+=s.args[0].id;else if(U.type.is_variable(s.args[0]))p=!1;else if(!U.type.is_variable(s.args[0]))return void e.throw_error(U.error.type("character",s.args[0],t.indicator));s=s.args[1]}if(p=p&&U.type.is_empty_list(s),!U.type.is_empty_list(s)&&!U.type.is_variable(s))return void e.throw_error(U.error.type("list",a,t.indicator));if(!p&&o)return void e.throw_error(U.error.instantiation(t.indicator));if(p){if(U.type.is_variable(s)&&o)return void e.throw_error(U.error.instantiation(t.indicator));var y=e.parse(n),w=y.value;return void(!U.type.is_number(w)||y.tokens[y.tokens.length-1].space?e.throw_error(U.error.syntax_by_predicate("parseable_number",t.indicator)):e.prepend([new q(r.goal.replace(new L("=",[i,w])),r.substitution,r)]))}}if(!o){n=i.toString();for(var l=new L("[]"),_=n.length-1;_>=0;_--)l=new L(".",[new L(n.charAt(_)),l]);e.prepend([new q(r.goal.replace(new L("=",[a,l])),r.substitution,r)])}}else e.throw_error(U.error.type("list",a,t.indicator));else e.throw_error(U.error.type("number",i,t.indicator))},"number_codes/2":function(e,r,t){var n,i=t.args[0],a=t.args[1];if(U.type.is_variable(i)&&U.type.is_variable(a))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_number(i))if(U.type.is_variable(a)||U.type.is_list(a)){var o=U.type.is_variable(i);if(!U.type.is_variable(a)){var y=a,w=!0;for(n="";"./2"===y.indicator;){if(U.type.is_character_code(y.args[0]))n+=p(y.args[0].value);else if(U.type.is_variable(y.args[0]))w=!1;else if(!U.type.is_variable(y.args[0]))return void e.throw_error(U.error.representation("character_code",t.indicator));y=y.args[1]}if(w=w&&U.type.is_empty_list(y),!U.type.is_empty_list(y)&&!U.type.is_variable(y))return void e.throw_error(U.error.type("list",a,t.indicator));if(!w&&o)return void e.throw_error(U.error.instantiation(t.indicator));if(w){if(U.type.is_variable(y)&&o)return void e.throw_error(U.error.instantiation(t.indicator));var l=e.parse(n),_=l.value;return void(!U.type.is_number(_)||l.tokens[l.tokens.length-1].space?e.throw_error(U.error.syntax_by_predicate("parseable_number",t.indicator)):e.prepend([new q(r.goal.replace(new L("=",[i,_])),r.substitution,r)]))}}if(!o){n=i.toString();for(var u=new L("[]"),c=n.length-1;c>=0;c--)u=new L(".",[new C(s(n,c),!1),u]);e.prepend([new q(r.goal.replace(new L("=",[a,u])),r.substitution,r)])}}else e.throw_error(U.error.type("list",a,t.indicator));else e.throw_error(U.error.type("number",i,t.indicator))},"upcase_atom/2":function(e,r,t){var n=t.args[0],i=t.args[1];U.type.is_variable(n)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_atom(n)?U.type.is_variable(i)||U.type.is_atom(i)?e.prepend([new q(r.goal.replace(new L("=",[i,new L(n.id.toUpperCase(),[])])),r.substitution,r)]):e.throw_error(U.error.type("atom",i,t.indicator)):e.throw_error(U.error.type("atom",n,t.indicator))},"downcase_atom/2":function(e,r,t){var n=t.args[0],i=t.args[1];U.type.is_variable(n)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_atom(n)?U.type.is_variable(i)||U.type.is_atom(i)?e.prepend([new q(r.goal.replace(new L("=",[i,new L(n.id.toLowerCase(),[])])),r.substitution,r)]):e.throw_error(U.error.type("atom",i,t.indicator)):e.throw_error(U.error.type("atom",n,t.indicator))},"atomic_concat/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(U.type.is_variable(n)||U.type.is_variable(i))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_atomic(n))if(U.type.is_atomic(i))if(U.type.is_variable(a)||U.type.is_atom(a)){var o="";U.type.is_atom(n)?o+=n.id:o+=""+n.value,U.type.is_atom(i)?o+=i.id:o+=""+i.value;t=new L(o,[]);e.prepend([new q(r.goal.replace(new L("=",[t,a])),r.substitution,r)])}else e.throw_error(U.error.type("atom",a,t.indicator));else e.throw_error(U.error.type("atomic",i,t.indicator));else e.throw_error(U.error.type("atomic",n,t.indicator))},"atomic_list_concat/2":function(e,r,t){var n=t.args[0],i=t.args[1];e.prepend([new q(r.goal.replace(new L("atomic_list_concat",[n,new L("",[]),i])),r.substitution,r)])},"atomic_list_concat/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(U.type.is_variable(i)||U.type.is_variable(n)&&U.type.is_variable(a))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(n)||U.type.is_list(n))if(U.type.is_atom(i)||U.type.is_number(i))if(U.type.is_variable(a)||U.type.is_atom(a)){for(var o="",s=n;U.type.is_term(s)&&"./2"===s.indicator;){if(U.type.is_variable(s.args[0]))return void e.throw_error(U.error.instantiation(t.indicator));if(!U.type.is_atom(s.args[0])&&!U.type.is_number(s.args[0]))return void e.throw_error(U.error.type("atomic",s.args[0],t.indicator));""!==o&&(o+=i.id),U.type.is_atom(s.args[0])?o+=s.args[0].id:o+=""+s.args[0].value,s=s.args[1]}o=new L(o,[]),U.type.is_variable(s)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_term(s)&&"[]/0"===s.indicator?e.prepend([new q(r.goal.replace(new L("=",[o,a])),r.substitution,r)]):e.throw_error(U.error.type("list",n,t.indicator))}else e.throw_error(U.error.type("atom",a,t.indicator));else e.throw_error(U.error.type("atomic",i,t.indicator));else e.throw_error(U.error.type("list",n,t.indicator))},"@=</2":function(e,r,t){U.compare(t.args[0],t.args[1])<=0&&e.success(r)},"==/2":function(e,r,t){0===U.compare(t.args[0],t.args[1])&&e.success(r)},"\\==/2":function(e,r,t){0!==U.compare(t.args[0],t.args[1])&&e.success(r)},"@</2":function(e,r,t){U.compare(t.args[0],t.args[1])<0&&e.success(r)},"@>/2":function(e,r,t){U.compare(t.args[0],t.args[1])>0&&e.success(r)},"@>=/2":function(e,r,t){U.compare(t.args[0],t.args[1])>=0&&e.success(r)},"compare/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(U.type.is_variable(n)||U.type.is_atom(n))if(U.type.is_atom(n)&&-1===["<",">","="].indexOf(n.id))e.throw_error(U.error.domain("order",n,t.indicator));else{var o=U.compare(i,a);o=0===o?"=":-1===o?"<":">",e.prepend([new q(r.goal.replace(new L("=",[n,new L(o,[])])),r.substitution,r)])}else e.throw_error(U.error.type("atom",n,t.indicator))},"is/2":function(e,r,t){var n=t.args[1].interpret(e);U.type.is_number(n)?e.prepend([new q(r.goal.replace(new L("=",[t.args[0],n],t.indicator)),r.substitution,r)]):e.throw_error(n)},"between/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(U.type.is_variable(n)||U.type.is_variable(i))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_integer(n))if(U.type.is_integer(i))if(U.type.is_variable(a)||U.type.is_integer(a))if(U.type.is_variable(a)){if(n.value<=i.value){var o=[new q(r.goal.replace(new L("=",[a,n])),r.substitution,r)];o.push(new q(r.goal.replace(new L("between",[new C(n.value+1,!1),i,a])),r.substitution,r)),e.prepend(o)}}else n.value<=a.value&&i.value>=a.value&&e.success(r);else e.throw_error(U.error.type("integer",a,t.indicator));else e.throw_error(U.error.type("integer",i,t.indicator));else e.throw_error(U.error.type("integer",n,t.indicator))},"succ/2":function(e,r,t){var n=t.args[0],i=t.args[1];U.type.is_variable(n)&&U.type.is_variable(i)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_variable(n)||U.type.is_integer(n)?U.type.is_variable(i)||U.type.is_integer(i)?!U.type.is_variable(n)&&n.value<0?e.throw_error(U.error.domain("not_less_than_zero",n,t.indicator)):!U.type.is_variable(i)&&i.value<0?e.throw_error(U.error.domain("not_less_than_zero",i,t.indicator)):(U.type.is_variable(i)||i.value>0)&&(U.type.is_variable(n)?e.prepend([new q(r.goal.replace(new L("=",[n,new C(i.value-1,!1)])),r.substitution,r)]):e.prepend([new q(r.goal.replace(new L("=",[i,new C(n.value+1,!1)])),r.substitution,r)])):e.throw_error(U.error.type("integer",i,t.indicator)):e.throw_error(U.error.type("integer",n,t.indicator))},"=:=/2":function(e,r,t){var n=U.arithmetic_compare(e,t.args[0],t.args[1]);U.type.is_term(n)?e.throw_error(n):0===n&&e.success(r)},"=\\=/2":function(e,r,t){var n=U.arithmetic_compare(e,t.args[0],t.args[1]);U.type.is_term(n)?e.throw_error(n):0!==n&&e.success(r)},"</2":function(e,r,t){var n=U.arithmetic_compare(e,t.args[0],t.args[1]);U.type.is_term(n)?e.throw_error(n):n<0&&e.success(r)},"=</2":function(e,r,t){var n=U.arithmetic_compare(e,t.args[0],t.args[1]);U.type.is_term(n)?e.throw_error(n):n<=0&&e.success(r)},">/2":function(e,r,t){var n=U.arithmetic_compare(e,t.args[0],t.args[1]);U.type.is_term(n)?e.throw_error(n):n>0&&e.success(r)},">=/2":function(e,r,t){var n=U.arithmetic_compare(e,t.args[0],t.args[1]);U.type.is_term(n)?e.throw_error(n):n>=0&&e.success(r)},"var/1":function(e,r,t){U.type.is_variable(t.args[0])&&e.success(r)},"atom/1":function(e,r,t){U.type.is_atom(t.args[0])&&e.success(r)},"atomic/1":function(e,r,t){U.type.is_atomic(t.args[0])&&e.success(r)},"compound/1":function(e,r,t){U.type.is_compound(t.args[0])&&e.success(r)},"integer/1":function(e,r,t){U.type.is_integer(t.args[0])&&e.success(r)},"float/1":function(e,r,t){U.type.is_float(t.args[0])&&e.success(r)},"number/1":function(e,r,t){U.type.is_number(t.args[0])&&e.success(r)},"nonvar/1":function(e,r,t){U.type.is_variable(t.args[0])||e.success(r)},"ground/1":function(e,r,t){0===t.variables().length&&e.success(r)},"acyclic_term/1":function(e,r,t){for(var n=r.substitution.apply(r.substitution),i=t.args[0].variables(),a=0;a<i.length;a++)if(void 0!==r.substitution.links[i[a]]&&!r.substitution.links[i[a]].equals(n.links[i[a]]))return;e.success(r)},"callable/1":function(e,r,t){var n=t.args[0];U.type.is_term(n)&&e.success(r)},"is_list/1":function(e,r,t){for(var n=t.args[0];U.type.is_term(n)&&"./2"===n.indicator;)n=n.args[1];U.type.is_term(n)&&"[]/0"===n.indicator&&e.success(r)},"current_input/1":function(e,r,t){var n=t.args[0];U.type.is_variable(n)||U.type.is_stream(n)&&(e.get_stream_by_alias(n.alias)||e.get_stream_by_alias(n.id))||U.type.is_atom(n)&&e.get_stream_by_alias(n.id)?(U.type.is_atom(n)&&(n=e.get_stream_by_alias(n.id)),e.prepend([new q(r.goal.replace(new L("=",[n,e.get_current_input()])),r.substitution,r)])):e.throw_error(U.error.domain("stream",n,t.indicator))},"current_output/1":function(e,r,t){var n=t.args[0];U.type.is_variable(n)||U.type.is_stream(n)&&(e.get_stream_by_alias(n.alias)||e.get_stream_by_alias(n.id))||U.type.is_atom(n)&&e.get_stream_by_alias(n.id)?(U.type.is_atom(n)&&(n=e.get_stream_by_alias(n.id)),e.prepend([new q(r.goal.replace(new L("=",[n,e.get_current_output()])),r.substitution,r)])):e.throw_error(U.error.domain("stream",n,t.indicator))},"set_input/1":function(e,r,t){var n=t.args[0],i=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);U.type.is_variable(n)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_stream(n)||U.type.is_atom(n)?U.type.is_stream(i)&&(e.get_stream_by_alias(n.alias)||e.get_stream_by_alias(n.id))?!0===i.output?e.throw_error(U.error.permission("input","stream",n,t.indicator)):(e.set_current_input(i),e.success(r)):e.throw_error(U.error.existence("stream",n,t.indicator)):e.throw_error(U.error.domain("stream_or_alias",n,t.indicator))},"set_output/1":function(e,r,t){var n=t.args[0],i=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);U.type.is_variable(n)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_stream(n)||U.type.is_atom(n)?U.type.is_stream(i)&&(e.get_stream_by_alias(n.alias)||e.get_stream_by_alias(n.id))?!0===i.input?e.throw_error(U.error.permission("output","stream",n,t.indicator)):(e.set_current_output(i),e.success(r)):e.throw_error(U.error.existence("stream",n,t.indicator)):e.throw_error(U.error.domain("stream_or_alias",n,t.indicator))},"open/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];e.prepend([new q(r.goal.replace(new L("open",[n,i,a,new L("[]",[])])),r.substitution,r)])},"open/4":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2],o=t.args[3];if(U.type.is_variable(n)||U.type.is_variable(i)||U.type.is_variable(o))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_atom(i))if(U.type.is_list(o))if(U.type.is_variable(a))if(U.type.is_atom(n)||U.type.is_streamable(n))if(U.type.is_io_mode(i)){for(var s,p={},y=o;U.type.is_term(y)&&"./2"===y.indicator;){if(s=y.args[0],U.type.is_variable(s))return void e.throw_error(U.error.instantiation(t.indicator));if(!U.type.is_stream_option(s))return void e.throw_error(U.error.domain("stream_option",s,t.indicator));p[s.id]=s.args[0].id,y=y.args[1]}if("[]/0"!==y.indicator)return void(U.type.is_variable(y)?e.throw_error(U.error.instantiation(t.indicator)):e.throw_error(U.error.type("list",o,t.indicator)));var w,l=p.alias;if(l&&e.get_stream_by_alias(l))return void e.throw_error(U.error.permission("open","source_sink",new L("alias",[new L(l,[])]),t.indicator));if(p.type||(p.type="text"),!1===(w=U.type.is_atom(n)?e.file_system_open(n.id,p.type,i.id):n.stream(p.type,i.id)))return void e.throw_error(U.error.permission("open","source_sink",n,t.indicator));if(null===w)return void e.throw_error(U.error.existence("source_sink",n,t.indicator));var _=new Y(w,i.id,p.alias,p.type,"true"===p.reposition,p.eof_action);l?e.session.streams[l]=_:e.session.streams[_.id]=_,e.prepend([new q(r.goal.replace(new L("=",[a,_])),r.substitution,r)])}else e.throw_error(U.error.domain("io_mode",i,t.indicator));else e.throw_error(U.error.domain("source_sink",n,t.indicator));else e.throw_error(U.error.uninstantiation(a,t.indicator));else e.throw_error(U.error.type("list",o,t.indicator));else e.throw_error(U.error.type("atom",i,t.indicator))},"close/1":function(e,r,t){var n=t.args[0];e.prepend([new q(r.goal.replace(new L("close",[n,new L("[]",[])])),r.substitution,r)])},"close/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);if(U.type.is_variable(n)||U.type.is_variable(i))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_list(i))if(U.type.is_stream(n)||U.type.is_atom(n))if(U.type.is_stream(a)&&null!==a.stream){for(var o,s={},p=i;U.type.is_term(p)&&"./2"===p.indicator;){if(o=p.args[0],U.type.is_variable(o))return void e.throw_error(U.error.instantiation(t.indicator));if(!U.type.is_close_option(o))return void e.throw_error(U.error.domain("close_option",o,t.indicator));s[o.id]="true"===o.args[0].id,p=p.args[1]}if("[]/0"!==p.indicator)return void(U.type.is_variable(p)?e.throw_error(U.error.instantiation(t.indicator)):e.throw_error(U.error.type("list",i,t.indicator)));if(a===e.session.standard_input||a===e.session.standard_output||a===e.session.standard_error)return void e.success(r);a===e.session.current_input?e.session.current_input=e.session.standard_input:a===e.session.current_output&&(e.session.current_output=e.session.standard_output),null!==a.alias&&void 0!==a.alias?delete e.session.streams[a.alias]:delete e.session.streams[a.id],a.output&&a.stream.flush();var y=a.stream.close();a.stream=null,!0!==s.force&&!0!==y||e.success(r)}else e.throw_error(U.error.existence("stream",n,t.indicator));else e.throw_error(U.error.domain("stream_or_alias",n,t.indicator));else e.throw_error(U.error.type("list",i,t.indicator))},"flush_output/0":[new H(new L("flush_output",[]),new L(",",[new L("current_output",[new D("S")]),new L("flush_output",[new D("S")])]))],"flush_output/1":function(e,r,t){var n=t.args[0],i=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);U.type.is_variable(n)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_stream(n)||U.type.is_atom(n)?U.type.is_stream(i)&&null!==i.stream?!0===i.input?e.throw_error(U.error.permission("output","stream",n,t.indicator)):(i.stream.flush(),e.success(r)):e.throw_error(U.error.existence("stream",n,t.indicator)):e.throw_error(U.error.domain("stream_or_alias",n,t.indicator))},"stream_property/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);if(U.type.is_variable(n)||U.type.is_stream(n))if(U.type.is_variable(n)||U.type.is_stream(a)&&null!==a.stream)if(U.type.is_variable(i)||U.type.is_stream_property(i)){var o=[],s=[],p=U.type.is_variable(i);if(U.type.is_variable(n))for(var y in e.session.streams)o.push(e.session.streams[y]);else o.push(a);for(var w=0;w<o.length;w++){var l=[];(p||"file_name/1"===i.indicator)&&o[w].filename&&l.push(new L("file_name",[new L(o[w].file_name,[])])),(p||"mode/1"===i.indicator)&&l.push(new L("mode",[new L(o[w].mode,[])])),(p||"input/0"===i.indicator||"output/0"===i.indicator)&&l.push(new L(o[w].input?"input":"output",[])),(p||"alias/1"===i.indicator)&&o[w].alias&&l.push(new L("alias",[new L(o[w].alias,[])])),(p||"position/1"===i.indicator)&&l.push(new L("position",[new L("position",[new C(o[w].char_count,!1),new C(o[w].line_count,!1),new C(o[w].line_position,!1)])])),(p||"end_of_stream/1"===i.indicator)&&l.push(new L("end_of_stream",[new L("end_of_stream"===o[w].position||o[w].stream.eof&&o[w].stream.eof(o[w].position)?"at":"past_end_of_stream"===o[w].position?"past":"not",[])])),(p||"eof_action/1"===i.indicator)&&l.push(new L("eof_action",[new L(o[w].eof_action,[])])),(p||"reposition/1"===i.indicator)&&l.push(new L("reposition",[new L(o[w].reposition?"true":"false",[])])),(p||"type/1"===i.indicator)&&l.push(new L("type",[new L(o[w].type,[])]));for(var _=0;_<l.length;_++)s.push(new q(r.goal.replace(new L(",",[new L("=",[U.type.is_variable(n)?n:a,o[w]]),new L("=",[i,l[_]])])),r.substitution,r))}e.prepend(s)}else e.throw_error(U.error.domain("stream_property",i,t.indicator));else e.throw_error(U.error.existence("stream",n,t.indicator));else e.throw_error(U.error.domain("stream",n,t.indicator))},"stream_position_data/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(U.type.is_variable(i))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_term(i)&&"position/3"===i.indicator)if(U.type.is_variable(n)||U.type.is_atom(n))if(U.type.is_variable(a)||U.type.is_integer(a)){var o=["char_count","line_count","line_position"],s=[],p={char_count:0,line_count:1,line_position:2};if(U.type.is_variable(n))for(var y=0;y<o.length;y++)s.push(new q(r.goal.replace(new L(",",[new L("=",[new L(o[y]),n]),new L("=",[a,i.args[p[o[y]]]])])),r.substitution,r));else p.hasOwnProperty(n.id)&&s.push(new q(r.goal.replace(new L("=",[a,i.args[p[n.id]]])),r.substitution,r));e.prepend(s)}else e.throw_error(U.error.type("integer",a,t.indicator));else e.throw_error(U.error.type("atom",n,t.indicator));else e.throw_error(U.error.domain("stream_position",i,t.indicator))},"at_end_of_stream/0":[new H(new L("at_end_of_stream",[]),new U.type.Term(",",[new L("current_input",[new D("S")]),new L(",",[new L("stream_property",[new D("S"),new L("end_of_stream",[new D("E")])]),new L(",",[new L("!",[]),new L(";",[new L("=",[new D("E"),new L("at",[])]),new L("=",[new D("E"),new L("past",[])])])])])]))],"at_end_of_stream/1":function(e,r,t){var n=t.args[0],i=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_stream(i)&&null!==i.stream){var a=e.next_free_variable();e.prepend([new q(r.goal.replace(new L(",",[new L("stream_property",[i,new L("end_of_stream",[a])]),new L(",",[new L("!",[]),new L(";",[new L("=",[a,new L("at",[])]),new L("=",[a,new L("past",[])])])])])),r.substitution,r)])}else e.throw_error(U.error.existence("stream",n,t.indicator))},"set_stream_position/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);U.type.is_variable(n)||U.type.is_variable(i)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_stream(n)||U.type.is_atom(n)?U.type.is_stream(a)&&null!==a.stream?U.type.is_stream_position(i)?!1===a.reposition?e.throw_error(U.error.permission("reposition","stream",n,t.indicator)):("position/3"===i.indicator?(a.position=i.args[0].value,a.char_count=i.args[0].value,a.line_count=i.args[1].value,a.line_position=i.args[2].value):a.position=i.id,e.success(r)):e.throw_error(U.error.domain("stream_position",i,t.indicator)):e.throw_error(U.error.existence("stream",n,t.indicator)):e.throw_error(U.error.domain("stream_or_alias",n,t.indicator))},"get_char/1":[new H(new L("get_char",[new D("C")]),new L(",",[new L("current_input",[new D("S")]),new L("get_char",[new D("S"),new D("C")])]))],"get_char/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_in_character(i))if(U.type.is_stream(n)||U.type.is_atom(n))if(U.type.is_stream(a)&&null!==a.stream)if(a.output)e.throw_error(U.error.permission("input","stream",n,t.indicator));else if("binary"===a.type)e.throw_error(U.error.permission("input","binary_stream",n,t.indicator));else if("past_end_of_stream"===a.position&&"error"===a.eof_action)e.throw_error(U.error.permission("input","past_end_of_stream",n,t.indicator));else{var o;if("end_of_stream"===a.position)o="end_of_file",a.position="past_end_of_stream";else if("past_end_of_stream"===a.position)o="end_of_file",a.position="past_end_of_stream";else{if(null===(o=a.stream.get(1,a.position)))return void e.throw_error(U.error.representation("character",t.indicator));"end_of_stream"===o?(o="end_of_file",a.position="past_end_of_stream"):(a.position++,a.char_count++,a.line_position++,"\n"===o&&(a.line_count++,a.line_position=0))}e.prepend([new q(r.goal.replace(new L("=",[new L(o,[]),i])),r.substitution,r)])}else e.throw_error(U.error.existence("stream",n,t.indicator));else e.throw_error(U.error.domain("stream_or_alias",n,t.indicator));else e.throw_error(U.error.type("in_character",i,t.indicator))},"get_code/1":[new H(new L("get_code",[new D("C")]),new L(",",[new L("current_input",[new D("S")]),new L("get_code",[new D("S"),new D("C")])]))],"get_code/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_integer(i))if(U.type.is_integer(i)&&!U.type.is_in_character_code(i))e.throw_error(U.error.representation("in_character_code",t.indicator));else if(U.type.is_variable(n)||U.type.is_stream(n)||U.type.is_atom(n))if(U.type.is_stream(a)&&null!==a.stream)if(a.output)e.throw_error(U.error.permission("input","stream",n,t.indicator));else if("binary"===a.type)e.throw_error(U.error.permission("input","binary_stream",n,t.indicator));else if("past_end_of_stream"===a.position&&"error"===a.eof_action)e.throw_error(U.error.permission("input","past_end_of_stream",n,t.indicator));else{var o;if("end_of_stream"===a.position)o=-1,a.position="past_end_of_stream";else if("past_end_of_stream"===a.position)o=-1,a.position="past_end_of_stream";else{if(null===(o=a.stream.get(1,a.position)))return void e.throw_error(U.error.representation("character",t.indicator));"end_of_stream"===o?(o=-1,a.position="past_end_of_stream"):(o=s(o,0),a.position++,a.char_count++,a.line_position++,10===o&&(a.line_count++,a.line_position=0))}e.prepend([new q(r.goal.replace(new L("=",[new C(o,!1),i])),r.substitution,r)])}else e.throw_error(U.error.existence("stream",n,t.indicator));else e.throw_error(U.error.domain("stream_or_alias",n,t.indicator));else e.throw_error(U.error.type("integer",i,t.indicator))},"peek_char/1":[new H(new L("peek_char",[new D("C")]),new L(",",[new L("current_input",[new D("S")]),new L("peek_char",[new D("S"),new D("C")])]))],"peek_char/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_in_character(i))if(U.type.is_stream(n)||U.type.is_atom(n))if(U.type.is_stream(a)&&null!==a.stream)if(a.output)e.throw_error(U.error.permission("input","stream",n,t.indicator));else if("binary"===a.type)e.throw_error(U.error.permission("input","binary_stream",n,t.indicator));else if("past_end_of_stream"===a.position&&"error"===a.eof_action)e.throw_error(U.error.permission("input","past_end_of_stream",n,t.indicator));else{var o;if("end_of_stream"===a.position)o="end_of_file",a.position="past_end_of_stream";else if("past_end_of_stream"===a.position)o="end_of_file",a.position="past_end_of_stream";else{if(null===(o=a.stream.get(1,a.position)))return void e.throw_error(U.error.representation("character",t.indicator));"end_of_stream"===o&&(o="end_of_file")}e.prepend([new q(r.goal.replace(new L("=",[new L(o,[]),i])),r.substitution,r)])}else e.throw_error(U.error.existence("stream",n,t.indicator));else e.throw_error(U.error.domain("stream_or_alias",n,t.indicator));else e.throw_error(U.error.type("in_character",i,t.indicator))},"peek_code/1":[new H(new L("peek_code",[new D("C")]),new L(",",[new L("current_input",[new D("S")]),new L("peek_code",[new D("S"),new D("C")])]))],"peek_code/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_integer(i))if(U.type.is_integer(i)&&!U.type.is_in_character_code(i))e.throw_error(U.error.representation("in_character_code",t.indicator));else if(U.type.is_variable(n)||U.type.is_stream(n)||U.type.is_atom(n))if(U.type.is_stream(a)&&null!==a.stream)if(a.output)e.throw_error(U.error.permission("input","stream",n,t.indicator));else if("binary"===a.type)e.throw_error(U.error.permission("input","binary_stream",n,t.indicator));else if("past_end_of_stream"===a.position&&"error"===a.eof_action)e.throw_error(U.error.permission("input","past_end_of_stream",n,t.indicator));else{var o;if("end_of_stream"===a.position)o=-1,a.position="past_end_of_stream";else{if(null===(o=a.stream.get(1,a.position)))return void e.throw_error(U.error.representation("character",t.indicator));o="end_of_stream"===o?-1:s(o,0)}e.prepend([new q(r.goal.replace(new L("=",[new C(o,!1),i])),r.substitution,r)])}else e.throw_error(U.error.existence("stream",n,t.indicator));else e.throw_error(U.error.domain("stream_or_alias",n,t.indicator));else e.throw_error(U.error.type("integer",i,t.indicator))},"put_char/1":[new H(new L("put_char",[new D("C")]),new L(",",[new L("current_output",[new D("S")]),new L("put_char",[new D("S"),new D("C")])]))],"put_char/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);U.type.is_variable(n)||U.type.is_variable(i)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_character(i)?U.type.is_variable(n)||U.type.is_stream(n)||U.type.is_atom(n)?U.type.is_stream(a)&&null!==a.stream?a.input?e.throw_error(U.error.permission("output","stream",n,t.indicator)):"binary"===a.type?e.throw_error(U.error.permission("output","binary_stream",n,t.indicator)):a.stream.put(i.id,a.position)&&("number"==typeof a.position&&a.position++,a.char_count++,a.line_position++,"\n"===i.id&&(a.line_count++,a.line_position=0),e.success(r)):e.throw_error(U.error.existence("stream",n,t.indicator)):e.throw_error(U.error.domain("stream_or_alias",n,t.indicator)):e.throw_error(U.error.type("character",i,t.indicator))},"put_code/1":[new H(new L("put_code",[new D("C")]),new L(",",[new L("current_output",[new D("S")]),new L("put_code",[new D("S"),new D("C")])]))],"put_code/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);U.type.is_variable(n)||U.type.is_variable(i)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_integer(i)?U.type.is_character_code(i)?U.type.is_variable(n)||U.type.is_stream(n)||U.type.is_atom(n)?U.type.is_stream(a)&&null!==a.stream?a.input?e.throw_error(U.error.permission("output","stream",n,t.indicator)):"binary"===a.type?e.throw_error(U.error.permission("output","binary_stream",n,t.indicator)):a.stream.put(p(i.value),a.position)&&("number"==typeof a.position&&a.position++,a.char_count++,a.line_position++,10===i.value&&(a.line_count++,a.line_position=0),e.success(r)):e.throw_error(U.error.existence("stream",n,t.indicator)):e.throw_error(U.error.domain("stream_or_alias",n,t.indicator)):e.throw_error(U.error.representation("character_code",t.indicator)):e.throw_error(U.error.type("integer",i,t.indicator))},"nl/0":[new H(new L("nl"),new L(",",[new L("current_output",[new D("S")]),new L("put_char",[new D("S"),new L("\n")])]))],"nl/1":function(e,r,t){var n=t.args[0];e.prepend([new q(r.goal.replace(new L("put_char",[n,new L("\n",[])])),r.substitution,r)])},"get_byte/1":[new H(new L("get_byte",[new D("B")]),new L(",",[new L("current_input",[new D("S")]),new L("get_byte",[new D("S"),new D("B")])]))],"get_byte/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_in_byte(i))if(U.type.is_stream(n)||U.type.is_atom(n))if(U.type.is_stream(a)&&null!==a.stream)if(a.output)e.throw_error(U.error.permission("input","stream",n,t.indicator));else if("text"===a.type)e.throw_error(U.error.permission("input","text_stream",n,t.indicator));else if("past_end_of_stream"===a.position&&"error"===a.eof_action)e.throw_error(U.error.permission("input","past_end_of_stream",n,t.indicator));else{var o;if("end_of_stream"===a.position)o=-1,a.position="past_end_of_stream";else{if(null===(o=a.stream.get_byte(a.position)))return void e.throw_error(U.error.representation("byte",t.indicator));"end_of_stream"===o?(o=-1,a.position="past_end_of_stream"):(a.position++,a.char_count++,a.line_position++)}e.prepend([new q(r.goal.replace(new L("=",[new C(o,!1),i])),r.substitution,r)])}else e.throw_error(U.error.existence("stream",n,t.indicator));else e.throw_error(U.error.domain("stream_or_alias",n,t.indicator));else e.throw_error(U.error.type("in_byte",i,t.indicator))},"peek_byte/1":[new H(new L("peek_byte",[new D("B")]),new L(",",[new L("current_input",[new D("S")]),new L("peek_byte",[new D("S"),new D("B")])]))],"peek_byte/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(i)||U.type.is_in_byte(i))if(U.type.is_stream(n)||U.type.is_atom(n))if(U.type.is_stream(a)&&null!==a.stream)if(a.output)e.throw_error(U.error.permission("input","stream",n,t.indicator));else if("text"===a.type)e.throw_error(U.error.permission("input","text_stream",n,t.indicator));else if("past_end_of_stream"===a.position&&"error"===a.eof_action)e.throw_error(U.error.permission("input","past_end_of_stream",n,t.indicator));else{var o;if("end_of_stream"===a.position)o=-1,a.position="past_end_of_stream";else{if(null===(o=a.stream.get_byte(a.position)))return void e.throw_error(U.error.representation("byte",t.indicator));"end_of_stream"===o&&(o=-1)}e.prepend([new q(r.goal.replace(new L("=",[new C(o,!1),i])),r.substitution,r)])}else e.throw_error(U.error.existence("stream",n,t.indicator));else e.throw_error(U.error.domain("stream_or_alias",n,t.indicator));else e.throw_error(U.error.type("in_byte",i,t.indicator))},"put_byte/1":[new H(new L("put_byte",[new D("B")]),new L(",",[new L("current_output",[new D("S")]),new L("put_byte",[new D("S"),new D("B")])]))],"put_byte/2":function(e,r,t){var n=t.args[0],i=t.args[1],a=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);U.type.is_variable(n)||U.type.is_variable(i)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_byte(i)?U.type.is_variable(n)||U.type.is_stream(n)||U.type.is_atom(n)?U.type.is_stream(a)&&null!==a.stream?a.input?e.throw_error(U.error.permission("output","stream",n,t.indicator)):"text"===a.type?e.throw_error(U.error.permission("output","text_stream",n,t.indicator)):a.stream.put_byte(i.value,a.position)&&("number"==typeof a.position&&a.position++,a.char_count++,a.line_position++,e.success(r)):e.throw_error(U.error.existence("stream",n,t.indicator)):e.throw_error(U.error.domain("stream_or_alias",n,t.indicator)):e.throw_error(U.error.type("byte",i,t.indicator))},"read/1":[new H(new L("read",[new D("T")]),new L(",",[new L("current_input",[new D("S")]),new L("read_term",[new D("S"),new D("T"),new L("[]")])]))],"read/2":[new H(new L("read",[new D("S"),new D("T")]),new L("read_term",[new D("S"),new D("T"),new L("[]")]))],"read_term/2":[new H(new L("read_term",[new D("T"),new D("O")]),new L(",",[new L("current_input",[new D("S")]),new L("read_term",[new D("S"),new D("T"),new D("O")])]))],"read_term/3":function(e,r,t){var n=t.args[0],i=t.args[1],o=t.args[2],s=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);if(U.type.is_variable(n)||U.type.is_variable(o))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_list(o))if(U.type.is_stream(n)||U.type.is_atom(n))if(U.type.is_stream(s)&&null!==s.stream)if(s.output)e.throw_error(U.error.permission("input","stream",n,t.indicator));else if("binary"===s.type)e.throw_error(U.error.permission("input","binary_stream",n,t.indicator));else if("past_end_of_stream"===s.position&&"error"===s.eof_action)e.throw_error(U.error.permission("input","past_end_of_stream",n,t.indicator));else if("past_end_of_stream"===s.position&&"eof_code"===s.eof_action)m={value:new L("end_of_file",[]),type:u,len:-1};else{for(var p,y={},w=o;U.type.is_term(w)&&"./2"===w.indicator;){if(p=w.args[0],U.type.is_variable(p))return void e.throw_error(U.error.instantiation(t.indicator));if(!U.type.is_read_option(p))return void e.throw_error(U.error.domain("read_option",p,t.indicator));y[p.id]=p.args[0],w=w.args[1]}if("[]/0"!==w.indicator)return void(U.type.is_variable(w)?e.throw_error(U.error.instantiation(t.indicator)):e.throw_error(U.error.type("list",o,t.indicator)));for(var l,c,m,d="",f=[],h=null,g=!1;null===h||g||"atom"!==h.name||"."!==h.value||f.length>0&&m.type===_;){for(l=s.stream.get(1,s.position);null!==l&&"."!==l&&"end_of_stream"!==l&&"past_end_of_stream"!==l;)s.position++,d+=l,l=s.stream.get(1,s.position);if(null===l)return void e.throw_error(U.error.representation("character",t.indicator));if("end_of_stream"===l||"past_end_of_stream"===l){if(null===f||0===f.length){s.position="past_end_of_stream",m={value:new L("end_of_file",[]),type:u,len:-1};break}return m?void e.throw_error(U.error.syntax(h,"unexpected end of file",!1)):void e.throw_error(U.error.syntax(h,"token not found",!0))}if("."===l&&(s.position++,d+=l),(c=new v(e)).new_text(d),f=c.get_tokens(),num_token=null!==f&&f.length>1?f[f.length-2]:null,h=null!==f&&f.length>0?f[f.length-1]:null,null!==f){g=!1;for(var V=0;V<f.length&&!g;V++)g="lexical"===f[V].name;if(!g&&(m=T(e,f,0,e.__get_max_priority(),!1),num_token&&"number"===num_token.name&&!num_token.float&&!num_token.blank&&"."===h.value)){var b=s.stream.get(1,s.position);if(b>="0"&&b<="9"){s.position++,d+=b,h=null;continue}}}}if(h&&(h.line_position===h.len?s.line_position+=h.line_position:s.line_position=h.line_position,s.line_count+=h.line_count,s.char_count+=h.len),m.type===u&&(-1===m.len||m.len===f.length-1&&"."===h.value)){e.session.renamed_variables={};var x=new L("=",[i,m=m.value.rename(e)]);if(y.variables){var S=N(a(M(m.variables()),(function(e){return new D(e)})));x=new L(",",[x,new L("=",[y.variables,S])])}if(y.variable_names){S=M(m.variables());var j=[];for(V=0;V<S.length;V++){var k=S[V];for(var O in e.session.renamed_variables)if(e.session.renamed_variables.hasOwnProperty(O)&&e.session.renamed_variables[O]===k){j.push(new L("=",[new L(O,[]),new D(k)]));break}}j=N(j),x=new L(",",[x,new L("=",[y.variable_names,j])])}if(y.singletons){for(S=M(new H(m,null).singleton_variables(!0)),j=[],V=0;V<S.length;V++){k=S[V];for(var O in e.session.renamed_variables)if(e.session.renamed_variables.hasOwnProperty(O)&&e.session.renamed_variables[O]===k){j.push(new L("=",[new L(O,[]),new D(k)]));break}}j=N(j),x=new L(",",[x,new L("=",[y.singletons,j])])}e.prepend([new q(r.goal.replace(x),r.substitution,r)])}else m.type===u?e.throw_error(U.error.syntax(f[m.len],"unexpected token",!1)):e.throw_error(m.value)}else e.throw_error(U.error.existence("stream",n,t.indicator));else e.throw_error(U.error.domain("stream_or_alias",n,t.indicator));else e.throw_error(U.error.type("list",o,t.indicator))},"write/1":[new H(new L("write",[new D("T")]),new L(",",[new L("current_output",[new D("S")]),new L("write",[new D("S"),new D("T")])]))],"write/2":function(e,r,t){var n=t.args[0],i=t.args[1];e.prepend([new q(r.goal.replace(new L("write_term",[n,i,new L(".",[new L("quoted",[new L("false",[])]),new L(".",[new L("ignore_ops",[new L("false")]),new L(".",[new L("numbervars",[new L("true")]),new L("[]",[])])])])])),r.substitution,r)])},"writeq/1":[new H(new L("writeq",[new D("T")]),new L(",",[new L("current_output",[new D("S")]),new L("writeq",[new D("S"),new D("T")])]))],"writeq/2":function(e,r,t){var n=t.args[0],i=t.args[1];e.prepend([new q(r.goal.replace(new L("write_term",[n,i,new L(".",[new L("quoted",[new L("true",[])]),new L(".",[new L("ignore_ops",[new L("false")]),new L(".",[new L("numbervars",[new L("true")]),new L("[]",[])])])])])),r.substitution,r)])},"write_canonical/1":[new H(new L("write_canonical",[new D("T")]),new L(",",[new L("current_output",[new D("S")]),new L("write_canonical",[new D("S"),new D("T")])]))],"write_canonical/2":function(e,r,t){var n=t.args[0],i=t.args[1];e.prepend([new q(r.goal.replace(new L("write_term",[n,i,new L(".",[new L("quoted",[new L("true",[])]),new L(".",[new L("ignore_ops",[new L("true")]),new L(".",[new L("numbervars",[new L("false")]),new L("[]",[])])])])])),r.substitution,r)])},"write_term/2":[new H(new L("write_term",[new D("T"),new D("O")]),new L(",",[new L("current_output",[new D("S")]),new L("write_term",[new D("S"),new D("T"),new D("O")])]))],"write_term/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2],o=U.type.is_stream(n)?n:e.get_stream_by_alias(n.id);if(U.type.is_variable(n)||U.type.is_variable(a))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_list(a))if(U.type.is_stream(n)||U.type.is_atom(n))if(U.type.is_stream(o)&&null!==o.stream)if(o.input)e.throw_error(U.error.permission("output","stream",n,t.indicator));else if("binary"===o.type)e.throw_error(U.error.permission("output","binary_stream",n,t.indicator));else if("past_end_of_stream"===o.position&&"error"===o.eof_action)e.throw_error(U.error.permission("output","past_end_of_stream",n,t.indicator));else{for(var s,p={},y=a;U.type.is_term(y)&&"./2"===y.indicator;){if(s=y.args[0],U.type.is_variable(s))return void e.throw_error(U.error.instantiation(t.indicator));if(!U.type.is_write_option(s))return void e.throw_error(U.error.domain("write_option",s,t.indicator));"variable_names/1"===s.indicator?p[s.id]=s.args[0]:p[s.id]="true"===s.args[0].id,y=y.args[1]}if("[]/0"!==y.indicator)return void(U.type.is_variable(y)?e.throw_error(U.error.instantiation(t.indicator)):e.throw_error(U.error.type("list",a,t.indicator)));p.session=e.session;var w=i.toString(p);o.stream.put(w,o.position),"number"==typeof o.position&&(o.position+=w.length);var l=(w.match(/\n/g)||[]).length;o.line_count+=l,l>0?o.line_position=w.length-w.lastIndexOf("\n")-1:o.line_position+=w.length,o.char_count+=w.length,e.success(r)}else e.throw_error(U.error.existence("stream",n,t.indicator));else e.throw_error(U.error.domain("stream_or_alias",n,t.indicator));else e.throw_error(U.error.type("list",a,t.indicator))},"halt/0":function(e,r,t){"true/0"===e.get_flag("nodejs").indicator&&process.exit(),e.points=[]},"halt/1":function(e,r,t){var n=t.args[0];U.type.is_variable(n)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_integer(n)?("true/0"===e.get_flag("nodejs").indicator&&process.exit(n.value),e.points=[]):e.throw_error(U.error.type("integer",n,t.indicator))},"current_prolog_flag/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(U.type.is_variable(n)||U.type.is_atom(n))if(U.type.is_variable(n)||U.type.is_flag(n)){var a=[];for(var o in U.flag)if(U.flag.hasOwnProperty(o)){var s=new L(",",[new L("=",[new L(o),n]),new L("=",[e.get_flag(o),i])]);a.push(new q(r.goal.replace(s),r.substitution,r))}e.prepend(a)}else e.throw_error(U.error.domain("prolog_flag",n,t.indicator));else e.throw_error(U.error.type("atom",n,t.indicator))},"set_prolog_flag/2":function(e,r,t){var n=t.args[0],i=t.args[1];U.type.is_variable(n)||U.type.is_variable(i)?e.throw_error(U.error.instantiation(t.indicator)):U.type.is_atom(n)?U.type.is_flag(n)?U.type.is_modifiable_flag(n)?U.type.is_value_flag(n,i)?(e.session.flag[n.id]=i,e.success(r)):e.throw_error(U.error.domain("flag_value",new L("+",[n,i]),t.indicator)):e.throw_error(U.error.permission("modify","flag",n,t.indicator)):e.throw_error(U.error.domain("prolog_flag",n,t.indicator)):e.throw_error(U.error.type("atom",n,t.indicator))},"consult/1":function(e,r,t){var n=t.args[0],i="user";if(":/2"===n.indicator&&(i=n.args[0].id,n=n.args[1]),U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else{if(U.type.is_atom(n))return e.consult(n.id,{context_module:i,text:!1,html:!1,success:function(){e.success(r),e.again()},error:function(r){e.throw_error(r),e.again()}}),!0;e.throw_error(U.error.type("atom",n,t.indicator))}},"get_time/1":function(e,r,t){var n=t.args[0];if(U.type.is_variable(n)||U.type.is_number(n)){var i=new C(Date.now(),!0);e.prepend([new q(r.goal.replace(new L("=",[n,i])),r.substitution,r)])}else e.throw_error(U.error.type("number",n,t.indicator))},"time_property/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_variable(n)||U.type.is_number(n))if(U.type.is_variable(i)||U.type.is_time_property(i)){var a;a=U.type.is_variable(i)?["year","month","day","hours","minutes","seconds","milliseconds","weekday"]:[i.id];for(var o,s=new Date(n.value),p=[],y=0;y<a.length;y++){switch(a[y]){case"year":o=new L("year",[new C(s.getFullYear(),!1)]);break;case"month":o=new L("month",[new C(s.getMonth(),!1)]);break;case"day":o=new L("day",[new C(s.getDate(),!1)]);break;case"hours":o=new L("hours",[new C(s.getHours(),!1)]);break;case"minutes":o=new L("minutes",[new C(s.getMinutes(),!1)]);break;case"seconds":o=new L("seconds",[new C(s.getSeconds(),!1)]);break;case"milliseconds":o=new L("milliseconds",[new C(s.getMilliseconds(),!1)]);break;case"weekday":o=new L("weekday",[new C(s.getDay(),!1)])}p.push(new q(r.goal.replace(new L("=",[i,o])),r.substitution,r))}e.prepend(p)}else e.throw_error(U.error.domain("time_property",i,t.indicator));else e.throw_error(U.error.type("number",n,t.indicator))},"time_year/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_number(n))if(U.type.is_variable(i)||U.type.is_integer(i)){var a=new C(new Date(n.value).getFullYear(),!1);e.prepend([new q(r.goal.replace(new L("=",[i,a])),r.substitution,r)])}else e.throw_error(U.error.type("integer",i,t.indicator));else e.throw_error(U.error.type("number",n,t.indicator))},"time_month/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_number(n))if(U.type.is_variable(i)||U.type.is_integer(i)){var a=new C(new Date(n.value).getMonth(),!1);e.prepend([new q(r.goal.replace(new L("=",[i,a])),r.substitution,r)])}else e.throw_error(U.error.type("integer",i,t.indicator));else e.throw_error(U.error.type("number",n,t.indicator))},"phrase/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2],o="user";if(":/2"===n.indicator&&(o=n.args[0].id,n=n.args[1]),U.type.is_variable(n))e.throw_error(U.error.instantiation(t.indicator));else if(U.type.is_callable(n)){var s=O(n.clone(),i,e);s.value=new L(":",[new L(o),new L("call",[s.value])]),null!==s&&e.prepend([new q(r.goal.replace(new L(",",[s.value,new L("=",[s.variable,a])])),r.substitution,r)])}else e.throw_error(U.error.type("callable",n,t.indicator))},"phrase/2":function(e,r,t){var n=t.args[0],i=t.args[1];e.prepend([new q(r.goal.replace(new L("phrase",[n,i,new L("[]",[])])),r.substitution,r)])},"version/0":function(e,t,n){var i="Welcome to Tau Prolog version "+r.major+"."+r.minor+"."+r.patch+"\n";i+="Tau Prolog comes with ABSOLUTELY NO WARRANTY. This is free software.\n",i+="Please run ?- license. for legal details.\n",i+="For online help and background, visit http:/tau-prolog.org",e.prepend([new q(t.goal.replace(new L("write",[new L(i,[])])),t.substitution,t)])},"license/0":function(e,r,t){e.prepend([new q(r.goal.replace(new L("write",[new L('Tau Prolog. A Prolog interpreter in JavaScript.\nCopyright (C) 2017 - 2022 Jos Antonio Riaza Valverde\n\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nYou should have received a copy of the BSD 3-Clause License along with this program. If not, see https://opensource.org/licenses/BSD-3-Clause',[])])),r.substitution,r)])}},"all",{meta_predicates:{"$findall/4":new L("$findall",[new L("?"),new C(0,!1),new L("-"),new L("?")]),"$bagof/3":new L("$bagof",[new L("?"),new L("^"),new L("-")]),"$setof/3":new L("$setof",[new L("?"),new L("^"),new L("-")]),"$if/3":new L("$if",[new C(0,!1),new C(0,!1),new C(0,!1)]),";/2":new L(";",[new C(0,!1),new C(0,!1)]),"->/2":new L("->",[new C(0,!1),new C(0,!1)]),"*->/2":new L("*->",[new C(0,!1),new C(0,!1)]),"\\+/1":new L("\\+",[new C(0,!1)]),"abolish/1":new L("abolish",[new L(":")]),"asserta/1":new L("asserta",[new L(":")]),"assertz/1":new L("assertz",[new L(":")]),"bagof/3":new L("bagof",[new L("?"),new L("^"),new L("-")]),"call/1":new L("call",[new C(0,!1)]),"call/2":new L("call",[new C(1,!1),new L("?")]),"call/3":new L("call",[new C(2,!1),new L("?"),new L("?")]),"call/4":new L("call",[new C(3,!1),new L("?"),new L("?"),new L("?")]),"call/5":new L("call",[new C(4,!1),new L("?"),new L("?"),new L("?"),new L("?")]),"call/6":new L("call",[new C(5,!1),new L("?"),new L("?"),new L("?"),new L("?"),new L("?")]),"call/7":new L("call",[new C(6,!1),new L("?"),new L("?"),new L("?"),new L("?"),new L("?"),new L("?")]),"call/8":new L("call",[new C(6,!1),new L("?"),new L("?"),new L("?"),new L("?"),new L("?"),new L("?"),new L("?")]),"call_cleanup/2":new L("call_cleanup",[new C(0,!1),new C(0,!1)]),"catch/3":new L("catch",[new C(0,!1),new L("?"),new C(0,!1)]),"consult/1":new L("consult",[new L(":")]),"clause/2":new L("clause",[new L(":"),new L("?")]),"current_predicate/2":new L("current_predicate",[new L("?"),new L(":")]),"findall/3":new L("findall",[new L("?"),new C(0,!1),new L("-")]),"findall/4":new L("findall",[new L("?"),new C(0,!1),new L("-"),new L("?")]),"forall/2":new L("forall",[new C(0,!1),new C(0,!1)]),"listing/1":new L("listing",[new L(":")]),"once/1":new L("once",[new C(0,!1)]),"phrase/2":new L("phrase",[new L(":"),new L("?")]),"phrase/3":new L("phrase",[new L(":"),new L("?"),new L("?")]),"retract/1":new L("retract",[new L(":")]),"retractall/1":new L("retractall",[new L(":")]),"setup_call_cleanup/3":new L("setup_call_cleanup",[new C(0,!1),new C(0,!1),new C(0,!1)]),"setof/3":new L("setof",[new L("?"),new L("^"),new L("-")])}}),"undefined"!=typeof module?module.exports=U:window.pl=U}(),function(e){var r=function(){return{"append/2":[new e.type.Rule(new e.type.Term("append",[new e.type.Term("[]",[]),new e.type.Term("[]",[])]),null),new e.type.Rule(new e.type.Term("append",[new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")]),new e.type.Var("Zs")]),new e.type.Term(",",[new e.type.Term("append",[new e.type.Var("X"),new e.type.Var("Ys"),new e.type.Var("Zs")]),new e.type.Term("append",[new e.type.Var("Xs"),new e.type.Var("Ys")])]))],"append/3":[new e.type.Rule(new e.type.Term("append",[new e.type.Term("[]",[]),new e.type.Var("X"),new e.type.Var("X")]),null),new e.type.Rule(new e.type.Term("append",[new e.type.Term(".",[new e.type.Var("H"),new e.type.Var("T")]),new e.type.Var("X"),new e.type.Term(".",[new e.type.Var("H"),new e.type.Var("S")])]),new e.type.Term("append",[new e.type.Var("T"),new e.type.Var("X"),new e.type.Var("S")]))],"member/2":[new e.type.Rule(new e.type.Term("member",[new e.type.Var("X"),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("_")])]),null),new e.type.Rule(new e.type.Term("member",[new e.type.Var("X"),new e.type.Term(".",[new e.type.Var("_"),new e.type.Var("Xs")])]),new e.type.Term("member",[new e.type.Var("X"),new e.type.Var("Xs")]))],"permutation/2":[new e.type.Rule(new e.type.Term("permutation",[new e.type.Term("[]",[]),new e.type.Term("[]",[])]),null),new e.type.Rule(new e.type.Term("permutation",[new e.type.Term(".",[new e.type.Var("H"),new e.type.Var("T")]),new e.type.Var("S")]),new e.type.Term(",",[new e.type.Term("permutation",[new e.type.Var("T"),new e.type.Var("P")]),new e.type.Term(",",[new e.type.Term("append",[new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("P")]),new e.type.Term("append",[new e.type.Var("X"),new e.type.Term(".",[new e.type.Var("H"),new e.type.Var("Y")]),new e.type.Var("S")])])]))],"maplist/2":[new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("_"),new e.type.Term("[]",[])]),null),new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")])]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("P"),new e.type.Var("X")]),new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Var("Xs")])]))],"maplist/3":[new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[])]),null),new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")])]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("P"),new e.type.Var("A"),new e.type.Var("B")]),new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Var("As"),new e.type.Var("Bs")])]))],"maplist/4":[new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[])]),null),new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Term(".",[new e.type.Var("C"),new e.type.Var("Cs")])]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("P"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("C")]),new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("Cs")])]))],"maplist/5":[new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[])]),null),new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Term(".",[new e.type.Var("C"),new e.type.Var("Cs")]),new e.type.Term(".",[new e.type.Var("D"),new e.type.Var("Ds")])]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("P"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("C"),new e.type.Var("D")]),new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("Cs"),new e.type.Var("Ds")])]))],"maplist/6":[new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[])]),null),new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Term(".",[new e.type.Var("C"),new e.type.Var("Cs")]),new e.type.Term(".",[new e.type.Var("D"),new e.type.Var("Ds")]),new e.type.Term(".",[new e.type.Var("E"),new e.type.Var("Es")])]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("P"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("C"),new e.type.Var("D"),new e.type.Var("E")]),new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("Cs"),new e.type.Var("Ds"),new e.type.Var("Es")])]))],"maplist/7":[new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[])]),null),new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Term(".",[new e.type.Var("C"),new e.type.Var("Cs")]),new e.type.Term(".",[new e.type.Var("D"),new e.type.Var("Ds")]),new e.type.Term(".",[new e.type.Var("E"),new e.type.Var("Es")]),new e.type.Term(".",[new e.type.Var("F"),new e.type.Var("Fs")])]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("P"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("C"),new e.type.Var("D"),new e.type.Var("E"),new e.type.Var("F")]),new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("Cs"),new e.type.Var("Ds"),new e.type.Var("Es"),new e.type.Var("Fs")])]))],"maplist/8":[new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[])]),null),new e.type.Rule(new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Term(".",[new e.type.Var("C"),new e.type.Var("Cs")]),new e.type.Term(".",[new e.type.Var("D"),new e.type.Var("Ds")]),new e.type.Term(".",[new e.type.Var("E"),new e.type.Var("Es")]),new e.type.Term(".",[new e.type.Var("F"),new e.type.Var("Fs")]),new e.type.Term(".",[new e.type.Var("G"),new e.type.Var("Gs")])]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("P"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("C"),new e.type.Var("D"),new e.type.Var("E"),new e.type.Var("F"),new e.type.Var("G")]),new e.type.Term("maplist",[new e.type.Var("P"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("Cs"),new e.type.Var("Ds"),new e.type.Var("Es"),new e.type.Var("Fs"),new e.type.Var("Gs")])]))],"include/3":[new e.type.Rule(new e.type.Term("include",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[])]),null),new e.type.Rule(new e.type.Term("include",[new e.type.Var("P"),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")]),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("S")])]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("P"),new e.type.Var("X")]),new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("include",[new e.type.Var("P"),new e.type.Var("Xs"),new e.type.Var("S")])])])),new e.type.Rule(new e.type.Term("include",[new e.type.Var("P"),new e.type.Term(".",[new e.type.Var("_"),new e.type.Var("Xs")]),new e.type.Var("S")]),new e.type.Term("include",[new e.type.Var("P"),new e.type.Var("Xs"),new e.type.Var("S")]))],"exclude/3":[new e.type.Rule(new e.type.Term("exclude",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[])]),null),new e.type.Rule(new e.type.Term("exclude",[new e.type.Var("P"),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")]),new e.type.Var("S")]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("P"),new e.type.Var("X")]),new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("exclude",[new e.type.Var("P"),new e.type.Var("Xs"),new e.type.Var("S")])])])),new e.type.Rule(new e.type.Term("exclude",[new e.type.Var("P"),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")]),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("S")])]),new e.type.Term("exclude",[new e.type.Var("P"),new e.type.Var("Xs"),new e.type.Var("S")]))],"foldl/4":[new e.type.Rule(new e.type.Term("foldl",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Var("V0"),new e.type.Var("V0")]),null),new e.type.Rule(new e.type.Term("foldl",[new e.type.Var("G"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Var("V0"),new e.type.Var("V2")]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("G"),new e.type.Var("V0"),new e.type.Var("A"),new e.type.Var("V1")]),new e.type.Term("foldl",[new e.type.Var("G"),new e.type.Var("As"),new e.type.Var("V1"),new e.type.Var("V2")])]))],"foldl/5":[new e.type.Rule(new e.type.Term("foldl",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Var("V0"),new e.type.Var("V0")]),null),new e.type.Rule(new e.type.Term("foldl",[new e.type.Var("G"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Var("V0"),new e.type.Var("V2")]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("G"),new e.type.Var("V0"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("V1")]),new e.type.Term("foldl",[new e.type.Var("G"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("V1"),new e.type.Var("V2")])]))],"foldl/6":[new e.type.Rule(new e.type.Term("foldl",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Var("V0"),new e.type.Var("V0")]),null),new e.type.Rule(new e.type.Term("foldl",[new e.type.Var("G"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Term(".",[new e.type.Var("C"),new e.type.Var("Cs")]),new e.type.Var("V0"),new e.type.Var("V2")]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("G"),new e.type.Var("V0"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("C"),new e.type.Var("V1")]),new e.type.Term("foldl",[new e.type.Var("G"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("Cs"),new e.type.Var("V1"),new e.type.Var("V2")])]))],"foldl/7":[new e.type.Rule(new e.type.Term("foldl",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Var("V0"),new e.type.Var("V0")]),null),new e.type.Rule(new e.type.Term("foldl",[new e.type.Var("G"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Term(".",[new e.type.Var("C"),new e.type.Var("Cs")]),new e.type.Term(".",[new e.type.Var("D"),new e.type.Var("Ds")]),new e.type.Var("V0"),new e.type.Var("V2")]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("G"),new e.type.Var("V0"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("C"),new e.type.Var("D"),new e.type.Var("V1")]),new e.type.Term("foldl",[new e.type.Var("G"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("Cs"),new e.type.Var("Ds"),new e.type.Var("V1"),new e.type.Var("V2")])]))],"foldl/8":[new e.type.Rule(new e.type.Term("foldl",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Var("V0"),new e.type.Var("V0")]),null),new e.type.Rule(new e.type.Term("foldl",[new e.type.Var("G"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Term(".",[new e.type.Var("C"),new e.type.Var("Cs")]),new e.type.Term(".",[new e.type.Var("D"),new e.type.Var("Ds")]),new e.type.Term(".",[new e.type.Var("E"),new e.type.Var("Es")]),new e.type.Var("V0"),new e.type.Var("V2")]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("G"),new e.type.Var("V0"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("C"),new e.type.Var("D"),new e.type.Var("E"),new e.type.Var("V1")]),new e.type.Term("foldl",[new e.type.Var("G"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("Cs"),new e.type.Var("Ds"),new e.type.Var("Es"),new e.type.Var("V1"),new e.type.Var("V2")])]))],"foldr/4":[new e.type.Rule(new e.type.Term("foldr",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Var("V0"),new e.type.Var("V0")]),null),new e.type.Rule(new e.type.Term("foldr",[new e.type.Var("G"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Var("V0"),new e.type.Var("V2")]),new e.type.Term(",",[new e.type.Term("foldr",[new e.type.Var("G"),new e.type.Var("As"),new e.type.Var("V0"),new e.type.Var("V1")]),new e.type.Term("call",[new e.type.Var("G"),new e.type.Var("A"),new e.type.Var("V1"),new e.type.Var("V2")])]))],"foldr/5":[new e.type.Rule(new e.type.Term("foldr",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Var("V0"),new e.type.Var("V0")]),null),new e.type.Rule(new e.type.Term("foldr",[new e.type.Var("G"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Var("V0"),new e.type.Var("V2")]),new e.type.Term(",",[new e.type.Term("foldr",[new e.type.Var("G"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("V0"),new e.type.Var("V1")]),new e.type.Term("call",[new e.type.Var("G"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("V1"),new e.type.Var("V2")])]))],"foldr/6":[new e.type.Rule(new e.type.Term("foldr",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Var("V0"),new e.type.Var("V0")]),null),new e.type.Rule(new e.type.Term("foldr",[new e.type.Var("G"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Term(".",[new e.type.Var("C"),new e.type.Var("Cs")]),new e.type.Var("V0"),new e.type.Var("V2")]),new e.type.Term(",",[new e.type.Term("foldr",[new e.type.Var("G"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("Cs"),new e.type.Var("V0"),new e.type.Var("V1")]),new e.type.Term("call",[new e.type.Var("G"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("C"),new e.type.Var("V1"),new e.type.Var("V2")])]))],"foldr/7":[new e.type.Rule(new e.type.Term("foldr",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Var("V0"),new e.type.Var("V0")]),null),new e.type.Rule(new e.type.Term("foldr",[new e.type.Var("G"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Term(".",[new e.type.Var("C"),new e.type.Var("Cs")]),new e.type.Term(".",[new e.type.Var("D"),new e.type.Var("Ds")]),new e.type.Var("V0"),new e.type.Var("V2")]),new e.type.Term(",",[new e.type.Term("foldr",[new e.type.Var("G"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("Cs"),new e.type.Var("Ds"),new e.type.Var("V0"),new e.type.Var("V1")]),new e.type.Term("call",[new e.type.Var("G"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("C"),new e.type.Var("D"),new e.type.Var("V1"),new e.type.Var("V2")])]))],"foldr/8":[new e.type.Rule(new e.type.Term("foldr",[new e.type.Var("_"),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Term("[]",[]),new e.type.Var("V0"),new e.type.Var("V0")]),null),new e.type.Rule(new e.type.Term("foldr",[new e.type.Var("G"),new e.type.Term(".",[new e.type.Var("A"),new e.type.Var("As")]),new e.type.Term(".",[new e.type.Var("B"),new e.type.Var("Bs")]),new e.type.Term(".",[new e.type.Var("C"),new e.type.Var("Cs")]),new e.type.Term(".",[new e.type.Var("D"),new e.type.Var("Ds")]),new e.type.Term(".",[new e.type.Var("E"),new e.type.Var("Es")]),new e.type.Var("V0"),new e.type.Var("V2")]),new e.type.Term(",",[new e.type.Term("foldr",[new e.type.Var("G"),new e.type.Var("As"),new e.type.Var("Bs"),new e.type.Var("Cs"),new e.type.Var("Ds"),new e.type.Var("Es"),new e.type.Var("V0"),new e.type.Var("V1")]),new e.type.Term("call",[new e.type.Var("G"),new e.type.Var("A"),new e.type.Var("B"),new e.type.Var("C"),new e.type.Var("D"),new e.type.Var("E"),new e.type.Var("V1"),new e.type.Var("V2")])]))],"select/3":[new e.type.Rule(new e.type.Term("select",[new e.type.Var("E"),new e.type.Term(".",[new e.type.Var("E"),new e.type.Var("Xs")]),new e.type.Var("Xs")]),null),new e.type.Rule(new e.type.Term("select",[new e.type.Var("E"),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")]),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Ys")])]),new e.type.Term("select",[new e.type.Var("E"),new e.type.Var("Xs"),new e.type.Var("Ys")]))],"sum_list/2":[new e.type.Rule(new e.type.Term("sum_list",[new e.type.Term("[]",[]),new e.type.Num(0,!1)]),null),new e.type.Rule(new e.type.Term("sum_list",[new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")]),new e.type.Var("S")]),new e.type.Term(",",[new e.type.Term("sum_list",[new e.type.Var("Xs"),new e.type.Var("Y")]),new e.type.Term("is",[new e.type.Var("S"),new e.type.Term("+",[new e.type.Var("X"),new e.type.Var("Y")])])]))],"max_list/2":[new e.type.Rule(new e.type.Term("max_list",[new e.type.Term(".",[new e.type.Var("X"),new e.type.Term("[]",[])]),new e.type.Var("X")]),null),new e.type.Rule(new e.type.Term("max_list",[new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")]),new e.type.Var("S")]),new e.type.Term(",",[new e.type.Term("max_list",[new e.type.Var("Xs"),new e.type.Var("Y")]),new e.type.Term(";",[new e.type.Term(",",[new e.type.Term(">=",[new e.type.Var("X"),new e.type.Var("Y")]),new e.type.Term(",",[new e.type.Term("=",[new e.type.Var("S"),new e.type.Var("X")]),new e.type.Term("!",[])])]),new e.type.Term("=",[new e.type.Var("S"),new e.type.Var("Y")])])]))],"min_list/2":[new e.type.Rule(new e.type.Term("min_list",[new e.type.Term(".",[new e.type.Var("X"),new e.type.Term("[]",[])]),new e.type.Var("X")]),null),new e.type.Rule(new e.type.Term("min_list",[new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")]),new e.type.Var("S")]),new e.type.Term(",",[new e.type.Term("min_list",[new e.type.Var("Xs"),new e.type.Var("Y")]),new e.type.Term(";",[new e.type.Term(",",[new e.type.Term("=<",[new e.type.Var("X"),new e.type.Var("Y")]),new e.type.Term(",",[new e.type.Term("=",[new e.type.Var("S"),new e.type.Var("X")]),new e.type.Term("!",[])])]),new e.type.Term("=",[new e.type.Var("S"),new e.type.Var("Y")])])]))],"prod_list/2":[new e.type.Rule(new e.type.Term("prod_list",[new e.type.Term("[]",[]),new e.type.Num(1,!1)]),null),new e.type.Rule(new e.type.Term("prod_list",[new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")]),new e.type.Var("S")]),new e.type.Term(",",[new e.type.Term("prod_list",[new e.type.Var("Xs"),new e.type.Var("Y")]),new e.type.Term("is",[new e.type.Var("S"),new e.type.Term("*",[new e.type.Var("X"),new e.type.Var("Y")])])]))],"last/2":[new e.type.Rule(new e.type.Term("last",[new e.type.Term(".",[new e.type.Var("X"),new e.type.Term("[]",[])]),new e.type.Var("X")]),null),new e.type.Rule(new e.type.Term("last",[new e.type.Term(".",[new e.type.Var("_"),new e.type.Var("Xs")]),new e.type.Var("X")]),new e.type.Term("last",[new e.type.Var("Xs"),new e.type.Var("X")]))],"prefix/2":[new e.type.Rule(new e.type.Term("prefix",[new e.type.Var("Part"),new e.type.Var("Whole")]),new e.type.Term("append",[new e.type.Var("Part"),new e.type.Var("_"),new e.type.Var("Whole")]))],"nth0/3":[new e.type.Rule(new e.type.Term("nth0",[new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z")]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("var",[new e.type.Var("X")]),new e.type.Term("nth",[new e.type.Num(0,!1),new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z"),new e.type.Var("_")])]),new e.type.Term(",",[new e.type.Term(">=",[new e.type.Var("X"),new e.type.Num(0,!1)]),new e.type.Term(",",[new e.type.Term("nth",[new e.type.Num(0,!1),new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z"),new e.type.Var("_")]),new e.type.Term("!",[])])])]))],"nth1/3":[new e.type.Rule(new e.type.Term("nth1",[new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z")]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("var",[new e.type.Var("X")]),new e.type.Term("nth",[new e.type.Num(1,!1),new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z"),new e.type.Var("_")])]),new e.type.Term(",",[new e.type.Term(">",[new e.type.Var("X"),new e.type.Num(0,!1)]),new e.type.Term(",",[new e.type.Term("nth",[new e.type.Num(1,!1),new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z"),new e.type.Var("_")]),new e.type.Term("!",[])])])]))],"nth0/4":[new e.type.Rule(new e.type.Term("nth0",[new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z"),new e.type.Var("W")]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("var",[new e.type.Var("X")]),new e.type.Term("nth",[new e.type.Num(0,!1),new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z"),new e.type.Var("W")])]),new e.type.Term(",",[new e.type.Term(">=",[new e.type.Var("X"),new e.type.Num(0,!1)]),new e.type.Term(",",[new e.type.Term("nth",[new e.type.Num(0,!1),new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z"),new e.type.Var("W")]),new e.type.Term("!",[])])])]))],"nth1/4":[new e.type.Rule(new e.type.Term("nth1",[new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z"),new e.type.Var("W")]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("var",[new e.type.Var("X")]),new e.type.Term("nth",[new e.type.Num(1,!1),new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z"),new e.type.Var("W")])]),new e.type.Term(",",[new e.type.Term(">",[new e.type.Var("X"),new e.type.Num(0,!1)]),new e.type.Term(",",[new e.type.Term("nth",[new e.type.Num(1,!1),new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z"),new e.type.Var("W")]),new e.type.Term("!",[])])])]))],"nth/5":[new e.type.Rule(new e.type.Term("nth",[new e.type.Var("N"),new e.type.Var("N"),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")]),new e.type.Var("X"),new e.type.Var("Xs")]),null),new e.type.Rule(new e.type.Term("nth",[new e.type.Var("N"),new e.type.Var("O"),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Xs")]),new e.type.Var("Y"),new e.type.Term(".",[new e.type.Var("X"),new e.type.Var("Ys")])]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("M"),new e.type.Term("+",[new e.type.Var("N"),new e.type.Num(1,!1)])]),new e.type.Term("nth",[new e.type.Var("M"),new e.type.Var("O"),new e.type.Var("Xs"),new e.type.Var("Y"),new e.type.Var("Ys")])]))],"length/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(a)||e.type.is_integer(a))if(e.type.is_integer(a)&&a.value<0)r.throw_error(e.error.domain("not_less_than_zero",a,n.indicator));else{if(!e.type.is_variable(a)){for(var o=0,s=i;e.type.is_term(s)&&"./2"==s.indicator;)o++,s=s.args[1];if(!e.type.is_variable(s)&&!e.type.is_empty_list(s))return;if(e.type.is_integer(a)&&o>a)return}var p=new e.type.Term("length",[i,new e.type.Num(0,!1),a]);e.type.is_integer(a)&&(p=new e.type.Term(",",[p,new e.type.Term("!",[])])),r.prepend([new e.type.State(t.goal.replace(p),t.substitution,t)])}else r.throw_error(e.error.type("integer",a,n.indicator))},"length/3":[new e.type.Rule(new e.type.Term("length",[new e.type.Term("[]",[]),new e.type.Var("N"),new e.type.Var("N")]),null),new e.type.Rule(new e.type.Term("length",[new e.type.Term(".",[new e.type.Var("_"),new e.type.Var("X")]),new e.type.Var("A"),new e.type.Var("N")]),new e.type.Term(",",[new e.type.Term("succ",[new e.type.Var("A"),new e.type.Var("B")]),new e.type.Term("length",[new e.type.Var("X"),new e.type.Var("B"),new e.type.Var("N")])]))],"replicate/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_integer(a))if(a.value<0)r.throw_error(e.error.domain("not_less_than_zero",a,n.indicator));else if(e.type.is_variable(o)||e.type.is_list(o)){for(var s=new e.type.Term("[]"),p=0;p<a.value;p++)s=new e.type.Term(".",[i,s]);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[s,o])),t.substitution,t)])}else r.throw_error(e.error.type("list",o,n.indicator));else r.throw_error(e.error.type("integer",a,n.indicator))},"msort/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_variable(a)||e.type.is_fully_list(a)){for(var o=[],s=i;"./2"===s.indicator;)o.push(s.args[0]),s=s.args[1];if(e.type.is_variable(s))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_empty_list(s)){for(var p=o.sort(e.compare),y=new e.type.Term("[]"),w=p.length-1;w>=0;w--)y=new e.type.Term(".",[p[w],y]);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[y,a])),t.substitution,t)])}else r.throw_error(e.error.type("list",i,n.indicator))}else r.throw_error(e.error.type("list",a,n.indicator))},"take/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(a)||e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_list(a))if(e.type.is_integer(i))if(e.type.is_variable(o)||e.type.is_list(o)){for(var s=i.value,p=[],y=a;s>0&&"./2"===y.indicator;)p.push(y.args[0]),y=y.args[1],s--;if(0===s){var w=new e.type.Term("[]");for(s=p.length-1;s>=0;s--)w=new e.type.Term(".",[p[s],w]);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[w,o])),t.substitution,t)])}}else r.throw_error(e.error.type("list",o,n.indicator));else r.throw_error(e.error.type("integer",i,n.indicator));else r.throw_error(e.error.type("list",a,n.indicator))},"drop/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(a)||e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_list(a))if(e.type.is_integer(i))if(e.type.is_variable(o)||e.type.is_list(o)){for(var s=i.value,p=[],y=a;s>0&&"./2"===y.indicator;)p.push(y.args[0]),y=y.args[1],s--;0===s&&r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[y,o])),t.substitution,t)])}else r.throw_error(e.error.type("list",o,n.indicator));else r.throw_error(e.error.type("integer",i,n.indicator));else r.throw_error(e.error.type("list",a,n.indicator))},"reverse/2":function(r,t,n){var i=n.args[0],a=n.args[1],o=e.type.is_instantiated_list(i),s=e.type.is_instantiated_list(a);if(e.type.is_variable(i)&&e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_variable(i)||e.type.is_fully_list(i))if(e.type.is_variable(a)||e.type.is_fully_list(a))if(o||s){for(var p=o?i:a,y=new e.type.Term("[]",[]);"./2"===p.indicator;)y=new e.type.Term(".",[p.args[0],y]),p=p.args[1];r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[y,o?a:i])),t.substitution,t)])}else r.throw_error(e.error.instantiation(n.indicator));else r.throw_error(e.error.type("list",a,n.indicator));else r.throw_error(e.error.type("list",i,n.indicator))},"list_to_set/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else{for(var o=i,s=[];"./2"===o.indicator;)s.push(o.args[0]),o=o.args[1];if(e.type.is_variable(o))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_term(o)&&"[]/0"===o.indicator){for(var p,y=[],w=new e.type.Term("[]",[]),l=0;l<s.length;l++){p=!1;for(var _=0;_<y.length&&!p;_++)p=0===e.compare(s[l],y[_]);p||y.push(s[l])}for(l=y.length-1;l>=0;l--)w=new e.type.Term(".",[y[l],w]);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[a,w])),t.substitution,t)])}else r.throw_error(e.error.type("list",i,n.indicator))}}}},t=["append/2","append/3","member/2","permutation/2","maplist/2","maplist/3","maplist/4","maplist/5","maplist/6","maplist/7","maplist/8","include/3","exclude/3","foldl/4","foldl/5","foldl/6","foldl/7","foldl/8","foldr/4","foldr/5","foldr/6","foldr/7","foldr/8","sum_list/2","max_list/2","min_list/2","prod_list/2","last/2","prefix/2","nth0/3","nth1/3","nth0/4","nth1/4","length/2","replicate/3","select/3","msort/2","take/3","drop/3","reverse/2","list_to_set/2"],n=function(){return{meta_predicates:{"exclude/3":new e.type.Term("exclude",[new e.type.Num(1,!1),new e.type.Term("+"),new e.type.Term("-")]),"foldl/4":new e.type.Term("foldl",[new e.type.Num(3,!1),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("-")]),"foldl/5":new e.type.Term("foldl",[new e.type.Num(4,!1),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("-")]),"foldl/6":new e.type.Term("foldl",[new e.type.Num(5,!1),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("-")]),"foldl/7":new e.type.Term("foldl",[new e.type.Num(6,!1),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("-")]),"foldr/4":new e.type.Term("foldr",[new e.type.Num(3,!1),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("-")]),"foldr/5":new e.type.Term("foldr",[new e.type.Num(4,!1),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("-")]),"foldr/6":new e.type.Term("foldr",[new e.type.Num(5,!1),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("-")]),"foldr/7":new e.type.Term("foldr",[new e.type.Num(6,!1),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("-")]),"include/3":new e.type.Term("include",[new e.type.Num(1,!1),new e.type.Term("+"),new e.type.Term("-")]),"maplist/2":new e.type.Term("maplist",[new e.type.Num(1,!1),new e.type.Term("?")]),"maplist/3":new e.type.Term("maplist",[new e.type.Num(2,!1),new e.type.Term("?"),new e.type.Term("?")]),"maplist/4":new e.type.Term("maplist",[new e.type.Num(3,!1),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?")]),"maplist/5":new e.type.Term("maplist",[new e.type.Num(4,!1),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?")]),"maplist/6":new e.type.Term("maplist",[new e.type.Num(5,!1),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?")]),"maplist/7":new e.type.Term("maplist",[new e.type.Num(6,!1),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?")]),"maplist/8":new e.type.Term("maplist",[new e.type.Num(7,!1),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?"),new e.type.Term("?")])}}};"undefined"!=typeof module?module.exports=function(i){new(e=i).type.Module("lists",r(),t,n())}:new e.type.Module("lists",r(),t,n())}(pl),function(e){var r=function(){return{"get_seed/1":function(r,t,n){var i=n.args[0];if(e.type.is_variable(i)||e.type.is_integer(i)){var a=r.get_random_generator().get_seed();r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[new e.type.Num(a,!1),i])),t.substitution,t)])}else r.throw_error(e.error.type("integer",i,n.indicator))},"set_seed/1":function(r,t,n){var i=n.args[0];e.type.is_variable(i)?r.throw_error(e.error.instantiation(n.indicator)):e.type.is_integer(i)?(r.get_random_generator().set_seed(i.value),r.success(t)):r.throw_error(e.error.type("integer",i,n.indicator))},"maybe/0":function(e,r,t){e.get_random_generator().next()<.5&&e.success(r)},"maybe/1":function(e,r,t){var n=t.args[0];e.get_random_generator().next()<n.value&&e.success(r)},"random/1":function(r,t,n){var i=n.args[0];if(e.type.is_variable(i)||e.type.is_number(i)){var a=r.get_random_generator().next();r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[i,new e.type.Num(a,!0)])),t.substitution,t)])}else r.throw_error(e.error.type("number",i,n.indicator))},"random/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(i)||e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_number(i))if(e.type.is_number(a))if(e.type.is_variable(o)||e.type.is_number(o)){if(i.value<a.value){var s=i.is_float||a.is_float,p=i.value+r.get_random_generator().next()*(a.value-i.value);s||(p=Math.floor(p)),r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[o,new e.type.Num(p,s)])),t.substitution,t)])}}else r.throw_error(e.error.type("number",o,n.indicator));else r.throw_error(e.error.type("number",a,n.indicator));else r.throw_error(e.error.type("number",i,n.indicator))},"random_between/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(i)||e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_integer(i))if(e.type.is_integer(a))if(e.type.is_variable(o)||e.type.is_integer(o)){if(i.value<a.value){var s=Math.floor(i.value+r.get_random_generator().next()*(a.value-i.value+1));r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[o,new e.type.Num(s,!1)])),t.substitution,t)])}}else r.throw_error(e.error.type("integer",o,n.indicator));else r.throw_error(e.error.type("integer",a,n.indicator));else r.throw_error(e.error.type("integer",i,n.indicator))},"random_member/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else{for(var o=[],s=a;"./2"===s.indicator;)o.push(s.args[0]),s=s.args[1];if(o.length>0){var p=Math.floor(r.get_random_generator().next()*o.length);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[i,o[p]])),t.substitution,t)])}}},"random_permutation/2":function(r,t,n){var i,a=n.args[0],o=n.args[1],s=e.type.is_instantiated_list(a),p=e.type.is_instantiated_list(o);if(e.type.is_variable(a)&&e.type.is_variable(o)||!s&&!p)r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_variable(a)||e.type.is_fully_list(a))if(e.type.is_variable(o)||e.type.is_fully_list(o)){for(var y=s?a:o,w=[];"./2"===y.indicator;)w.push(y.args[0]),y=y.args[1];for(i=0;i<w.length;i++){var l=Math.floor(r.get_random_generator().next()*w.length),_=w[i];w[i]=w[l],w[l]=_}var u=new e.type.Term("[]",[]);for(i=w.length-1;i>=0;i--)u=new e.type.Term(".",[w[i],u]);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[u,s?o:a])),t.substitution,t)])}else r.throw_error(e.error.type("list",o,n.indicator));else r.throw_error(e.error.type("list",a,n.indicator))}}},t=["get_seed/1","set_seed/1","maybe/0","maybe/1","random/1","random/3","random_between/3","random_member/2","random_permutation/2"],n=function(e){this.set_seed(e)};n.prototype.next=function(){var e=this.get_seed()+1831565813;return this.set_seed(e),e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296},n.prototype.set_seed=function(e){this.seed=e},n.prototype.get_seed=function(){return this.seed};var i=function(e){e.type.Session.prototype.get_random_generator=function(){return this.random_generator||(this.random_generator=new n(Date.now())),this.random_generator},e.type.Thread.prototype.get_random_generator=function(){return this.session.get_random_generator()}};"undefined"!=typeof module?module.exports=function(n){e=n,i(n),new e.type.Module("random",r(),t)}:(i(e),new e.type.Module("random",r(),t))}(pl),function(e){var r=function(){return{"time/1":[new e.type.Rule(new e.type.Term("time",[new e.type.Var("Goal")]),new e.type.Term(",",[new e.type.Term("get_time",[new e.type.Var("T0")]),new e.type.Term(",",[new e.type.Term("call",[new e.type.Var("Goal")]),new e.type.Term(",",[new e.type.Term("get_time",[new e.type.Var("T1")]),new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("T"),new e.type.Term("-",[new e.type.Var("T1"),new e.type.Var("T0")])]),new e.type.Term("write",[new e.type.Var("T")])])])])])]))],"statistics/0":function(r,t,i){var a="% Tau Prolog statistics\n";for(var o in n)a+="%%% "+o+": "+n[o](r).toString()+"\n";r.prepend([new e.type.State(t.goal.replace(new e.type.Term("write",[new e.type.Term(a)])),t.substitution,t)])},"statistics/2":function(r,t,i){var a=i.args[0],o=i.args[1];if(e.type.is_variable(a)||e.type.is_atom(a))if(e.type.is_variable(a)||void 0!==n[a.id])if(e.type.is_variable(a)){var s=[];for(var p in n){y=n[p](r);s.push(new e.type.State(t.goal.replace(new e.type.Term(",",[new e.type.Term("=",[a,new e.type.Term(p,[])]),new e.type.Term("=",[o,y])])),t.substitution,t))}r.prepend(s)}else{var y=n[a.id](r);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[o,y])),t.substitution,t)])}else r.throw_error(e.error.domain("statistics_key",a,i.indicator));else r.throw_error(e.error.type("atom",a,i.indicator))}}},t=["time/1","statistics/0","statistics/2"],n={atoms:function(r){return new e.type.Num(e.statistics.getCountTerms(),!1)},clauses:function(r){var t=0;for(var n in r.session.rules)r.session.rules[n]instanceof Array&&(t+=r.session.rules[n].length);for(var i=0;i<r.session.modules.length;i++)for(var a=e.module[r.session.modules[i]],o=0;o<a.exports.length;o++){var s=a.rules[a.exports[o]];s instanceof Array&&(t+=s.length)}return new e.type.Num(t,!1)},cputime:function(r){return new e.type.Num(r.cpu_time,!1)},walltime:function(r){return new e.type.Num(Date.now(),!1)},epoch:function(r){return new e.type.Num(r.epoch,!1)},inferences:function(r){return new e.type.Num(r.total_steps,!1)},modules:function(r){var t=0;for(var n in r.session.modules)t++;return new e.type.Num(t,!1)},predicates:function(r){for(var t=Object.keys(r.session.rules).length,n=0;n<r.session.modules.length;n++){t+=e.module[r.session.modules[n]].exports.length}return new e.type.Num(t,!1)},threads:function(r){return new e.type.Num(r.session.total_threads,!1)}};"undefined"!=typeof module?module.exports=function(n){new(e=n).type.Module("statistics",r(),t)}:new e.type.Module("statistics",r(),t)}(pl),function(e){var r=function(){return{"bind/4":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2],p=n.args[3];if(e.type.is_variable(i)||e.type.is_variable(a)&&e.type.is_variable(p))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i))if(e.type.is_atom(a))if(e.type.is_variable(o)||e.type.is_dom_event_object(o))if(e.type.is_variable(p)){if(void 0!==(o=i.object.tau_events?i.object.tau_events[a.id]:void 0)){for(var y=[],w=0;w<o.length;w++)y.push(new e.type.State(t.goal.replace(new e.type.Term("=",[p,o[w].goal.rename(r)])),t.substitution,t));r.prepend(y)}}else{var l=new e.type.Thread(r.session),_=new e.type.DOMEvent(a.id),u={};e.type.is_variable(o)&&(u[o.id]=_);var c=new e.type.Substitution(u),m=function(e){_.event=e,l.add_goal(p.apply(c)),l.answer(r.__calls[0])};s.add(i.object,a.id,m),i.object.tau_events=void 0===i.object.tau_events?{}:i.object.tau_events,void 0===i.object.tau_events[a.id]&&(i.object.tau_events[a.id]=[]),i.object.tau_events[a.id].push({goal:p,fn:m}),r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[_,o])),t.substitution,t)])}else r.throw_error(e.error.type("DOMEventObject",a,n.indicator));else r.throw_error(e.error.type("atom",a,n.indicator));else r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"unbind/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i)||e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i))if(e.type.is_atom(a)){if(i.object.tau_events&&i.object.tau_events[a.id]){for(var o=i.object.tau_events[a.id],p=0;p<o.length;p++)s.remove(i.object,a.id,o[p].fn);delete i.object.tau_events[a.id]}r.success(t)}else r.throw_error(e.error.type("atom",a,n.indicator));else r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"unbind/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(i)||e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i))if(e.type.is_atom(a))if(e.type.is_variable(o)||e.type.is_term(o)){if(!e.type.is_variable(o)){if(i.object.tau_events&&i.object.tau_events[a.id]){for(var p=i.object.tau_events[a.id],y=[],w=0;w<p.length;w++)null!==e.unify(p[w].goal,o)?s.remove(i.object,a.id,p[w].fn):y.push(p[w]);i.object.tau_events[a.id]=y}r.success(t)}}else r.throw_error(e.error.type("term",o,n.indicator));else r.throw_error(e.error.type("atom",a,n.indicator));else r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"event_property/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(i)||e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_event_object(i))if(e.type.is_atom(a))if(e.type.is_variable(o)||e.type.is_atomic(o)){if(null!==i.event&&i.event[a.id]){var s=i.event[a.id];s=isNaN(s)?new e.type.Term(s,[]):new e.type.Num(s),r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[s,o])),t.substitution,t)])}}else r.throw_error(e.error.type("atomic",o,n.indicator));else r.throw_error(e.error.type("atom",a,n.indicator));else r.throw_error(e.error.type("DOMEventObject",i,n.indicator))},"prevent_default/1":function(r,t,n){var i=n.args[0];e.type.is_variable(i)?r.throw_error(e.error.instantiation(n.indicator)):e.type.is_dom_event_object(i)?null!==i.event&&(i.event.preventDefault(),r.success(t)):r.throw_error(e.error.type("eventObject",i,n.indicator))},"hide/1":function(r,t,n){var i=n.args[0];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i)){var a=document.defaultView.getComputedStyle(i.object,"").display;void 0!==a&&"none"!==a&&(i.object.tau_display=a),i.object.style.display="none",r.success(t)}else r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"show/1":function(r,t,n){var i=n.args[0];e.type.is_variable(i)?r.throw_error(e.error.instantiation(n.indicator)):e.type.is_dom_object(i)?(i.object.style.display=void 0!==i.object.tau_display?i.object.tau_display:"block",r.success(t)):r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"toggle/1":[new e.type.Rule(new e.type.Term("toggle",[new e.type.Var("X")]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term(",",[new e.type.Term("style",[new e.type.Var("X"),new e.type.Term("display",[]),new e.type.Var("Y")]),new e.type.Term("=",[new e.type.Var("Y"),new e.type.Term("none",[])])]),new e.type.Term("show",[new e.type.Var("X")])]),new e.type.Term("hide",[new e.type.Var("X")])]))],"document/1":function(r,t,n){var i=n.args[0],a=new e.type.DOM(document);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[i,a])),t.substitution,t)])},"head/1":function(r,t,n){var i=n.args[0],a=new e.type.DOM(document.head);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[i,a])),t.substitution,t)])},"body/1":function(r,t,n){var i=n.args[0],a=new e.type.DOM(document.body);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[i,a])),t.substitution,t)])},"get_by_id/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_atom(i))if(e.type.is_variable(a)||e.type.is_dom_object(a)){var o=document.getElementById(i.id);if(o){var s=new e.type.DOM(o);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[s,a])),t.substitution,t)])}}else r.throw_error(e.error.type("HTMLObject",a,n.indicator));else r.throw_error(e.error.type("atom",i,n.indicator))},"get_by_class/2":[new e.type.Rule(new e.type.Term("get_by_class",[new e.type.Var("Class"),new e.type.Var("Html")]),new e.type.Term(",",[new e.type.Term("document",[new e.type.Var("D")]),new e.type.Term("get_by_class",[new e.type.Var("D"),new e.type.Var("Class"),new e.type.Var("Html")])]))],"get_by_class/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i))if(e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_atom(a))if(e.type.is_variable(o)||e.type.is_dom_object(o)){var s=i.object.getElementsByClassName(a.id);if(s){for(var p=[],y=0;y<s.length;y++){var w=new e.type.DOM(s[y]);p.push(new e.type.State(t.goal.replace(new e.type.Term("=",[w,o])),t.substitution,t))}r.prepend(p)}}else r.throw_error(e.error.type("HTMLObject",o,n.indicator));else r.throw_error(e.error.type("atom",a,n.indicator));else r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"get_by_tag/2":[new e.type.Rule(new e.type.Term("get_by_tag",[new e.type.Var("Tag"),new e.type.Var("Html")]),new e.type.Term(",",[new e.type.Term("document",[new e.type.Var("D")]),new e.type.Term("get_by_tag",[new e.type.Var("D"),new e.type.Var("Tag"),new e.type.Var("Html")])]))],"get_by_tag/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i))if(e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_atom(a))if(e.type.is_variable(o)||e.type.is_dom_object(o)){var s=i.object.getElementsByTagName(a.id);if(s){for(var p=[],y=0;y<s.length;y++){var w=new e.type.DOM(s[y]);p.push(new e.type.State(t.goal.replace(new e.type.Term("=",[w,o])),t.substitution,t))}r.prepend(p)}}else r.throw_error(e.error.type("HTMLObject",o,n.indicator));else r.throw_error(e.error.type("atom",a,n.indicator));else r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"get_by_name/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_atom(i))if(e.type.is_variable(a)||e.type.is_dom_object(a)){var o=document.getElementsByName(i.id);if(o){for(var s=[],p=0;p<o.length;p++){var y=new e.type.DOM(o[p]);s.push(new e.type.State(t.goal.replace(new e.type.Term("=",[y,a])),t.substitution,t))}r.prepend(s)}}else r.throw_error(e.error.type("HTMLObject",a,n.indicator));else r.throw_error(e.error.type("atom",i,n.indicator))},"get_style/3":function(r,t,n){var i=n.args[0],o=n.args[1],s=n.args[2];if(e.type.is_variable(i)||e.type.is_variable(o))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i))if(e.type.is_atom(o)){if(i.object===document)return;var p=document.defaultView.getComputedStyle(i.object,"")[o.id]||"";""===p&&i.object.style[o.id]&&(p=i.object.style[o.id]);var y=a(p);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[s,y])),t.substitution,t)])}else r.throw_error(e.error.type("atom",o,n.indicator));else r.throw_error(e.error.type("HTMLObject",selector,n.indicator))},"set_style/3":function(r,t,n){var a=n.args[0],o=n.args[1],s=n.args[2],p=i(s),y=e.type.is_ground(s);if(e.type.is_variable(a)||e.type.is_variable(o)||!y)r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(a))if(e.type.is_atom(o))if(!1===p)r.throw_error(e.error.domain("style_value",s,n.indicator));else{if(a.object===document)return;a.object.style[o.id]=p,r.success(t)}else r.throw_error(e.error.type("atom",o,n.indicator));else r.throw_error(e.error.type("HTMLObject",selector,n.indicator))},"style/3":function(r,t,n){var o=n.args[0],s=n.args[1],p=n.args[2],y=i(p),w=e.type.is_ground(p);if(e.type.is_variable(o)||e.type.is_variable(s))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(o))if(e.type.is_atom(s))if(!e.type.is_variable(p)&&w&&!1===y)r.throw_error(e.error.domain("style_value",p,n.indicator));else{if(o.object===document)return;if(w)o.object.style[s.id]=y,r.success(t);else{var l=document.defaultView.getComputedStyle(o.object,"")[s.id]||"";""===l&&o.object.style[s.id]&&(l=o.object.style[s.id]);var _=a(l);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[p,_])),t.substitution,t)])}}else r.throw_error(e.error.type("atom",s,n.indicator));else r.throw_error(e.error.type("HTMLObject",o,n.indicator))},"get_attr/3":function(r,t,n){var i=n.args[0],o=n.args[1],s=n.args[2];if(e.type.is_variable(i)||e.type.is_variable(o))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i))if(e.type.is_atom(o)){if(i.object===document)return;var p="value"===o.id?new e.type.Term(i.object.value):a(i.object.getAttribute(o.id));null!=p&&r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[s,p])),t.substitution,t)])}else r.throw_error(e.error.type("atom",o,n.indicator));else r.throw_error(e.error.type("HTMLObject",selector,n.indicator))},"set_attr/3":function(r,t,n){var a=n.args[0],o=n.args[1],s=n.args[2],p=i(s),y=e.type.is_ground(s);if(e.type.is_variable(a)||e.type.is_variable(o)||!y)r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(a))if(e.type.is_atom(o))if(!1===p)r.throw_error(e.error.domain("attribute_value",s,n.indicator));else{if(a.object===document)return;"value"===o.id?a.object.value=p:a.object.setAttribute(o.id,p),r.success(t)}else r.throw_error(e.error.type("atom",o,n.indicator));else r.throw_error(e.error.type("HTMLObject",selector,n.indicator))},"attr/3":function(r,t,n){var o=n.args[0],s=n.args[1],p=n.args[2],y=i(p),w=e.type.is_ground(p);if(e.type.is_variable(o)||e.type.is_variable(s))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(o))if(e.type.is_atom(s))if(!e.type.is_variable(p)&&w&&!1===y)r.throw_error(e.error.domain("attribute_value",p,n.indicator));else{if(o.object===document)return;if(w)"value"===s.id?o.object.value=y:o.object.setAttribute(s.id,y),r.success(t);else{var l="value"===s.id?new e.type.Term(o.object.value):a(o.object.getAttribute(s.id));null!=l&&r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[p,l])),t.substitution,t)])}}else r.throw_error(e.error.type("atom",s,n.indicator));else r.throw_error(e.error.type("HTMLObject",selector,n.indicator))},"get_html/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i)){if(i.object===document)return;var o=new e.type.Term(i.object.innerHTML);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[o,a])),t.substitution,t)])}else session.throw_error(e.error.type("HTMLObject",i,n.indicator))},"set_html/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i)||e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i)){if(i.object===document)return;e.type.is_atom(a)?i.object.innerHTML=a.id:i.object.innerHTML=a.toString(),r.success(t)}else session.throw_error(e.error.type("HTMLObject",i,n.indicator))},"html/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else{if(i.object===document)return;if(e.type.is_variable(a)){var o=new e.type.Term(i.object.innerHTML);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[o,a])),t.substitution,t)])}else e.type.is_atom(a)?i.object.innerHTML=a.id:i.object.innerHTML=a.toString(),r.success(t)}},"create/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i)&&e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_variable(i)||e.type.is_atom(i))if(e.type.is_variable(a)||e.type.is_dom_object(a)){if(e.type.is_variable(a)){var o=new e.type.DOM(document.createElement(i.id));r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[a,o])),t.substitution,t)])}else if(e.type.is_variable(a)){o=new e.type.DOM(document.createElement(i.id.toLowerCase()));r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[a,o])),t.substitution,t)])}else if(e.type.is_variable(i)){var s=new e.type.Term(a.object.nodeName.toLowerCase());r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[s,i])),t.substitution,t)])}}else r.throw_error(e.error.type("HTMLObject",a,n.indicator));else r.throw_error(e.error.type("atom",i,n.indicator))},"parent_of/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(a)&&e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_variable(a)||e.type.is_dom_object(a))if(e.type.is_variable(i)||e.type.is_dom_object(i))if(e.type.is_variable(i)){for(var o=a.object.children,s=[],p=0;p<o.length;p++)s.push(new e.type.State(t.goal.replace(new e.type.Term("=",[i,new e.type.DOM(o[p])])),t.substitution,t));r.prepend(s)}else i.object.parentNode&&r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[a,new e.type.DOM(i.object.parentNode)])),t.substitution,t)]);else r.throw_error(e.error.type("HTMLObject",i,n.indicator));else r.throw_error(e.error.type("HTMLObject",a,n.indicator))},"sibling/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i)&&e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_variable(i)||e.type.is_dom_object(i))if(e.type.is_variable(a)||e.type.is_dom_object(a)){if(e.type.is_variable(i)&&a.object.previousElementSibling){var o=new e.type.DOM(a.object.previousElementSibling);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[i,o])),t.substitution,t)])}else if(!e.type.is_variable(i)&&i.object.nextElementSibling){o=new e.type.DOM(i.object.nextElementSibling);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[a,o])),t.substitution,t)])}}else r.throw_error(e.error.type("HTMLObject",a,n.indicator));else r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"remove/1":function(r,t,n){var i=n.args[0];e.type.is_variable(i)?r.throw_error(e.error.instantiation(n.indicator)):e.type.is_dom_object(i)?i.object.parentNode&&(i.object.parentNode.removeChild(i.object),r.success(t)):r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"insert_after/2":function(r,t,n){var i=n.args[0],a=n.args[1];e.type.is_variable(i)||e.type.is_variable(a)?r.throw_error(e.error.instantiation(n.indicator)):e.type.is_dom_object(i)?e.type.is_dom_object(a)?a.object.parentNode&&(a.object.parentNode.insertBefore(i.object,a.object.nextSibling),r.success(t)):r.throw_error(e.error.type("HTMLObject",a,n.indicator)):r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"insert_before/2":function(r,t,n){var i=n.args[0],a=n.args[1];e.type.is_variable(i)||e.type.is_variable(a)?r.throw_error(e.error.instantiation(n.indicator)):e.type.is_dom_object(i)?e.type.is_dom_object(a)?a.object.parentNode&&(a.object.parentNode.insertBefore(i.object,a.object),r.success(t)):r.throw_error(e.error.type("HTMLObject",a,n.indicator)):r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"prepend_child/2":function(r,t,n){var i=n.args[0],a=n.args[1];e.type.is_variable(i)||e.type.is_variable(a)?r.throw_error(e.error.instantiation(n.indicator)):e.type.is_dom_object(i)?e.type.is_dom_object(a)?(i.object.firstChild?i.object.insertBefore(a.object,i.object.firstChild):i.object.appendChild(a.object),r.success(t)):r.throw_error(e.error.type("HTMLObject",a,n.indicator)):r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"append_child/2":function(r,t,n){var i=n.args[0],a=n.args[1];e.type.is_variable(i)||e.type.is_variable(a)?r.throw_error(e.error.instantiation(n.indicator)):e.type.is_dom_object(i)?e.type.is_dom_object(a)?(i.object.appendChild(a.object),r.success(t)):r.throw_error(e.error.type("HTMLObject",a,n.indicator)):r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"add_class/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i)||e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i))if(e.type.is_atom(a)){-1===i.object.className.split(" ").indexOf(a.id)&&(i.object.className+=" "+a.id),r.success(t)}else r.throw_error(e.error.type("atom",a,n.indicator));else r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"remove_class/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i))if(e.type.is_atom(a)||e.type.is_variable(a)){var o=i.object.className.split(" ");if(e.type.is_variable(a)){for(var s=[],p=0;p<o.length;p++)s.push(new e.type.State(t.goal.replace(new e.type.Term(",",[new e.type.Term("=",[a,new e.type.Term(o[p],[])]),new e.type.Term("remove_class",[i,a])])),t.substitution,t));r.prepend(s)}else{var y="";for(p=0;p<o.length;p++)o[p]!==a.id&&(y+=o[p]+" ");i.object.className=y,r.success(t)}}else r.throw_error(e.error.type("atom",a,n.indicator));else r.throw_error(e.error.type("HTMLObject",i,n.indicator))},"hasClass/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_dom_object(i))if(e.type.is_atom(a)||e.type.is_variable(a)){var o=i.object.className.split(" ");if(e.type.is_variable(a)){for(var s=[],p=0;p<o.length;p++)s.push(new e.type.State(t.goal.replace(new e.type.Term("=",[a,new e.type.Term(o[p],[])])),t.substitution,t));r.prepend(s)}else-1!==o.indexOf(a.id)&&r.success(t)}else r.throw_error(e.error.type("atom",a,n.indicator));else r.throw_error(e.error.type("HTMLObject",i,n.indicator))}}},t=["document/1","head/1","body/1","show/1","hide/1","toggle/1","create/2","get_by_id/2","get_by_tag/2","get_by_tag/3","get_by_class/2","get_by_class/3","get_by_name/2","attr/3","set_attr/3","get_attr/3","style/3","set_style/3","get_style/3","html/2","set_html/2","get_html/2","parent_of/2","insert_after/2","insert_before/2","append_child/2","prepend_child/2","sibling/2","remove/1","add_class/2","remove_class/2","has_class/2","bind/4","unbind/2","unbind/3","event_property/3","prevent_default/1"],n=function(){return{meta_predicates:{"bind/4":new e.type.Term("bind",[new e.type.Term("+"),new e.type.Term("+"),new e.type.Term("-"),new e.type.Num(0)])}}};function i(r){return null!=r&&(e.type.is_number(r)?r.value:e.type.is_term(r)&&0===r.args.length?r.id:e.type.is_term(r)&&"px/1"===r.indicator&&e.type.is_number(r.args[0])?r.args[0].value.toString()+"px":e.type.is_term(r)&&"%/1"===r.indicator&&e.type.is_number(r.args[0])?r.args[0].value.toString()+"%":e.type.is_term(r)&&"url/1"===r.indicator&&e.type.is_atom(r.args[0])?'url("'+r.args[0].id+'")':!!(e.type.is_term(r)&&"rgb/3"===r.indicator&&e.type.is_integer(r.args[0])&&e.type.is_integer(r.args[1])&&e.type.is_integer(r.args[2]))&&r.toString())}function a(r){if(null!=r){if(/^-?[0-9]*\.?[0-9]*\s*px\s*$/.test(r))return new e.type.Term("px",[new e.type.Num(parseInt(r))]);if(/^-?[0-9]*\.?[0-9]*\s*\%\s*$/.test(r))return new e.type.Term("%",[new e.type.Num(parseFloat(r))]);if(/^url\(["'].*["']\)$/.test(r))return new e.type.Term("url",[new e.type.Term(r.substring(5,r.length-2))]);if(/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)\s*$/.test(r)){var t=r.replace("rgb","").replace("(","").replace(")","").split(",");return new e.type.Term("rgb",[new e.type.Num(parseInt(t[0]),!1),new e.type.Num(parseInt(t[1]),!1),new e.type.Num(parseInt(t[2]),!1)])}return new e.type.Term(r.toString(),[])}}e.type.is_dom_object=function(r){return r instanceof e.type.DOM},e.type.order.push(e.type.DOM),e.type.DOM=function(e){this.object=e},e.type.DOM.prototype.toString=function(){return"<html>("+(""!==this.object.id&&void 0!==this.object.id?"#"+this.object.id:this.object.nodeName.toLowerCase().replace("#",""))+")"},e.type.DOM.prototype.clone=function(){return new e.type.DOM(this.object)},e.type.DOM.prototype.equals=function(r){return e.type.is_dom_object(r)&&this.object===r.object},e.type.DOM.prototype.rename=function(e){return this},e.type.DOM.prototype.variables=function(){return[]},e.type.DOM.prototype.apply=function(e){return this},e.type.DOM.prototype.unify=function(r,t){return e.type.is_dom_object(r)&&this.object===r.object?new e.type.Substitution:null},e.type.DOM.prototype.interpret=function(r){return e.error.instantiation(r)},e.type.DOM.prototype.compare=function(e){return this.object===e.object?0:this.object<e.object?-1:this.object>e.object?1:void 0},e.type.DOM.prototype.toJavaScript=function(){return this.object},e.fromJavaScript.test.dom=function(e){return e instanceof HTMLElement},e.fromJavaScript.conversion.dom=function(r){return new e.type.DOM(r)},e.fromJavaScript.test.dom_collection=function(e){return e instanceof HTMLCollection},e.fromJavaScript.conversion.dom_collection=function(r){var t=Array.prototype.slice.call(r,0);return e.fromJavaScript.apply(t)},e.type.DOM.prototype.stream=function(r,t){return"write"===t&&(this.object instanceof HTMLInputElement?this.object.value="":this.object.innerHTML=""),{object:this.object,get:function(e,r){var t;return r>=(t=this.object instanceof HTMLInputElement?this.object.value:this.object.innerHTML).length?"end_of_stream":t.substring(r,r+e)},put:function(e,r){return"end_of_file"===r?(this.object instanceof HTMLInputElement?this.object.value+=e:this.object.innerHTML+=e,!0):"past_end_of_file"===r?null:(this.object instanceof HTMLInputElement?this.object.value=this.object.value.substring(0,r)+e+this.object.value.substring(r+e.length):this.object.innerHTML=this.object.innerHTML.substring(0,r)+e+this.object.innerHTML.substring(r+e.length),!0)},get_byte:function(r){if("end_of_stream"===r)return-1;var t,n=Math.floor(r/2);if((t=this.object instanceof HTMLInputElement?this.object.value.substring(r,r+length):this.object.innerHTML).length<=n)return-1;var i=e.utils.codePointAt(t[Math.floor(r/2)],0);return r%2==0?255&i:i/256>>>0},put_byte:function(r,t){var n;n=this.object instanceof HTMLInputElement?this.object.value:this.object.innerHTML;var i="end_of_stream"===t?n.length:Math.floor(t/2);if(n.length<i)return null;var a=n.length===i?-1:e.utils.codePointAt(n[Math.floor(t/2)],0);return a=t%2==0?(255&(a=a/256>>>0))<<8|255&r:(255&r)<<8|255&(a&=255),n.length===i?n+=e.utils.fromCodePoint(a):n=n.substring(0,i)+e.utils.fromCodePoint(a)+n.substring(i+1),this.object instanceof HTMLInputElement?this.object.value=n:this.object.innerHTML=n,!0},flush:function(){return!0},close:function(){return!0}}},e.type.is_dom_event_object=function(r){return r instanceof e.type.DOMEvent},e.type.order.push(e.type.DOMEvent),e.type.DOMEvent=function(e,r,t){this.type=e,this.event=r||null,this.epoch=t||(new Date).getTime()},e.type.DOMEvent.prototype.toString=function(){return"<event>("+this.type.toLowerCase()+")"},e.type.DOMEvent.prototype.clone=function(){return new e.type.DOMEvent(this.type,this.event,this.epoch)},e.type.DOMEvent.prototype.equals=function(r){return e.type.is_dom_event_object(r)&&this.type===r.type&&this.epoch===r.epoch},e.type.DOMEvent.prototype.rename=function(e){return this},e.type.DOMEvent.prototype.variables=function(){return[]},e.type.DOMEvent.prototype.apply=function(e){return this},e.type.DOMEvent.prototype.unify=function(r,t){return e.type.is_dom_event_object(r)&&this.type===r.type&&this.epoch===r.epoch?new e.type.Substitution:null},e.type.DOMEvent.prototype.interpret=function(r){return e.error.instantiation(r)},e.type.DOMEvent.prototype.compare=function(e){return this.epoch===e.epoch?0:this.epoch<e.epoch?-1:this.epoch>e.epoch?1:void 0},e.type.DOMEvent.prototype.toJavaScript=function(){return this.event},e.fromJavaScript.test.event=function(e){return e instanceof Event},e.fromJavaScript.conversion.event=function(r){return new e.type.DOMEvent(r.type,r)};var o,s=(o={},{add:function(e,r,t){if(void 0!==e.addEventListener)return e.addEventListener(r,t),!0;if(void 0!==e.attachEvent)return e.attachEvent("on"+r,t),!0;var n=e["on"+r],i=[];if(n){if(n.tau_fn_event===o)return-1===n.fns.indexOf(t)&&n.fns.push(t),!0;i.push(n)}return i.push(t),e["on"+r]=function(r){for(var t=0;t<i.length;t++)i[t].call(e,r,e)},e["on"+r].fns=i,e["on"+r].tau_fn_event=o,!0},remove:function(e,r,t){if(e.removeEventListener)return e.removeEventListener(r,t),!0;if(e.detachEvent)return e.detachEvent("on"+r,t),!0;if(e["on"+r]){var n=e["on"+r];if(n!==t){if(n.tau_fn_event===o){for(var i=0;i<n.fns.length;i++)if(n.fns[i]===t){n.fns.splice(i,1);break}return!0}return!1}e["on"+r]=void 0}return!0}});"undefined"!=typeof module?module.exports=function(i){new(e=i).type.Module("dom",r(),t,n())}:new e.type.Module("dom",r(),t,n())}(pl),function(e){var r=function(){return{"global/1":function(r,t,n){r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[n.args[0],e.fromJavaScript.apply(e.__env)])),t.substitution,t)])},"apply/3":[new e.type.Rule(new e.type.Term("apply",[new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z")]),new e.type.Term(",",[new e.type.Term("global",[new e.type.Var("G")]),new e.type.Term("apply",[new e.type.Var("G"),new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z")])]))],"apply/4":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2],s=n.args[3];e.type.is_variable(i)||e.type.is_variable(a)||e.type.is_variable(o)?r.throw_error(e.error.instantiation(n.indicator)):e.type.is_atom(a)||e.type.is_js_object(a)&&"function"==typeof a.value?e.type.is_list(o)||r.throw_error(e.error.type("list",o,n.indicator)):r.throw_error(e.error.type("atom_or_JSValueFUNCTION",a,n.indicator));var p=i.toJavaScript(),y=e.type.is_atom(a)?p[a.id]:a.toJavaScript();if("function"==typeof y){for(var w,l,_=o,u=[];"./2"===_.indicator;){if(void 0===(w=_.args[0].toJavaScript()))return void r.throw_error(e.error.domain("javascript_object",_.args[0],n.indicator));u.push(w),_=_.args[1]}if(e.type.is_variable(_))return void r.throw_error(e.error.instantiation(n.indicator));if("[]/0"!==_.indicator)return void r.throw_error(e.error.type("list",o,n.indicator));try{l=y.apply(p,u)}catch(t){return void r.throw_error(e.error.javascript(t.toString(),n.indicator))}l=e.fromJavaScript.apply(l),r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[l,s])),t.substitution,t)])}},"prop/2":[new e.type.Rule(new e.type.Term("prop",[new e.type.Var("X"),new e.type.Var("Y")]),new e.type.Term("get_prop",[new e.type.Var("X"),new e.type.Var("Y")]))],"prop/3":[new e.type.Rule(new e.type.Term("prop",[new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z")]),new e.type.Term("get_prop",[new e.type.Var("X"),new e.type.Var("Y"),new e.type.Var("Z")]))],"get_prop/2":[new e.type.Rule(new e.type.Term("get_prop",[new e.type.Var("X"),new e.type.Var("Y")]),new e.type.Term(",",[new e.type.Term("global",[new e.type.Var("G")]),new e.type.Term("get_prop",[new e.type.Var("G"),new e.type.Var("X"),new e.type.Var("Y")])]))],"get_prop/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_variable(a)||e.type.is_atom(a))if(e.type.is_atom(a)){void 0!==(s=i.toJavaScript()[a.id])&&(s=e.fromJavaScript.apply(s),r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[s,o])),t.substitution,t)]))}else{var s=i.toJavaScript(),p=[];for(var y in s)if(s.hasOwnProperty(y)){var w=e.fromJavaScript.apply(s[y]);p.push(new e.type.State(t.goal.replace(new e.type.Term(",",[new e.type.Term("=",[w,o]),new e.type.Term("=",[new e.type.Term(y,[]),a])])),t.substitution,t))}r.prepend(p)}else r.throw_error(e.error.type("atom",a,n.indicator))},"set_prop/2":[new e.type.Rule(new e.type.Term("set_prop",[new e.type.Var("X"),new e.type.Var("Y")]),new e.type.Term(",",[new e.type.Term("global",[new e.type.Var("G")]),new e.type.Term("set_prop",[new e.type.Var("G"),new e.type.Var("X"),new e.type.Var("Y")])]))],"set_prop/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(i)||e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_atom(a)){var s=i.toJavaScript();void 0!==s&&(s[a.id]=o.toJavaScript(),r.success(t))}else r.throw_error(e.error.type("atom",a,n.indicator))},"new/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(i)||e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_js_object(i))if(e.type.is_list(a)){for(var s=[],p=a;e.type.is_term(p)&&"./2"===p.indicator;)s.push(p.args[0].toJavaScript()),p=p.args[1];if(!e.type.is_term(p)||"[]/0"!==p.indicator)return void r.throw_error(e.error.type("list",a,n.indicator));try{var y=e.fromJavaScript.apply(new(Function.prototype.bind.apply(i.value,[null].concat(s))));r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[o,y])),t.substitution,t)])}catch(t){r.throw_error(e.error.javascript(t.toString(),n.indicator))}}else r.throw_error(e.error.type("list",a,n.indicator));else r.throw_error(e.error.type("JsValueOBJECT",a,n.indicator))},"json_prolog/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i)&&e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_variable(i)||e.type.is_js_object(i)&&"object"==typeof i.value)if(e.type.is_variable(a)||e.type.is_list(a))if(e.type.is_variable(a)){var o=e.fromJavaScript.apply(i.value,!0);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[a,o])),t.substitution,t)])}else{var s=new e.type.JSValue(a.toJavaScript());r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[i,s])),t.substitution,t)])}else r.throw_error(e.error.type("list",a,n.indicator));else r.throw_error(e.error.type("JsValueOBJECT",i,n.indicator))},"json_atom/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i)&&e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_variable(i)||e.type.is_js_object(i)&&"object"==typeof i.value)if(e.type.is_variable(a)||e.type.is_atom(a))if(e.type.is_variable(a))try{var o=new e.type.Term(JSON.stringify(i.value),[]);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[a,o])),t.substitution,t)])}catch(e){}else try{var s=e.fromJavaScript.apply(JSON.parse(a.id));r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[i,s])),t.substitution,t)])}catch(e){}else r.throw_error(e.error.type("atom",a,n.indicator));else r.throw_error(e.error.type("JsValueOBJECT",i,n.indicator))},"ajax/3":[new e.type.Rule(new e.type.Term("ajax",[new e.type.Var("Method"),new e.type.Var("URL"),new e.type.Var("Response")]),new e.type.Term("ajax",[new e.type.Var("Method"),new e.type.Var("URL"),new e.type.Var("Response"),new e.type.Term("[]",[])]))],"ajax/4":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2],s=n.args[3];if(e.type.is_variable(a)||e.type.is_variable(i)||e.type.is_variable(s))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_atom(a))if(e.type.is_atom(i))if(e.type.is_list(s))if(-1===["connect","delete","get","head","options","patch","post","put","trace"].indexOf(i.id))r.throw_error(e.error.domain("http_method",i,n.indicator));else{for(var p=s,y=null,w=0,l="false",_="true",u=null,c=[],m=new FormData,d=null,f=null;e.type.is_term(p)&&"./2"===p.indicator;){var h=p.args[0];if(!e.type.is_term(h)||1!==h.args.length)return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));var g=h.args[0];if("type/1"===h.indicator){if(!e.type.is_atom(g)||"text"!==g.id&&"json"!==g.id&&"document"!==g.id)return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));y=g.id}else if("user/1"===h.indicator){if(!e.type.is_atom(g))return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));d=g.id}else if("password/1"===h.indicator){if(!e.type.is_atom(g))return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));f=g.id}else if("timeout/1"===h.indicator){if(!e.type.is_integer(g)||g.value<0)return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));w=g.value}else if("async/1"===h.indicator){if(!e.type.is_atom(g)||"true"!==g.id&&"false"!==g.id)return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));_=g.id}else if("credentials/1"===h.indicator){if(!e.type.is_atom(g)||"true"!==g.id&&"false"!==g.id)return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));l=g.id}else if("mime/1"===h.indicator){if(!e.type.is_atom(g))return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));u=g.id}else if("headers/1"===h.indicator){if(!e.type.is_list(g))return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));for(var v=g;e.type.is_term(v)&&"./2"===v.indicator;){var T=v.args[0];if(!e.type.is_term(T)||"-/2"!==T.indicator||!e.type.is_atom(T.args[0])||!e.type.is_atom(T.args[1]))return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));c.push({header:T.args[0].id,value:T.args[1].id}),v=v.args[1]}if(e.type.is_variable(v))return void r.throw_error(e.error.instantiation(n.indicator));if(!e.type.is_term(v)||"[]/0"!==v.indicator)return void r.throw_error(e.error.domain("ajax_option",h,n.indicator))}else{if("body/1"!==h.indicator)return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));if(!(e.type.is_list(g)||void 0!==e.type.is_dom_object&&e.type.is_dom_object(g)||e.type.is_atom(g)))return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));if(e.type.is_list(g)){for(v=g;e.type.is_term(v)&&"./2"===v.indicator;){var V=v.args[0];if(!e.type.is_term(V)||"-/2"!==V.indicator||!e.type.is_atom(V.args[0])||!e.type.is_atom(V.args[1]))return void r.throw_error(e.error.domain("ajax_option",h,n.indicator));m.append(V.args[0].id,V.args[1].id),v=v.args[1]}if(e.type.is_variable(v))return void r.throw_error(e.error.instantiation(n.indicator));if(!e.type.is_term(v)||"[]/0"!==v.indicator)return void r.throw_error(e.error.domain("ajax_option",h,n.indicator))}else m=e.type.is_atom(g)?g.id:g.value}p=p.args[1]}if(e.type.is_variable(p))return void r.throw_error(e.error.instantiation(n.indicator));if(!e.type.is_term(p)||"[]/0"!==p.indicator)return void r.throw_error(e.error.type("list",s,n.indicator));var b=new XMLHttpRequest;null!==u&&b.overrideMimeType(u);var x=function(){if(4==this.readyState){if(200==this.status){var n=null,i=this.getResponseHeader("Content-Type");if("json"===this.responseType&&this.response)n=e.fromJavaScript.apply(this.response);else if(""===this.responseType&&-1!==i.indexOf("application/json"))try{n=e.fromJavaScript.apply(JSON.parse(this.responseText))}catch(e){}null===n&&(("document"===this.responseType||""===this.responseType&&-1!==i.indexOf("text/html")||""===this.responseType&&-1!==i.indexOf("application/xml"))&&null!==this.responseXML&&void 0!==e.type.DOM?n=new e.type.DOM(this.responseXML):""!==this.responseType&&"text"!==this.responseType||(n=new e.type.Term(this.responseText,[]))),null!==n&&r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[o,n])),t.substitution,t)])}"true"===_&&r.again()}};b.onreadystatechange=x,b.open(i.id.toUpperCase(),a.id,"true"===_,d,f),null!==y&&"true"===_&&(b.responseType=y),b.withCredentials="true"===l,"true"===_&&(b.timeout=w);for(var S=0;S<c.length;S++)b.setRequestHeader(c[S].header,c[S].value);if(b.send(m),"true"===_)return!0;x.apply(b)}else r.throw_error(e.error.type("list",s,n.indicator));else r.throw_error(e.error.type("atom",i,n.indicator));else r.throw_error(e.error.type("atom",a,n.indicator))}}},t=["global/1","apply/3","apply/4","prop/2","prop/3","get_prop/2","get_prop/3","set_prop/2","set_prop/3","new/3","json_prolog/2","json_atom/2","ajax/3","ajax/4"];function n(){e.type.is_js_object=function(r){return r instanceof e.type.JSValue},e.type.order.push(e.type.JSValue),e.type.JSValue=function(e){this.value=e},e.type.JSValue.prototype.toString=function(){return"<javascript>("+(typeof this.value).toLowerCase()+")"},e.type.JSValue.prototype.clone=function(){return new e.type.JSValue(this.value)},e.type.JSValue.prototype.equals=function(r){return e.type.is_js_object(r)&&this.value===r.value},e.type.JSValue.prototype.rename=function(e){return this},e.type.JSValue.prototype.variables=function(){return[]},e.type.JSValue.prototype.apply=function(e){return this},e.type.JSValue.prototype.unify=function(r,t){if(e.type.is_js_object(r)&&this.value===r.value)return new e.type.Substitution;if(e.type.is_term(r)&&"{}/1"===r.indicator){for(var n=[],i=[],a=r.args[0],o=[];e.type.is_term(a)&&",/2"===a.indicator;)o.push(a.args[0]),a=a.args[1];o.push(a);for(var s=0;s<o.length;s++){var p=o[s];if(!e.type.is_term(p)||":/2"!==p.indicator)return null;var y=p.args[0];if(!e.type.is_atom(y)||!this.value.hasOwnProperty(y.id))return null;var w=e.fromJavaScript.apply(this.value[y.id]);i.push(p.args[1]),n.push(w)}return e.unify(n,i,t)}return null},e.type.JSValue.prototype.interpret=function(r){return e.error.instantiation(r)},e.type.JSValue.prototype.compare=function(e){return this.value===e.value?0:this.value<e.value?-1:this.value>e.value?1:void 0},e.type.JSValue.prototype.toJavaScript=function(){return this.value},e.fromJavaScript.conversion.any=function(r){return new e.type.JSValue(r)},e.error.javascript=function(r,t){return new e.type.Term("error",[new e.type.Term("javascript_error",[new e.type.Term(r)]),e.utils.str_indicator(t)])}}"undefined"!=typeof module?module.exports=function(i){e=i,n(),new e.type.Module("js",r(),t)}:(n(),new e.type.Module("js",r(),t))}(pl),function(pl){var predicates=function(){return{"sleep/1":function(e,r,t){var n=t.args[0];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(e.level));else{if(pl.type.is_integer(n))return setTimeout((function(){e.success(r),e.again()}),n.value),!0;e.throw_error(pl.error.type("integer",n,e.level))}},"set_interval/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(pl.type.is_variable(n)||pl.type.is_variable(i)||!pl.type.is_variable(a))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_integer(n))if(pl.type.is_callable(i)){var o=setInterval(function(e,r){return function(){var t=new pl.type.Thread(r.session);t.add_goal(e),t.answer()}}(i,e),n.value);tau_last_interval_id++,tau_intervals[tau_last_interval_id]=o,e.prepend([new pl.type.State(r.goal.replace(new pl.type.Term("=",[a,new pl.type.Num(tau_last_interval_id,!1)])),r.substitution,r)])}else e.throw_error(pl.error.type("callable",i,t.indicator));else e.throw_error(pl.error.type("integer",n,t.indicator))},"set_timeout/3":function(e,r,t){var n=t.args[0],i=t.args[1],a=t.args[2];if(pl.type.is_variable(n)||pl.type.is_variable(i)||!pl.type.is_variable(a))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_integer(n))if(pl.type.is_callable(i)){var o=setTimeout(function(e,r){return function(){var t=new pl.type.Thread(r.session);t.add_goal(e),t.answer()}}(i,e),n.value);tau_last_timeout_id++,tau_timeouts[tau_last_timeout_id]=o,e.prepend([new pl.type.State(r.goal.replace(new pl.type.Term("=",[a,new pl.type.Num(tau_last_timeout_id,!1)])),r.substitution,r)])}else e.throw_error(pl.error.type("callable",i,t.indicator));else e.throw_error(pl.error.type("integer",n,t.indicator))},"clear_interval/1":function(e,r,t){var n=t.args[0];pl.type.is_variable(n)?e.throw_error(pl.error.instantiation(t.indicator)):pl.type.is_integer(n)?tau_intervals[n.value]&&(clearInterval(tau_intervals[n.value]),e.success(r),delete tau_intervals[n.value]):e.throw_error(pl.error.type("integer",n,t.indicator))},"clear_timeout/1":function(e,r,t){var n=t.args[0];pl.type.is_variable(n)?e.throw_error(pl.error.instantiation(t.indicator)):pl.type.is_integer(n)?tau_timeouts[n.value]&&(clearInterval(tau_timeouts[n.value]),e.success(r),delete tau_timeouts[n.value]):e.throw_error(pl.error.type("integer",n,t.indicator))},"shell/1":function(e,r,t){var n=t.args[0];e.prepend([new pl.type.State(r.goal.replace(new pl.type.Term("shell",[n,new pl.type.Num(0,!1)])),r.substitution,r)])},"shell/2":function(thread,point,atom){var command=atom.args[0],status=atom.args[1];if(pl.type.is_variable(command))thread.throw_error(pl.error.instantiation(atom.indicator));else if(pl.type.is_atom(command))if(pl.type.is_variable(status)||pl.type.is_integer(status)){if("true/0"===thread.get_flag("nodejs").indicator){const{exec:e}=require("child_process");return e(command.id,(function(){})).on("exit",(function(e){thread.prepend([new pl.type.State(point.goal.replace(new pl.type.Term("=",[status,new pl.type.Num(e,!1)])),point.substitution,point)]),thread.again()})),!0}try{eval(command.id),thread.prepend([new pl.type.State(point.goal.replace(new pl.type.Term("=",[status,new pl.type.Num(0,!1)])),point.substitution,point)])}catch(e){thread.prepend([new pl.type.State(point.goal.replace(new pl.type.Term("=",[status,new pl.type.Num(1,!1)])),point.substitution,point)])}}else thread.throw_error(pl.error.type("integer",status,atom.indicator));else thread.throw_error(pl.error.type("atom",command,atom.indicator))},"directory_files/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n))if(pl.type.is_variable(i)||pl.type.is_list(i)){var a=e.absolute_file_name(n.id);if("true/0"===e.get_flag("nodejs").indicator)return require("fs").readdir(a,(function(a,o){if(a)e.throw_error(pl.error.existence("directory",n,t.indicator));else{for(var s=new pl.type.Term("[]",[]),p=o.length-1;p>=0;p--)s=new pl.type.Term(".",[new pl.type.Term(o[p],[]),s]);e.prepend([new pl.type.State(r.goal.replace(new pl.type.Term("=",[i,s])),r.substitution,r)])}e.again()})),!0;var o=e.session.file_system.get(a);if(pl.type.is_directory(o)){var s=[];for(var p in o.files)s.push(p);for(var y=new pl.type.Term("[]",[]),w=s.length-1;w>=0;w--)y=new pl.type.Term(".",[new pl.type.Term(s[w],[]),y]);e.prepend([new pl.type.State(r.goal.replace(new pl.type.Term("=",[i,y])),r.substitution,r)])}else e.throw_error(pl.error.existence("directory",n,t.indicator))}else e.throw_error(pl.error.type("list",i,t.indicator));else e.throw_error(pl.error.type("atom",n,t.indicator))},"working_directory/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(!pl.type.is_variable(i)||pl.type.is_variable(n)&&n.id===i.id)if(pl.type.is_variable(n)||pl.type.is_atom(n))if(pl.type.is_variable(i)||pl.type.is_atom(i)){var a;if("true/0"===e.get_flag("nodejs").indicator){if(a=process.cwd(),!pl.type.is_variable(i))try{process.chdir(e.absolute_file_name(i.id))}catch(r){return void e.throw_error(pl.error.existence("directory",i,t.indicator))}}else a=e.session.working_directory,pl.type.is_variable(i)||(e.session.working_directory=e.absolute_file_name(i.id));e.prepend([new pl.type.State(r.goal.replace(new pl.type.Term("=",[n,new pl.type.Term(a,[])])),r.substitution,r)])}else e.throw_error(pl.error.type("atom",i,t.indicator));else e.throw_error(pl.error.type("atom",n,t.indicator));else e.throw_error(pl.error.instantiation(t.indicator))},"delete_file/1":function(e,r,t){var n=t.args[0];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n)){var i=e.absolute_file_name(n.id);if("true/0"===e.get_flag("nodejs").indicator){var a=require("fs");return a.stat(i,(function(o,s){!o&&s.isFile()?a.unlink(i,(function(i){i?e.throw_error(pl.error.permission("delete","source_sink",n,t.indicator)):e.success(r),e.again()})):(e.throw_error(pl.error.existence("source_sink",n,t.indicator)),e.again())})),!0}var o=e.session.file_system.get(i);pl.type.is_file(o)?(o.parent.remove(o.name),e.success(r)):e.throw_error(pl.error.existence("source_sink",n,t.indicator))}else e.throw_error(pl.error.type("atom",n,t.indicator))},"delete_directory/1":function(e,r,t){var n=t.args[0];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n)){var i=e.absolute_file_name(n.id);if("true/0"===e.get_flag("nodejs").indicator){var a=require("fs");return a.stat(i,(function(o,s){!o&&s.isDirectory()?a.rmdir(i,(function(i){i?e.throw_error(pl.error.permission("delete","directory",n,t.indicator)):e.success(r),e.again()})):(e.throw_error(pl.error.existence("directory",n,t.indicator)),e.again())})),!0}var o=e.session.file_system.get(i);pl.type.is_directory(o)?o!==e.session.file_system.files&&o.empty()?(o.parent.remove(o.name),e.success(r)):e.throw_error(pl.error.permission("delete","directory",n,t.indicator)):e.throw_error(pl.error.existence("directory",n,t.indicator))}else e.throw_error(pl.error.type("atom",n,t.indicator))},"make_directory/1":function(e,r,t){var n=t.args[0];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n)){var i=e.absolute_file_name(n.id);if("true/0"===e.get_flag("nodejs").indicator){var a=require("fs");return a.stat(i,(function(o,s){o||!s.isDirectory()&&!s.isFile()?a.mkdir(i,(function(i){i?e.throw_error(pl.error.existence("directory",n,t.indicator)):e.success(r),e.again()})):(e.throw_error(pl.error.permission("create","directory",n,t.indicator)),e.again())})),!0}for(var o=i.replace(/\/$/,"").split("/"),s=e.session.file_system.files,p=o[o.length-1],y=1;y<o.length-1;y++)if(s=s.lookup(o[y]),!pl.type.is_directory(s))return void e.throw_error(pl.error.existence("directory",n,t.indicator));s.lookup(p)?e.throw_error(pl.error.permission("create","directory",n,t.indicator)):(s.push(p,new pl.type.Directory(p,s)),e.success(r))}else e.throw_error(pl.error.type("atom",n,t.indicator))},"copy_file/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(pl.type.is_variable(n)||pl.type.is_variable(i))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n))if(pl.type.is_atom(i)){var a=e.absolute_file_name(n.id),o=e.absolute_file_name(i.id);if("true/0"===e.get_flag("nodejs").indicator){var s=require("fs");return s.stat(a,(function(p,y){p||!y.isFile()?(e.throw_error(pl.error.existence("source_sink",n,t.indicator)),e.again()):s.copyFile(a,o,(function(n){n?e.throw_error(pl.error.existence("source_sink",i,t.indicator)):e.success(r),e.again()}))})),!0}var p=e.file_system_open(a,"text","read");if(p){var y=e.file_system_open(o,"text","write");y?(y.text=p.text,e.success(r)):e.throw_error(pl.error.existence("source_sink",i,t.indicator))}else e.throw_error(pl.error.existence("source_sink",n,t.indicator))}else e.throw_error(pl.error.type("atom",i,t.indicator));else e.throw_error(pl.error.type("atom",n,t.indicator))},"rename_file/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(pl.type.is_variable(n)||pl.type.is_variable(i))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n))if(pl.type.is_atom(i)){var a=e.absolute_file_name(n.id),o=e.absolute_file_name(i.id);if("true/0"===e.get_flag("nodejs").indicator){var s=require("fs");return s.stat(a,(function(p,y){p||!y.isFile()?(e.throw_error(pl.error.existence("source_sink",n,t.indicator)),e.again()):s.rename(a,o,(function(n){n?e.throw_error(pl.error.existence("source_sink",i,t.indicator)):e.success(r),e.again()}))})),!0}var p=e.file_system_open(a,"text","read");if(p){var y=e.file_system_open(o,"text","write");if(y){y.text=p.text;for(var w=a.replace(/\/$/,"").split("/"),l=e.session.file_system.files,_=w[w.length-1],u=1;u<w.length-1;u++)l=l.lookup(w[u]);l.remove(_),e.success(r)}else e.throw_error(pl.error.existence("source_sink",i,t.indicator))}else e.throw_error(pl.error.existence("source_sink",n,t.indicator))}else e.throw_error(pl.error.type("atom",i,t.indicator));else e.throw_error(pl.error.type("atom",n,t.indicator))},"exists_file/1":function(e,r,t){var n=t.args[0];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n)){var i=e.absolute_file_name(n.id);if("true/0"===e.get_flag("nodejs").indicator)return require("fs").stat(i,(function(t,n){!t&&n.isFile()&&e.success(r),e.again()})),!0;var a=e.session.file_system.get(i);pl.type.is_file(a)&&e.success(r)}else e.throw_error(pl.error.type("atom",n,t.indicator))},"exists_directory/1":function(e,r,t){var n=t.args[0];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n)){var i=e.absolute_file_name(n.id);if("true/0"===e.get_flag("nodejs").indicator)return require("fs").stat(i,(function(t,n){!t&&n.isDirectory()&&e.success(r),e.again()})),!0;var a=e.session.file_system.get(i);pl.type.is_directory(a)&&e.success(r)}else e.throw_error(pl.error.type("atom",n,t.indicator))},"same_file/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(pl.type.is_variable(n)||pl.type.is_variable(i))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n))if(pl.type.is_atom(i))if(n.id===i.id)e.success(r);else{var a=e.absolute_file_name(n.id),o=e.absolute_file_name(i.id);if("true/0"===e.get_flag("nodejs").indicator){var s=require("fs");return s.stat(a,(function(t,n){t?e.again():s.stat(o,(function(t,i){t||n.dev!==i.dev||n.ino!==i.ino||e.success(r),e.again()}))})),!0}var p=e.session.file_system.get(a),y=e.session.file_system.get(o);p&&y&&p===y&&e.success(r)}else e.throw_error(pl.error.type("atom",i,t.indicator));else e.throw_error(pl.error.type("atom",n,t.indicator))},"absolute_file_name/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n))if(pl.type.is_variable(i)||pl.type.is_atom(i)){var a=e.absolute_file_name(n.id);e.prepend([new pl.type.State(r.goal.replace(new pl.type.Term("=",[i,new pl.type.Term(a,[])])),r.substitution,r)])}else e.throw_error(pl.error.type("atom",i,t.indicator));else e.throw_error(pl.error.type("atom",n,t.indicator))},"is_absolute_file_name/1":function(e,r,t){var n=t.args[0];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n))if("true/0"===e.get_flag("nodejs").indicator){var i=require("path"),a=n.id;for(var o in process.env)process.env.hasOwnProperty(o)&&(a=a.replace(new RegExp("\\$"+o,"g"),process.env[o]));i.isAbsolute(a)&&e.success(r)}else n.id.length>0&&"/"===n.id[0]&&e.success(r);else e.throw_error(pl.error.type("atom",n,t.indicator))},"size_file/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n))if(pl.type.is_variable(i)||pl.type.is_integer(i)){var a=e.absolute_file_name(n.id);if("true/0"===e.get_flag("nodejs").indicator)return require("fs").stat(a,(function(a,o){if(a)e.throw_error(pl.error.existence("source_sink",n,t.indicator));else{var s=o.size;e.prepend([new pl.type.State(r.goal.replace(new pl.type.Term("=",[i,new pl.type.Num(s,!1)])),r.substitution,r)])}e.again()})),!0;var o=e.session.file_system.get(a);if(pl.type.is_file(o)||pl.type.is_directory(o)){var s=o.size();e.prepend([new pl.type.State(r.goal.replace(new pl.type.Term("=",[i,new pl.type.Num(s,!1)])),r.substitution,r)])}else e.throw_error(pl.error.existence("source_sink",n,t.indicator))}else e.throw_error(pl.error.type("integer",i,t.indicator));else e.throw_error(pl.error.type("atom",n,t.indicator))},"time_file/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n))if(pl.type.is_variable(i)||pl.type.is_number(i)){var a=e.absolute_file_name(n.id);if("true/0"===e.get_flag("nodejs").indicator)return require("fs").stat(a,(function(a,o){if(a)e.throw_error(pl.error.existence("source_sink",n,t.indicator));else{var s=o.mtime/1e3;e.prepend([new pl.type.State(r.goal.replace(new pl.type.Term("=",[i,new pl.type.Num(s)])),r.substitution,r)])}e.again()})),!0;var o=e.session.file_system.get(a);if(pl.type.is_file(o)||pl.type.is_directory(o)){var s=o.modified;e.prepend([new pl.type.State(r.goal.replace(new pl.type.Term("=",[i,new pl.type.Num(s)])),r.substitution,r)])}else e.throw_error(pl.error.existence("source_sink",n,t.indicator))}else e.throw_error(pl.error.type("number",i,t.indicator));else e.throw_error(pl.error.type("atom",n,t.indicator))},"file_permission/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(pl.type.is_variable(n)||pl.type.is_variable(i))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n))if(pl.type.is_atom(i)){var a=e.absolute_file_name(n.id);if("true/0"===e.get_flag("nodejs").indicator){var o=require("fs");if("read/0"===i.indicator)return o.access(a,o.constants.R_OK,(function(t,n){t||e.success(r),e.again()})),!0;if("write/0"===i.indicator)return o.access(a,o.constants.W_OK,(function(t,n){t||e.success(r),e.again()})),!0;if("execute/0"===i.indicator)return o.access(a,o.constants.X_OK,(function(t,n){t||e.success(r),e.again()})),!0;e.throw_error(pl.error.domain("file_permission",i,t.indicator))}else{var s=e.session.file_system.get(a);pl.type.is_file(s)&&e.success(r)}}else e.throw_error(pl.error.type("atom",i,t.indicator));else e.throw_error(pl.error.type("atom",n,t.indicator))},"getenv/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(pl.type.is_variable(n)||pl.type.is_atom(n))if(pl.type.is_variable(i)||pl.type.is_atom(i)){if("true/0"===e.get_flag("nodejs").indicator){var a=[];if(pl.type.is_variable(n)){for(var o in process.env)if(process.env.hasOwnProperty(o)){var s=new pl.type.Term(o,[]),p=new pl.type.Term(process.env[o],[]);a.push(new pl.type.State(r.goal.replace(new pl.type.Term(",",[new pl.type.Term("=",[n,s]),new pl.type.Term("=",[i,p])])),r.substitution,r))}}else null!==(p=process.env[n.id]?new pl.type.Term(process.env[n.id].toString(),[]):null)&&a.push(new pl.type.State(r.goal.replace(new pl.type.Term("=",[i,p])),r.substitution,r));e.prepend(a)}}else e.throw_error(pl.error.type("atom",i,t.indicator));else e.throw_error(pl.error.type("atom",n,t.indicator))},"setenv/2":function(e,r,t){var n=t.args[0],i=t.args[1];if(pl.type.is_variable(n)||pl.type.is_variable(i))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n)||pl.type.is_integer(n))if(pl.type.is_atom(i)||pl.type.is_integer(i)){if("true/0"===e.get_flag("nodejs").indicator){var a=pl.type.is_atom(n)?n.id:n.value.toString(),o=pl.type.is_atom(i)?i.id:i.value.toString();process.env[a]=o,e.success(r)}}else e.throw_error(pl.error.type("atom_or_integer",i,t.indicator));else e.throw_error(pl.error.type("atom_or_integer",n,t.indicator))},"unsetenv/1":function(e,r,t){var n=t.args[0];if(pl.type.is_variable(n))e.throw_error(pl.error.instantiation(t.indicator));else if(pl.type.is_atom(n)||pl.type.is_integer(n)){if("true/0"===e.get_flag("nodejs").indicator){var i=pl.type.is_atom(n)?n.id:n.value.toString();delete process.env[i],e.success(r)}}else e.throw_error(pl.error.type("atom_or_integer",n,t.indicator))},"pid/1":function(e,r,t){var n=t.args[0];if(pl.type.is_variable(n)||pl.type.is_integer(n)){var i=[];if("true/0"===e.get_flag("nodejs").indicator){var a=require("process");i.push(new pl.type.State(r.goal.replace(new pl.type.Term("=",[n,new pl.type.Num(a.pid,!1)])),r.substitution,r))}else i.push(new pl.type.State(r.goal.replace(new pl.type.Term("=",[n,new pl.type.Num(0,!1)])),r.substitution,r));e.prepend(i)}else e.throw_error(pl.error.type("integer",n,t.indicator))}}},exports=["sleep/1","set_interval/3","set_timeout/3","clear_interval/1","clear_timeout/1","shell/1","shell/2","directory_files/2","working_directory/2","delete_file/1","delete_directory/1","rename_file/2","copy_file/2","make_directory/1","exists_file/1","exists_directory/1","same_file/2","absolute_file_name/2","is_absolute_file_name/1","size_file/2","file_permission/2","time_file/2","getenv/2","setenv/2","unsetenv/1","pid/1"],options=function(){return{meta_predicates:{"set_interval/3":new pl.type.Term("set_interval",[new pl.type.Term("+"),new pl.type.Num(0),new pl.type.Term("-")]),"set_timeout/3":new pl.type.Term("set_timeout",[new pl.type.Term("+"),new pl.type.Num(0),new pl.type.Term("-")])}}},tau_last_interval_id=0,tau_last_timeout_id=0,tau_intervals={},tau_timeouts={};"undefined"!=typeof module?module.exports=function(e){new(pl=e).type.Module("os",predicates(),exports,options())}:new pl.type.Module("os",predicates(),exports,options())}(pl),function(e){var r="charsio",t=function(){return{"write_term_to_chars/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(o)||e.type.is_list(o))if(e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else{if(!e.type.is_variable(o)){for(var s=o;e.type.is_term(s)&&"./2"===s.indicator;){var p=s.args[0];if(!e.type.is_character(p))return void r.throw_error(e.error.type("character",p,n.indicator));s=s.args[1]}if(!e.type.is_variable(s)&&!e.type.is_empty_list(s))return void r.throw_error(e.error.type("list",o,n.indicator))}var y,w={};for(s=a;e.type.is_term(s)&&"./2"===s.indicator;){if(y=s.args[0],e.type.is_variable(y))return void r.throw_error(e.error.instantiation(n.indicator));if(!e.type.is_write_option(y))return void r.throw_error(e.error.domain("write_option",y,n.indicator));w[y.id]="true"===y.args[0].id,s=s.args[1]}if("[]/0"!==s.indicator)return void(e.type.is_variable(s)?r.throw_error(e.error.instantiation(n.indicator)):r.throw_error(e.error.type("list",a,n.indicator)));w.session=r.session;for(var l=i.toString(w),_=new e.type.Term("[]",[]),u=e.utils.stringLength(l)-1;u>=0;u--)_=new e.type.Term(".",[new e.type.Term(e.utils.fromCodePoint(e.utils.codePointAt(l,u)),[]),_]);r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[o,_])),t.substitution,t)])}else r.throw_error(e.error.type("list",o,n.indicator))},"fabricate_var_name/3":[new e.type.Rule(new e.type.Term("fabricate_var_name",[new e.type.Var("VarType"),new e.type.Var("VarName"),new e.type.Var("N")]),new e.type.Term(",",[new e.type.Term("char_code",[new e.type.Term("A",[]),new e.type.Var("AC")]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("LN"),new e.type.Term("+",[new e.type.Term("mod",[new e.type.Var("N"),new e.type.Num(26,!1)]),new e.type.Var("AC")])]),new e.type.Term(",",[new e.type.Term("char_code",[new e.type.Var("LC"),new e.type.Var("LN")]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("NN"),new e.type.Term("//",[new e.type.Var("N"),new e.type.Num(26,!1)])]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("=:=",[new e.type.Var("NN"),new e.type.Num(0,!1)]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("==",[new e.type.Var("VarType"),new e.type.Term("fabricated",[])]),new e.type.Term("atom_chars",[new e.type.Var("VarName"),new e.type.Term(".",[new e.type.Term("_",[]),new e.type.Term(".",[new e.type.Var("LC"),new e.type.Term("[]",[])])])])]),new e.type.Term("->",[new e.type.Term("==",[new e.type.Var("VarType"),new e.type.Term("numbervars",[])]),new e.type.Term("atom_chars",[new e.type.Var("VarName"),new e.type.Term(".",[new e.type.Var("LC"),new e.type.Term("[]",[])])])])])]),new e.type.Term(",",[new e.type.Term("number_chars",[new e.type.Var("NN"),new e.type.Var("NNChars")]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("==",[new e.type.Var("VarType"),new e.type.Term("fabricated",[])]),new e.type.Term("atom_chars",[new e.type.Var("VarName"),new e.type.Term(".",[new e.type.Term("_",[]),new e.type.Term(".",[new e.type.Var("LC"),new e.type.Var("NNChars")])])])]),new e.type.Term("->",[new e.type.Term("==",[new e.type.Var("VarType"),new e.type.Term("numbervars",[])]),new e.type.Term("atom_chars",[new e.type.Var("VarName"),new e.type.Term(".",[new e.type.Var("LC"),new e.type.Var("NNChars")])])])])])])])])])]))]}},n=["write_term_to_chars/3"];"undefined"!=typeof module?module.exports=function(i){new(e=i).type.Module(r,t(),n)}:new e.type.Module(r,t(),n)}(pl),function(e){var r="format",t=function(){return{"format_/4":[new e.type.Rule(new e.type.Term("format_",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32320"),new e.type.Var("_32322")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("is_list",[new e.type.Var("_32316")]),new e.type.Term("true",[])]),new e.type.Term("throw",[new e.type.Term("error",[new e.type.Term("type_error",[new e.type.Term("list",[]),new e.type.Var("_32316")]),new e.type.Term("//",[new e.type.Term("format_",[]),new e.type.Num(2,!1)])])])]),new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("is_list",[new e.type.Var("_32317")]),new e.type.Term("true",[])]),new e.type.Term("throw",[new e.type.Term("error",[new e.type.Term("type_error",[new e.type.Term("list",[]),new e.type.Var("_32317")]),new e.type.Term("//",[new e.type.Term("format_",[]),new e.type.Num(2,!1)])])])]),new e.type.Term(",",[new e.type.Term("unique_variable_names",[new e.type.Var("_32317"),new e.type.Var("_32318")]),new e.type.Term("phrase",[new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Num(0,!1),new e.type.Term("[]",[]),new e.type.Var("_32318")]),new e.type.Var("_32319")])])])]),new e.type.Term("=",[new e.type.Var("_32320"),new e.type.Var("_32321")])]),new e.type.Term("format_cells",[new e.type.Var("_32319"),new e.type.Var("_32321"),new e.type.Var("_32322")])]))],"format_cells/3":[new e.type.Rule(new e.type.Term("format_cells",[new e.type.Term("[]",[]),new e.type.Var("_32323"),new e.type.Var("_32323")]),new e.type.Term("true",[])),new e.type.Rule(new e.type.Term("format_cells",[new e.type.Term(".",[new e.type.Var("_32324"),new e.type.Var("_32319")]),new e.type.Var("_32325"),new e.type.Var("_32327")]),new e.type.Term(",",[new e.type.Term("format_cell",[new e.type.Var("_32324"),new e.type.Var("_32325"),new e.type.Var("_32326")]),new e.type.Term("format_cells",[new e.type.Var("_32319"),new e.type.Var("_32326"),new e.type.Var("_32327")])]))],"format_cell/3":[new e.type.Rule(new e.type.Term("format_cell",[new e.type.Term("newline",[]),new e.type.Term(".",[new e.type.Term("\n",[]),new e.type.Var("_32329")]),new e.type.Var("_32329")]),null),new e.type.Rule(new e.type.Term("format_cell",[new e.type.Term("cell",[new e.type.Var("_32330"),new e.type.Var("_32331"),new e.type.Var("_32332")]),new e.type.Var("_32341"),new e.type.Var("_32343")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term("elements_gluevars",[new e.type.Var("_32332"),new e.type.Num(0,!1),new e.type.Var("_32333")]),new e.type.Var("_32334")]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("=",[new e.type.Var("_32334"),new e.type.Term("[]",[])]),new e.type.Term("true",[])]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("_32335"),new e.type.Term("-",[new e.type.Term("-",[new e.type.Var("_32331"),new e.type.Var("_32330")]),new e.type.Var("_32333")])]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("=<",[new e.type.Var("_32335"),new e.type.Num(0,!1)]),new e.type.Term("maplist",[new e.type.Term("=",[new e.type.Num(0,!1)]),new e.type.Var("_32334")])]),new e.type.Term(",",[new e.type.Term("length",[new e.type.Var("_32334"),new e.type.Var("_32336")]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("_32337"),new e.type.Term("//",[new e.type.Var("_32335"),new e.type.Var("_32336")])]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("_32338"),new e.type.Term("-",[new e.type.Var("_32335"),new e.type.Term("*",[new e.type.Var("_32337"),new e.type.Var("_32336")])])]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("=:=",[new e.type.Var("_32338"),new e.type.Num(0,!1)]),new e.type.Term("maplist",[new e.type.Term("=",[new e.type.Var("_32337")]),new e.type.Var("_32334")])]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("_32339"),new e.type.Term("+",[new e.type.Var("_32337"),new e.type.Var("_32338")])]),new e.type.Term(",",[new e.type.Term("reverse",[new e.type.Var("_32334"),new e.type.Term(".",[new e.type.Var("_32339"),new e.type.Var("_32340")])]),new e.type.Term("maplist",[new e.type.Term("=",[new e.type.Var("_32337")]),new e.type.Var("_32340")])])])])])])])])])])]),new e.type.Term("=",[new e.type.Var("_32341"),new e.type.Var("_32342")])]),new e.type.Term("format_elements",[new e.type.Var("_32332"),new e.type.Var("_32342"),new e.type.Var("_32343")])]))],"format_elements/3":[new e.type.Rule(new e.type.Term("format_elements",[new e.type.Term("[]",[]),new e.type.Var("_32344"),new e.type.Var("_32344")]),new e.type.Term("true",[])),new e.type.Rule(new e.type.Term("format_elements",[new e.type.Term(".",[new e.type.Var("_32345"),new e.type.Var("_32332")]),new e.type.Var("_32346"),new e.type.Var("_32348")]),new e.type.Term(",",[new e.type.Term("format_element",[new e.type.Var("_32345"),new e.type.Var("_32346"),new e.type.Var("_32347")]),new e.type.Term("format_elements",[new e.type.Var("_32332"),new e.type.Var("_32347"),new e.type.Var("_32348")])]))],"format_element/3":[new e.type.Rule(new e.type.Term("format_element",[new e.type.Term("chars",[new e.type.Var("_32349")]),new e.type.Var("_32350"),new e.type.Var("_32351")]),new e.type.Term("seq",[new e.type.Var("_32349"),new e.type.Var("_32350"),new e.type.Var("_32351")])),new e.type.Rule(new e.type.Term("format_element",[new e.type.Term("glue",[new e.type.Var("_32352"),new e.type.Var("_32353")]),new e.type.Var("_32355"),new e.type.Var("_32357")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("length",[new e.type.Var("_32354"),new e.type.Var("_32353")]),new e.type.Term("maplist",[new e.type.Term("=",[new e.type.Var("_32352")]),new e.type.Var("_32354")])]),new e.type.Term("=",[new e.type.Var("_32355"),new e.type.Var("_32356")])]),new e.type.Term("seq",[new e.type.Var("_32354"),new e.type.Var("_32356"),new e.type.Var("_32357")])]))],"elements_gluevars/5":[new e.type.Rule(new e.type.Term("elements_gluevars",[new e.type.Term("[]",[]),new e.type.Var("_32358"),new e.type.Var("_32358"),new e.type.Var("_32359"),new e.type.Var("_32359")]),new e.type.Term("true",[])),new e.type.Rule(new e.type.Term("elements_gluevars",[new e.type.Term(".",[new e.type.Var("_32345"),new e.type.Var("_32332")]),new e.type.Var("_32360"),new e.type.Var("_32358"),new e.type.Var("_32362"),new e.type.Var("_32364")]),new e.type.Term(",",[new e.type.Term("element_gluevar",[new e.type.Var("_32345"),new e.type.Var("_32360"),new e.type.Var("_32361"),new e.type.Var("_32362"),new e.type.Var("_32363")]),new e.type.Term("elements_gluevars",[new e.type.Var("_32332"),new e.type.Var("_32361"),new e.type.Var("_32358"),new e.type.Var("_32363"),new e.type.Var("_32364")])]))],"element_gluevar/5":[new e.type.Rule(new e.type.Term("element_gluevar",[new e.type.Term("chars",[new e.type.Var("_32349")]),new e.type.Var("_32360"),new e.type.Var("_32358"),new e.type.Var("_32366"),new e.type.Var("_32367")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("length",[new e.type.Var("_32349"),new e.type.Var("_32365")]),new e.type.Term("is",[new e.type.Var("_32358"),new e.type.Term("+",[new e.type.Var("_32360"),new e.type.Var("_32365")])])]),new e.type.Term("=",[new e.type.Var("_32366"),new e.type.Var("_32367")])])),new e.type.Rule(new e.type.Term("element_gluevar",[new e.type.Term("glue",[new e.type.Var("__32368"),new e.type.Var("_32369")]),new e.type.Var("_32358"),new e.type.Var("_32358"),new e.type.Term(".",[new e.type.Var("_32369"),new e.type.Var("_32371")]),new e.type.Var("_32371")]),null)],"cells/7":[new e.type.Rule(new e.type.Term("cells",[new e.type.Term("[]",[]),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("__32373"),new e.type.Var("_32374"),new e.type.Var("_32378")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32374"),new e.type.Var("_32375")])]),new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term(",",[new e.type.Term("==",[new e.type.Var("_32317"),new e.type.Term("[]",[])]),new e.type.Term("=",[new e.type.Var("_32375"),new e.type.Var("_32376")])]),new e.type.Term("cell",[new e.type.Var("_32372"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32376"),new e.type.Var("_32377")])]),new e.type.Term(",",[new e.type.Term("throw",[new e.type.Term("error",[new e.type.Term("domain_error",[new e.type.Term("empty_list",[]),new e.type.Var("_32317")]),new e.type.Term("//",[new e.type.Term("cells",[]),new e.type.Num(5,!1)])])]),new e.type.Term("=",[new e.type.Var("_32375"),new e.type.Var("_32378")])])]),new e.type.Term("=",[new e.type.Var("_32377"),new e.type.Var("_32378")])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Var("_32316")])]),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32379"),new e.type.Var("_32381")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32379"),new e.type.Var("_32380")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term("[]",[])])]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32380"),new e.type.Var("_32381")])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("w",[]),new e.type.Var("_32316")])]),new e.type.Term(".",[new e.type.Var("_32382"),new e.type.Var("_32317")]),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32384"),new e.type.Var("_32387")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32384"),new e.type.Var("_32385")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("write_term_to_chars",[new e.type.Var("_32382"),new e.type.Term(".",[new e.type.Term("numbervars",[new e.type.Term("true",[])]),new e.type.Term(".",[new e.type.Term("variable_names",[new e.type.Var("_32318")]),new e.type.Term("[]",[])])]),new e.type.Var("_32383")]),new e.type.Term("=",[new e.type.Var("_32385"),new e.type.Var("_32386")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Var("_32383")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32386"),new e.type.Var("_32387")])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("q",[]),new e.type.Var("_32316")])]),new e.type.Term(".",[new e.type.Var("_32382"),new e.type.Var("_32317")]),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32388"),new e.type.Var("_32391")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32388"),new e.type.Var("_32389")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("write_term_to_chars",[new e.type.Var("_32382"),new e.type.Term(".",[new e.type.Term("quoted",[new e.type.Term("true",[])]),new e.type.Term(".",[new e.type.Term("numbervars",[new e.type.Term("true",[])]),new e.type.Term(".",[new e.type.Term("variable_names",[new e.type.Var("_32318")]),new e.type.Term("[]",[])])])]),new e.type.Var("_32383")]),new e.type.Term("=",[new e.type.Var("_32389"),new e.type.Var("_32390")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Var("_32383")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32390"),new e.type.Var("_32391")])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("a",[]),new e.type.Var("_32316")])]),new e.type.Term(".",[new e.type.Var("_32382"),new e.type.Var("_32317")]),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32392"),new e.type.Var("_32395")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32392"),new e.type.Var("_32393")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("atom_chars",[new e.type.Var("_32382"),new e.type.Var("_32383")]),new e.type.Term("=",[new e.type.Var("_32393"),new e.type.Var("_32394")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Var("_32383")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32394"),new e.type.Var("_32395")])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Var("_32396")]),new e.type.Var("_32397"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32404"),new e.type.Var("_32411")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("numeric_argument",[new e.type.Var("_32396"),new e.type.Var("_32353"),new e.type.Term(".",[new e.type.Term("d",[]),new e.type.Var("_32316")]),new e.type.Var("_32397"),new e.type.Term(".",[new e.type.Var("_32398"),new e.type.Var("_32317")])]),new e.type.Term("=",[new e.type.Var("_32404"),new e.type.Var("_32405")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32405"),new e.type.Var("_32406")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("_32382"),new e.type.Var("_32398")]),new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("integer",[new e.type.Var("_32382")]),new e.type.Term("true",[])]),new e.type.Term("throw",[new e.type.Term("error",[new e.type.Term("type_error",[new e.type.Term("integer",[]),new e.type.Var("_32382")]),new e.type.Term("//",[new e.type.Term("cells",[]),new e.type.Num(5,!1)])])])]),new e.type.Term("number_chars",[new e.type.Var("_32382"),new e.type.Var("_32399")])])]),new e.type.Term("=",[new e.type.Var("_32406"),new e.type.Var("_32407")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term(",",[new e.type.Term("=:=",[new e.type.Var("_32353"),new e.type.Num(0,!1)]),new e.type.Term("=",[new e.type.Var("_32407"),new e.type.Var("_32408")])]),new e.type.Term(",",[new e.type.Term("=",[new e.type.Var("_32349"),new e.type.Var("_32399")]),new e.type.Term("=",[new e.type.Var("_32408"),new e.type.Var("_32409")])])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("length",[new e.type.Var("_32399"),new e.type.Var("_32365")]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("=<",[new e.type.Var("_32365"),new e.type.Var("_32353")]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("_32338"),new e.type.Term("-",[new e.type.Var("_32353"),new e.type.Var("_32365")])]),new e.type.Term(",",[new e.type.Term("length",[new e.type.Var("_32400"),new e.type.Var("_32338")]),new e.type.Term(",",[new e.type.Term("maplist",[new e.type.Term("=",[new e.type.Term("0",[])]),new e.type.Var("_32400")]),new e.type.Term("phrase",[new e.type.Term(",",[new e.type.Term(".",[new e.type.Term("0",[]),new e.type.Term(".",[new e.type.Term(".",[]),new e.type.Term("[]",[])])]),new e.type.Term(",",[new e.type.Term("seq",[new e.type.Var("_32400")]),new e.type.Term("seq",[new e.type.Var("_32399")])])]),new e.type.Var("_32349")])])])])]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("_32401"),new e.type.Term("-",[new e.type.Var("_32365"),new e.type.Var("_32353")])]),new e.type.Term(",",[new e.type.Term("length",[new e.type.Var("_32402"),new e.type.Var("_32401")]),new e.type.Term(",",[new e.type.Term("append",[new e.type.Var("_32402"),new e.type.Var("_32403"),new e.type.Var("_32399")]),new e.type.Term("phrase",[new e.type.Term(",",[new e.type.Term("seq",[new e.type.Var("_32402")]),new e.type.Term(",",[new e.type.Term(".",[new e.type.Term(".",[]),new e.type.Term("[]",[])]),new e.type.Term("seq",[new e.type.Var("_32403")])])]),new e.type.Var("_32349")])])])])])]),new e.type.Term("=",[new e.type.Var("_32407"),new e.type.Var("_32410")])])]),new e.type.Term("=",[new e.type.Var("_32409"),new e.type.Var("_32410")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Var("_32349")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32410"),new e.type.Var("_32411")])])])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Var("_32396")]),new e.type.Var("_32397"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32417"),new e.type.Var("_32421")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("numeric_argument",[new e.type.Var("_32396"),new e.type.Var("_32353"),new e.type.Term(".",[new e.type.Term("D",[]),new e.type.Var("_32316")]),new e.type.Var("_32397"),new e.type.Term(".",[new e.type.Var("_32382"),new e.type.Var("_32317")])]),new e.type.Term("=",[new e.type.Var("_32417"),new e.type.Var("_32418")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32418"),new e.type.Var("_32419")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("number_chars",[new e.type.Var("_32353"),new e.type.Var("_32412")]),new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term(",",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term("[]",[])]),new e.type.Term(",",[new e.type.Term("seq",[new e.type.Var("_32412")]),new e.type.Term(".",[new e.type.Term("d",[]),new e.type.Term("[]",[])])])]),new e.type.Var("_32413")]),new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term("format_",[new e.type.Var("_32413"),new e.type.Term(".",[new e.type.Var("_32382"),new e.type.Term("[]",[])])]),new e.type.Var("_32399")]),new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term("upto_what",[new e.type.Var("_32414"),new e.type.Term(".",[])]),new e.type.Var("_32399"),new e.type.Var("_32403")]),new e.type.Term(",",[new e.type.Term("reverse",[new e.type.Var("_32414"),new e.type.Var("_32415")]),new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term("groups_of_three",[new e.type.Var("_32415")]),new e.type.Var("_32416")]),new e.type.Term(",",[new e.type.Term("reverse",[new e.type.Var("_32416"),new e.type.Var("_32402")]),new e.type.Term("append",[new e.type.Var("_32402"),new e.type.Var("_32403"),new e.type.Var("_32349")])])])])])])])]),new e.type.Term("=",[new e.type.Var("_32419"),new e.type.Var("_32420")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Var("_32349")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32420"),new e.type.Var("_32421")])])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("i",[]),new e.type.Var("_32316")])]),new e.type.Term(".",[new e.type.Var("__32422"),new e.type.Var("_32317")]),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32423"),new e.type.Var("_32425")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32423"),new e.type.Var("_32424")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32424"),new e.type.Var("_32425")])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("n",[]),new e.type.Var("_32316")])]),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32426"),new e.type.Var("_32430")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32426"),new e.type.Var("_32427")])]),new e.type.Term(",",[new e.type.Term("cell",[new e.type.Var("_32372"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32427"),new e.type.Var("_32428")]),new e.type.Term(",",[new e.type.Term("n_newlines",[new e.type.Num(1,!1),new e.type.Var("_32428"),new e.type.Var("_32429")]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Num(0,!1),new e.type.Term("[]",[]),new e.type.Var("_32318"),new e.type.Var("_32429"),new e.type.Var("_32430")])])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Var("_32396")]),new e.type.Var("_32397"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32431"),new e.type.Var("_32436")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("numeric_argument",[new e.type.Var("_32396"),new e.type.Var("_32353"),new e.type.Term(".",[new e.type.Term("n",[]),new e.type.Var("_32316")]),new e.type.Var("_32397"),new e.type.Var("_32317")]),new e.type.Term("=",[new e.type.Var("_32431"),new e.type.Var("_32432")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32432"),new e.type.Var("_32433")])]),new e.type.Term(",",[new e.type.Term("cell",[new e.type.Var("_32372"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32433"),new e.type.Var("_32434")]),new e.type.Term(",",[new e.type.Term("n_newlines",[new e.type.Var("_32353"),new e.type.Var("_32434"),new e.type.Var("_32435")]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Num(0,!1),new e.type.Term("[]",[]),new e.type.Var("_32318"),new e.type.Var("_32435"),new e.type.Var("_32436")])])])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("s",[]),new e.type.Var("_32316")])]),new e.type.Term(".",[new e.type.Var("_32382"),new e.type.Var("_32317")]),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32437"),new e.type.Var("_32439")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32437"),new e.type.Var("_32438")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Var("_32382")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32438"),new e.type.Var("_32439")])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("f",[]),new e.type.Var("_32316")])]),new e.type.Term(".",[new e.type.Var("_32382"),new e.type.Var("_32317")]),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32440"),new e.type.Var("_32443")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32440"),new e.type.Var("_32441")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("format_number_chars",[new e.type.Var("_32382"),new e.type.Var("_32383")]),new e.type.Term("=",[new e.type.Var("_32441"),new e.type.Var("_32442")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Var("_32383")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32442"),new e.type.Var("_32443")])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Var("_32396")]),new e.type.Var("_32397"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32445"),new e.type.Var("_32449")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("numeric_argument",[new e.type.Var("_32396"),new e.type.Var("_32353"),new e.type.Term(".",[new e.type.Term("f",[]),new e.type.Var("_32316")]),new e.type.Var("_32397"),new e.type.Term(".",[new e.type.Var("_32382"),new e.type.Var("_32317")])]),new e.type.Term("=",[new e.type.Var("_32445"),new e.type.Var("_32446")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32446"),new e.type.Var("_32447")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("format_number_chars",[new e.type.Var("_32382"),new e.type.Var("_32399")]),new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term("upto_what",[new e.type.Var("_32402"),new e.type.Term(".",[])]),new e.type.Var("_32399"),new e.type.Var("_32349")]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("=:=",[new e.type.Var("_32353"),new e.type.Num(0,!1)]),new e.type.Term("=",[new e.type.Var("_32383"),new e.type.Var("_32402")])]),new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("=",[new e.type.Var("_32349"),new e.type.Term(".",[new e.type.Term(".",[]),new e.type.Var("_32340")])]),new e.type.Term(",",[new e.type.Term("length",[new e.type.Var("_32340"),new e.type.Var("_32365")]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("<",[new e.type.Var("_32353"),new e.type.Var("_32365")]),new e.type.Term(",",[new e.type.Term("length",[new e.type.Var("_32403"),new e.type.Var("_32353")]),new e.type.Term("append",[new e.type.Var("_32403"),new e.type.Var("__32444"),new e.type.Var("_32340")])])]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("=:=",[new e.type.Var("_32353"),new e.type.Var("_32365")]),new e.type.Term("=",[new e.type.Var("_32403"),new e.type.Var("_32340")])]),new e.type.Term(",",[new e.type.Term(">",[new e.type.Var("_32353"),new e.type.Var("_32365")]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("_32338"),new e.type.Term("-",[new e.type.Var("_32353"),new e.type.Var("_32365")])]),new e.type.Term(",",[new e.type.Term("length",[new e.type.Var("_32400"),new e.type.Var("_32338")]),new e.type.Term(",",[new e.type.Term("maplist",[new e.type.Term("=",[new e.type.Term("0",[])]),new e.type.Var("_32400")]),new e.type.Term("append",[new e.type.Var("_32340"),new e.type.Var("_32400"),new e.type.Var("_32403")])])])])])])])])]),new e.type.Term(",",[new e.type.Term("length",[new e.type.Var("_32403"),new e.type.Var("_32353")]),new e.type.Term("maplist",[new e.type.Term("=",[new e.type.Term("0",[])]),new e.type.Var("_32403")])])]),new e.type.Term("append",[new e.type.Var("_32402"),new e.type.Term(".",[new e.type.Term(".",[]),new e.type.Var("_32403")]),new e.type.Var("_32383")])])])])]),new e.type.Term("=",[new e.type.Var("_32447"),new e.type.Var("_32448")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Var("_32383")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32448"),new e.type.Var("_32449")])])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("r",[]),new e.type.Var("_32316")])]),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32450"),new e.type.Var("_32452")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32450"),new e.type.Var("_32451")])]),new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("8",[]),new e.type.Term(".",[new e.type.Term("r",[]),new e.type.Var("_32316")])])]),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32451"),new e.type.Var("_32452")])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Var("_32396")]),new e.type.Var("_32397"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32453"),new e.type.Var("_32457")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("numeric_argument",[new e.type.Var("_32396"),new e.type.Var("_32353"),new e.type.Term(".",[new e.type.Term("r",[]),new e.type.Var("_32316")]),new e.type.Var("_32397"),new e.type.Term(".",[new e.type.Var("_32382"),new e.type.Var("_32317")])]),new e.type.Term("=",[new e.type.Var("_32453"),new e.type.Var("_32454")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32454"),new e.type.Var("_32455")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("integer_to_radix",[new e.type.Var("_32382"),new e.type.Var("_32353"),new e.type.Term("lowercase",[]),new e.type.Var("_32349")]),new e.type.Term("=",[new e.type.Var("_32455"),new e.type.Var("_32456")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Var("_32349")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32456"),new e.type.Var("_32457")])])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("R",[]),new e.type.Var("_32316")])]),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32458"),new e.type.Var("_32460")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32458"),new e.type.Var("_32459")])]),new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("8",[]),new e.type.Term(".",[new e.type.Term("R",[]),new e.type.Var("_32316")])])]),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32459"),new e.type.Var("_32460")])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Var("_32396")]),new e.type.Var("_32397"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32461"),new e.type.Var("_32465")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("numeric_argument",[new e.type.Var("_32396"),new e.type.Var("_32353"),new e.type.Term(".",[new e.type.Term("R",[]),new e.type.Var("_32316")]),new e.type.Var("_32397"),new e.type.Term(".",[new e.type.Var("_32382"),new e.type.Var("_32317")])]),new e.type.Term("=",[new e.type.Var("_32461"),new e.type.Var("_32462")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32462"),new e.type.Var("_32463")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("integer_to_radix",[new e.type.Var("_32382"),new e.type.Var("_32353"),new e.type.Term("uppercase",[]),new e.type.Var("_32349")]),new e.type.Term("=",[new e.type.Var("_32463"),new e.type.Var("_32464")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Var("_32349")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32464"),new e.type.Var("_32465")])])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("`",[]),new e.type.Term(".",[new e.type.Var("_32466"),new e.type.Term(".",[new e.type.Term("t",[]),new e.type.Var("_32316")])])])]),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32468"),new e.type.Var("_32470")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32468"),new e.type.Var("_32469")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("glue",[new e.type.Var("_32466"),new e.type.Var("__32467")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32469"),new e.type.Var("_32470")])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("t",[]),new e.type.Var("_32316")])]),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32472"),new e.type.Var("_32474")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32472"),new e.type.Var("_32473")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("glue",[new e.type.Term(" ",[]),new e.type.Var("__32471")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32473"),new e.type.Var("_32474")])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("|",[]),new e.type.Var("_32316")])]),new e.type.Var("_32317"),new e.type.Var("_32475"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32478"),new e.type.Var("_32482")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32478"),new e.type.Var("_32479")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term("elements_gluevars",[new e.type.Var("_32332"),new e.type.Num(0,!1),new e.type.Var("_32476")]),new e.type.Var("__32477")]),new e.type.Term("is",[new e.type.Var("_32372"),new e.type.Term("+",[new e.type.Var("_32475"),new e.type.Var("_32476")])])]),new e.type.Term("=",[new e.type.Var("_32479"),new e.type.Var("_32480")])]),new e.type.Term(",",[new e.type.Term("cell",[new e.type.Var("_32475"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32480"),new e.type.Var("_32481")]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term("[]",[]),new e.type.Var("_32318"),new e.type.Var("_32481"),new e.type.Var("_32482")])])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Var("_32396")]),new e.type.Var("_32397"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32483"),new e.type.Var("_32487")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("numeric_argument",[new e.type.Var("_32396"),new e.type.Var("_32353"),new e.type.Term(".",[new e.type.Term("|",[]),new e.type.Var("_32316")]),new e.type.Var("_32397"),new e.type.Var("_32317")]),new e.type.Term("=",[new e.type.Var("_32483"),new e.type.Var("_32484")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32484"),new e.type.Var("_32485")])]),new e.type.Term(",",[new e.type.Term("cell",[new e.type.Var("_32372"),new e.type.Var("_32353"),new e.type.Var("_32332"),new e.type.Var("_32485"),new e.type.Var("_32486")]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32353"),new e.type.Term("[]",[]),new e.type.Var("_32318"),new e.type.Var("_32486"),new e.type.Var("_32487")])])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Var("_32396")]),new e.type.Var("_32397"),new e.type.Var("_32475"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32488"),new e.type.Var("_32493")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("numeric_argument",[new e.type.Var("_32396"),new e.type.Var("_32353"),new e.type.Term(".",[new e.type.Term("+",[]),new e.type.Var("_32316")]),new e.type.Var("_32397"),new e.type.Var("_32317")]),new e.type.Term("=",[new e.type.Var("_32488"),new e.type.Var("_32489")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32489"),new e.type.Var("_32490")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("_32372"),new e.type.Term("+",[new e.type.Var("_32475"),new e.type.Var("_32353")])]),new e.type.Term("=",[new e.type.Var("_32490"),new e.type.Var("_32491")])]),new e.type.Term(",",[new e.type.Term("cell",[new e.type.Var("_32475"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32491"),new e.type.Var("_32492")]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term("[]",[]),new e.type.Var("_32318"),new e.type.Var("_32492"),new e.type.Var("_32493")])])])])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Var("_32349")]),new e.type.Var("_32317"),new e.type.Var("__32494"),new e.type.Var("__32495"),new e.type.Var("__32496"),new e.type.Var("_32497"),new e.type.Var("_32500")]),new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term(",",[new e.type.Term("==",[new e.type.Var("_32317"),new e.type.Term("[]",[])]),new e.type.Term("=",[new e.type.Var("_32497"),new e.type.Var("_32498")])]),new e.type.Term(",",[new e.type.Term("throw",[new e.type.Term("error",[new e.type.Term("domain_error",[new e.type.Term("non_empty_list",[]),new e.type.Term("[]",[])]),new e.type.Term("//",[new e.type.Term("cells",[]),new e.type.Num(5,!1)])])]),new e.type.Term("=",[new e.type.Var("_32498"),new e.type.Var("_32499")])])]),new e.type.Term(",",[new e.type.Term("throw",[new e.type.Term("error",[new e.type.Term("domain_error",[new e.type.Term("format_string",[]),new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Var("_32349")])]),new e.type.Term("//",[new e.type.Term("cells",[]),new e.type.Num(5,!1)])])]),new e.type.Term("=",[new e.type.Var("_32497"),new e.type.Var("_32500")])])]),new e.type.Term("=",[new e.type.Var("_32499"),new e.type.Var("_32500")])])),new e.type.Rule(new e.type.Term("cells",[new e.type.Var("_32396"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Var("_32332"),new e.type.Var("_32318"),new e.type.Var("_32504"),new e.type.Var("_32506")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term("upto_what",[new e.type.Var("_32501"),new e.type.Term("~",[])]),new e.type.Var("_32396"),new e.type.Var("_32316")]),new e.type.Term("=",[new e.type.Var("_32501"),new e.type.Term(".",[new e.type.Var("__32502"),new e.type.Var("__32503")])])]),new e.type.Term("=",[new e.type.Var("_32504"),new e.type.Var("_32505")])]),new e.type.Term("cells",[new e.type.Var("_32316"),new e.type.Var("_32317"),new e.type.Var("_32372"),new e.type.Term(".",[new e.type.Term("chars",[new e.type.Var("_32501")]),new e.type.Var("_32332")]),new e.type.Var("_32318"),new e.type.Var("_32505"),new e.type.Var("_32506")])]))],"format_number_chars/2":[new e.type.Rule(new e.type.Term("format_number_chars",[new e.type.Var("N0"),new e.type.Var("Chars")]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("N"),new e.type.Var("N0")]),new e.type.Term("number_chars",[new e.type.Var("N"),new e.type.Var("Chars")])]))],"n_newlines/3":[new e.type.Rule(new e.type.Term("n_newlines",[new e.type.Num(0,!1),new e.type.Var("_32507"),new e.type.Var("_32508")]),new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32507"),new e.type.Var("_32508")])])),new e.type.Rule(new e.type.Term("n_newlines",[new e.type.Var("_32360"),new e.type.Var("_32509"),new e.type.Var("_32512")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(">",[new e.type.Var("_32360"),new e.type.Num(0,!1)]),new e.type.Term("is",[new e.type.Var("_32358"),new e.type.Term("-",[new e.type.Var("_32360"),new e.type.Num(1,!1)])])]),new e.type.Term("=",[new e.type.Var("_32509"),new e.type.Var("_32510")])]),new e.type.Term(",",[new e.type.Term("=",[new e.type.Var("_32510"),new e.type.Term(".",[new e.type.Term("newline",[]),new e.type.Var("_32511")])]),new e.type.Term("n_newlines",[new e.type.Var("_32358"),new e.type.Var("_32511"),new e.type.Var("_32512")])])]))],"upto_what/4":[new e.type.Rule(new e.type.Term("upto_what",[new e.type.Term("[]",[]),new e.type.Var("_32513"),new e.type.Var("_32514"),new e.type.Var("_32517")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("=",[new e.type.Var("_32514"),new e.type.Term(".",[new e.type.Var("_32513"),new e.type.Var("_32515")])]),new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32515"),new e.type.Var("_32516")])])]),new e.type.Term("=",[new e.type.Var("_32517"),new e.type.Term(".",[new e.type.Var("_32513"),new e.type.Var("_32516")])])])),new e.type.Rule(new e.type.Term("upto_what",[new e.type.Term(".",[new e.type.Var("_32518"),new e.type.Var("_32349")]),new e.type.Var("_32513"),new e.type.Term(".",[new e.type.Var("_32518"),new e.type.Var("_32520")]),new e.type.Var("_32522")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32520"),new e.type.Var("_32521")])]),new e.type.Term("upto_what",[new e.type.Var("_32349"),new e.type.Var("_32513"),new e.type.Var("_32521"),new e.type.Var("_32522")])])),new e.type.Rule(new e.type.Term("upto_what",[new e.type.Term("[]",[]),new e.type.Var("__32523"),new e.type.Var("_32524"),new e.type.Var("_32524")]),new e.type.Term("true",[]))],"groups_of_three/3":[new e.type.Rule(new e.type.Term("groups_of_three",[new e.type.Term(".",[new e.type.Var("_32525"),new e.type.Term(".",[new e.type.Var("_32526"),new e.type.Term(".",[new e.type.Var("_32518"),new e.type.Term(".",[new e.type.Var("_32527"),new e.type.Var("_32528")])])])]),new e.type.Var("_32529"),new e.type.Var("_32533")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32529"),new e.type.Var("_32530")])]),new e.type.Term(",",[new e.type.Term("=",[new e.type.Var("_32530"),new e.type.Term(".",[new e.type.Var("_32525"),new e.type.Term(".",[new e.type.Var("_32526"),new e.type.Term(".",[new e.type.Var("_32518"),new e.type.Var("_32531")])])])]),new e.type.Term(",",[new e.type.Term("=",[new e.type.Var("_32531"),new e.type.Term(".",[new e.type.Term(",",[]),new e.type.Var("_32532")])]),new e.type.Term("groups_of_three",[new e.type.Term(".",[new e.type.Var("_32527"),new e.type.Var("_32528")]),new e.type.Var("_32532"),new e.type.Var("_32533")])])])])),new e.type.Rule(new e.type.Term("groups_of_three",[new e.type.Var("_32354"),new e.type.Var("_32534"),new e.type.Var("_32535")]),new e.type.Term("seq",[new e.type.Var("_32354"),new e.type.Var("_32534"),new e.type.Var("_32535")]))],"cell/5":[new e.type.Rule(new e.type.Term("cell",[new e.type.Var("_32330"),new e.type.Var("_32331"),new e.type.Var("_32536"),new e.type.Var("_32537"),new e.type.Var("_32540")]),new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term(",",[new e.type.Term("==",[new e.type.Var("_32536"),new e.type.Term("[]",[])]),new e.type.Term("=",[new e.type.Var("_32537"),new e.type.Var("_32538")])]),new e.type.Term("true",[])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("reverse",[new e.type.Var("_32536"),new e.type.Var("_32332")]),new e.type.Term("=",[new e.type.Var("_32537"),new e.type.Var("_32539")])]),new e.type.Term("=",[new e.type.Var("_32539"),new e.type.Term(".",[new e.type.Term("cell",[new e.type.Var("_32330"),new e.type.Var("_32331"),new e.type.Var("_32332")]),new e.type.Var("_32540")])])])]),new e.type.Term("=",[new e.type.Var("_32538"),new e.type.Var("_32540")])]))],"numeric_argument/5":[new e.type.Rule(new e.type.Term("numeric_argument",[new e.type.Var("Ds"),new e.type.Var("Num"),new e.type.Var("Rest"),new e.type.Var("Args0"),new e.type.Var("Args")]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("=",[new e.type.Var("Ds"),new e.type.Term(".",[new e.type.Term("*",[]),new e.type.Var("Rest")])]),new e.type.Term("=",[new e.type.Var("Args0"),new e.type.Term(".",[new e.type.Var("Num"),new e.type.Var("Args")])])]),new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term("numeric_argument_",[new e.type.Var("Ds"),new e.type.Var("Rest")]),new e.type.Var("Ns")]),new e.type.Term(",",[new e.type.Term("foldl",[new e.type.Term("plus_times10",[]),new e.type.Var("Ns"),new e.type.Num(0,!1),new e.type.Var("Num")]),new e.type.Term("=",[new e.type.Var("Args0"),new e.type.Var("Args")])])])]))],"numeric_argument_/4":[new e.type.Rule(new e.type.Term("numeric_argument_",[new e.type.Term(".",[new e.type.Var("_32527"),new e.type.Var("_32403")]),new e.type.Var("_32340"),new e.type.Var("_32541"),new e.type.Var("_32546")]),new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term(",",[new e.type.Term("member",[new e.type.Var("_32527"),new e.type.Term(".",[new e.type.Term("0",[]),new e.type.Term(".",[new e.type.Term("1",[]),new e.type.Term(".",[new e.type.Term("2",[]),new e.type.Term(".",[new e.type.Term("3",[]),new e.type.Term(".",[new e.type.Term("4",[]),new e.type.Term(".",[new e.type.Term("5",[]),new e.type.Term(".",[new e.type.Term("6",[]),new e.type.Term(".",[new e.type.Term("7",[]),new e.type.Term(".",[new e.type.Term("8",[]),new e.type.Term(".",[new e.type.Term("9",[]),new e.type.Term("[]",[])])])])])])])])])])])]),new e.type.Term("=",[new e.type.Var("_32541"),new e.type.Var("_32542")])]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("number_chars",[new e.type.Var("_32358"),new e.type.Term(".",[new e.type.Var("_32527"),new e.type.Term("[]",[])])]),new e.type.Term("=",[new e.type.Var("_32542"),new e.type.Var("_32543")])]),new e.type.Term(",",[new e.type.Term("=",[new e.type.Var("_32543"),new e.type.Term(".",[new e.type.Var("_32358"),new e.type.Var("_32544")])]),new e.type.Term("numeric_argument_",[new e.type.Var("_32403"),new e.type.Var("_32340"),new e.type.Var("_32544"),new e.type.Var("_32545")])])])]),new e.type.Term(",",[new e.type.Term("=",[new e.type.Var("_32340"),new e.type.Term(".",[new e.type.Var("_32527"),new e.type.Var("_32403")])]),new e.type.Term("=",[new e.type.Var("_32541"),new e.type.Var("_32546")])])]),new e.type.Term("=",[new e.type.Var("_32545"),new e.type.Var("_32546")])]))],"plus_times10/3":[new e.type.Rule(new e.type.Term("plus_times10",[new e.type.Var("D"),new e.type.Var("N0"),new e.type.Var("N")]),new e.type.Term("is",[new e.type.Var("N"),new e.type.Term("+",[new e.type.Var("D"),new e.type.Term("*",[new e.type.Var("N0"),new e.type.Num(10,!1)])])]))],"radix_error/4":[new e.type.Rule(new e.type.Term("radix_error",[new e.type.Term("lowercase",[]),new e.type.Var("_32547"),new e.type.Var("_32548"),new e.type.Var("_32549")]),new e.type.Term("format_",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("d",[]),new e.type.Term(".",[new e.type.Term("r",[]),new e.type.Term("[]",[])])])])])]),new e.type.Term(".",[new e.type.Var("_32547"),new e.type.Term("[]",[])]),new e.type.Var("_32548"),new e.type.Var("_32549")])),new e.type.Rule(new e.type.Term("radix_error",[new e.type.Term("uppercase",[]),new e.type.Var("_32547"),new e.type.Var("_32550"),new e.type.Var("_32551")]),new e.type.Term("format_",[new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("~",[]),new e.type.Term(".",[new e.type.Term("d",[]),new e.type.Term(".",[new e.type.Term("R",[]),new e.type.Term("[]",[])])])])])]),new e.type.Term(".",[new e.type.Var("_32547"),new e.type.Term("[]",[])]),new e.type.Var("_32550"),new e.type.Var("_32551")]))],"integer_to_radix/4":[new e.type.Rule(new e.type.Term("integer_to_radix",[new e.type.Var("I0"),new e.type.Var("R"),new e.type.Var("Which"),new e.type.Var("Cs")]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("I"),new e.type.Var("I0")]),new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("integer",[new e.type.Var("I")]),new e.type.Term("true",[])]),new e.type.Term("throw",[new e.type.Term("error",[new e.type.Term("type_error",[new e.type.Term("integer",[]),new e.type.Var("I")]),new e.type.Term("/",[new e.type.Term("integer_to_radix",[]),new e.type.Num(4,!1)])])])]),new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("integer",[new e.type.Var("R")]),new e.type.Term("true",[])]),new e.type.Term("throw",[new e.type.Term("error",[new e.type.Term("type_error",[new e.type.Term("integer",[]),new e.type.Var("R")]),new e.type.Term("/",[new e.type.Term("integer_to_radix",[]),new e.type.Num(4,!1)])])])]),new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("\\+",[new e.type.Term("between",[new e.type.Num(2,!1),new e.type.Num(36,!1),new e.type.Var("R")])]),new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term("radix_error",[new e.type.Var("Which"),new e.type.Var("R")]),new e.type.Var("Es")]),new e.type.Term("throw",[new e.type.Term("error",[new e.type.Term("domain_error",[new e.type.Term("format_string",[]),new e.type.Var("Es")]),new e.type.Term("/",[new e.type.Term("integer_to_radix",[]),new e.type.Num(4,!1)])])])])]),new e.type.Term("true",[])]),new e.type.Term(",",[new e.type.Term("digits",[new e.type.Var("Which"),new e.type.Var("Ds")]),new e.type.Term(",",[new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("<",[new e.type.Var("I"),new e.type.Num(0,!1)]),new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("Pos"),new e.type.Term("abs",[new e.type.Var("I")])]),new e.type.Term("phrase",[new e.type.Term("integer_to_radix_",[new e.type.Var("Pos"),new e.type.Var("R"),new e.type.Var("Ds")]),new e.type.Var("Cs0"),new e.type.Term(".",[new e.type.Term("-",[]),new e.type.Term("[]",[])])])])]),new e.type.Term(";",[new e.type.Term("->",[new e.type.Term("=:=",[new e.type.Var("I"),new e.type.Num(0,!1)]),new e.type.Term("=",[new e.type.Var("Cs0"),new e.type.Term(".",[new e.type.Term("0",[]),new e.type.Term("[]",[])])])]),new e.type.Term("phrase",[new e.type.Term("integer_to_radix_",[new e.type.Var("I"),new e.type.Var("R"),new e.type.Var("Ds")]),new e.type.Var("Cs0")])])]),new e.type.Term("reverse",[new e.type.Var("Cs0"),new e.type.Var("Cs")])])])])])])]))],"integer_to_radix_/5":[new e.type.Rule(new e.type.Term("integer_to_radix_",[new e.type.Num(0,!1),new e.type.Var("__32552"),new e.type.Var("__32553"),new e.type.Var("_32554"),new e.type.Var("_32555")]),new e.type.Term(",",[new e.type.Term("!",[]),new e.type.Term("=",[new e.type.Var("_32554"),new e.type.Var("_32555")])])),new e.type.Rule(new e.type.Term("integer_to_radix_",[new e.type.Var("_32556"),new e.type.Var("_32547"),new e.type.Var("_32403"),new e.type.Var("_32559"),new e.type.Var("_32562")]),new e.type.Term(",",[new e.type.Term(",",[new e.type.Term(",",[new e.type.Term("is",[new e.type.Var("_32557"),new e.type.Term("mod",[new e.type.Var("_32556"),new e.type.Var("_32547")])]),new e.type.Term(",",[new e.type.Term("nth0",[new e.type.Var("_32557"),new e.type.Var("_32403"),new e.type.Var("_32527")]),new e.type.Term("is",[new e.type.Var("_32558"),new e.type.Term("//",[new e.type.Var("_32556"),new e.type.Var("_32547")])])])]),new e.type.Term("=",[new e.type.Var("_32559"),new e.type.Var("_32560")])]),new e.type.Term(",",[new e.type.Term("=",[new e.type.Var("_32560"),new e.type.Term(".",[new e.type.Var("_32527"),new e.type.Var("_32561")])]),new e.type.Term("integer_to_radix_",[new e.type.Var("_32558"),new e.type.Var("_32547"),new e.type.Var("_32403"),new e.type.Var("_32561"),new e.type.Var("_32562")])])]))],"digits/2":[new e.type.Rule(new e.type.Term("digits",[new e.type.Term("lowercase",[]),new e.type.Term(".",[new e.type.Term("0",[]),new e.type.Term(".",[new e.type.Term("1",[]),new e.type.Term(".",[new e.type.Term("2",[]),new e.type.Term(".",[new e.type.Term("3",[]),new e.type.Term(".",[new e.type.Term("4",[]),new e.type.Term(".",[new e.type.Term("5",[]),new e.type.Term(".",[new e.type.Term("6",[]),new e.type.Term(".",[new e.type.Term("7",[]),new e.type.Term(".",[new e.type.Term("8",[]),new e.type.Term(".",[new e.type.Term("9",[]),new e.type.Term(".",[new e.type.Term("a",[]),new e.type.Term(".",[new e.type.Term("b",[]),new e.type.Term(".",[new e.type.Term("c",[]),new e.type.Term(".",[new e.type.Term("d",[]),new e.type.Term(".",[new e.type.Term("e",[]),new e.type.Term(".",[new e.type.Term("f",[]),new e.type.Term(".",[new e.type.Term("g",[]),new e.type.Term(".",[new e.type.Term("h",[]),new e.type.Term(".",[new e.type.Term("i",[]),new e.type.Term(".",[new e.type.Term("j",[]),new e.type.Term(".",[new e.type.Term("k",[]),new e.type.Term(".",[new e.type.Term("l",[]),new e.type.Term(".",[new e.type.Term("m",[]),new e.type.Term(".",[new e.type.Term("n",[]),new e.type.Term(".",[new e.type.Term("o",[]),new e.type.Term(".",[new e.type.Term("p",[]),new e.type.Term(".",[new e.type.Term("q",[]),new e.type.Term(".",[new e.type.Term("r",[]),new e.type.Term(".",[new e.type.Term("s",[]),new e.type.Term(".",[new e.type.Term("t",[]),new e.type.Term(".",[new e.type.Term("u",[]),new e.type.Term(".",[new e.type.Term("v",[]),new e.type.Term(".",[new e.type.Term("w",[]),new e.type.Term(".",[new e.type.Term("x",[]),new e.type.Term(".",[new e.type.Term("y",[]),new e.type.Term(".",[new e.type.Term("z",[]),new e.type.Term("[]",[])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])]),null),new e.type.Rule(new e.type.Term("digits",[new e.type.Term("uppercase",[]),new e.type.Term(".",[new e.type.Term("0",[]),new e.type.Term(".",[new e.type.Term("1",[]),new e.type.Term(".",[new e.type.Term("2",[]),new e.type.Term(".",[new e.type.Term("3",[]),new e.type.Term(".",[new e.type.Term("4",[]),new e.type.Term(".",[new e.type.Term("5",[]),new e.type.Term(".",[new e.type.Term("6",[]),new e.type.Term(".",[new e.type.Term("7",[]),new e.type.Term(".",[new e.type.Term("8",[]),new e.type.Term(".",[new e.type.Term("9",[]),new e.type.Term(".",[new e.type.Term("A",[]),new e.type.Term(".",[new e.type.Term("B",[]),new e.type.Term(".",[new e.type.Term("C",[]),new e.type.Term(".",[new e.type.Term("D",[]),new e.type.Term(".",[new e.type.Term("E",[]),new e.type.Term(".",[new e.type.Term("F",[]),new e.type.Term(".",[new e.type.Term("G",[]),new e.type.Term(".",[new e.type.Term("H",[]),new e.type.Term(".",[new e.type.Term("I",[]),new e.type.Term(".",[new e.type.Term("J",[]),new e.type.Term(".",[new e.type.Term("K",[]),new e.type.Term(".",[new e.type.Term("L",[]),new e.type.Term(".",[new e.type.Term("M",[]),new e.type.Term(".",[new e.type.Term("N",[]),new e.type.Term(".",[new e.type.Term("O",[]),new e.type.Term(".",[new e.type.Term("P",[]),new e.type.Term(".",[new e.type.Term("Q",[]),new e.type.Term(".",[new e.type.Term("R",[]),new e.type.Term(".",[new e.type.Term("S",[]),new e.type.Term(".",[new e.type.Term("T",[]),new e.type.Term(".",[new e.type.Term("U",[]),new e.type.Term(".",[new e.type.Term("V",[]),new e.type.Term(".",[new e.type.Term("W",[]),new e.type.Term(".",[new e.type.Term("X",[]),new e.type.Term(".",[new e.type.Term("Y",[]),new e.type.Term(".",[new e.type.Term("Z",[]),new e.type.Term("[]",[])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])]),null)],"format/2":[new e.type.Rule(new e.type.Term("format",[new e.type.Var("Fs"),new e.type.Var("Args")]),new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term("format_",[new e.type.Var("Fs"),new e.type.Var("Args")]),new e.type.Var("Cs")]),new e.type.Term("maplist",[new e.type.Term("write",[]),new e.type.Var("Cs")])]))],"format/3":[new e.type.Rule(new e.type.Term("format",[new e.type.Var("Stream"),new e.type.Var("Fs"),new e.type.Var("Args")]),new e.type.Term(",",[new e.type.Term("phrase",[new e.type.Term("format_",[new e.type.Var("Fs"),new e.type.Var("Args")]),new e.type.Var("Cs")]),new e.type.Term("maplist",[new e.type.Term("write",[new e.type.Var("Stream")]),new e.type.Var("Cs")])]))],"unique_variable_names/2":[new e.type.Rule(new e.type.Term("unique_variable_names",[new e.type.Var("Term"),new e.type.Var("VNs")]),new e.type.Term(",",[new e.type.Term("term_variables",[new e.type.Var("Term"),new e.type.Var("Vs")]),new e.type.Term("foldl",[new e.type.Term("var_name",[]),new e.type.Var("Vs"),new e.type.Var("VNs"),new e.type.Num(0,!1),new e.type.Var("_")])]))],"seq/3":[new e.type.Rule(new e.type.Term("seq",[new e.type.Term("[]",[]),new e.type.Var("_32563"),new e.type.Var("_32563")]),new e.type.Term("true",[])),new e.type.Rule(new e.type.Term("seq",[new e.type.Term(".",[new e.type.Var("_32345"),new e.type.Var("_32332")]),new e.type.Term(".",[new e.type.Var("_32345"),new e.type.Var("_32565")]),new e.type.Var("_32566")]),new e.type.Term("seq",[new e.type.Var("_32332"),new e.type.Var("_32565"),new e.type.Var("_32566")]))],"var_name/4":[new e.type.Rule(new e.type.Term("var_name",[new e.type.Var("V"),new e.type.Term("=",[new e.type.Var("Name"),new e.type.Var("V")]),new e.type.Var("Num0"),new e.type.Var("Num")]),new e.type.Term(",",[new e.type.Term(":",[new e.type.Term("charsio",[]),new e.type.Term("fabricate_var_name",[new e.type.Term("numbervars",[]),new e.type.Var("Name"),new e.type.Var("Num0")])]),new e.type.Term("is",[new e.type.Var("Num"),new e.type.Term("+",[new e.type.Var("Num0"),new e.type.Num(1,!1)])])]))]}},n=["format_/4","format/2","format/3"];"undefined"!=typeof module?module.exports=function(i){new(e=i).type.Module(r,t(),n,{dependencies:["lists","charsio"]})}:new e.type.Module(r,t(),n,{dependencies:["lists","charsio"]})}(pl),function(e){var r=function(e){e.type.Session.prototype.promiseConsult=function(e,r){return this.thread.promiseConsult(e,r)},e.type.Thread.prototype.promiseConsult=function(e,r){var t=this;return new Promise((function(n,i){var a={};r=void 0===r?{}:r,a.context_module=r.context_module,a.text=r.text,a.html=r.html,a.url=r.url,a.file=r.file,a.script=r.script,a.success=n,a.error=i,t.consult(e,a)}))},e.type.Session.prototype.promiseQuery=function(e){return this.thread.promiseQuery(e)},e.type.Thread.prototype.promiseQuery=function(e){var r=this;return new Promise((function(t,n){r.query(e,{success:t,error:n})}))},e.type.Session.prototype.promiseAnswer=function(){return this.thread.promiseAnswer()},e.type.Thread.prototype.promiseAnswer=function(){var e=this;return new Promise((function(r,t){e.answer({success:r,fail:r,error:t,limit:t})}))},e.type.Session.prototype.promiseAnswers=function(){return this.thread.promiseAnswers()},e.type.Thread.prototype.promiseAnswers=async function*(){for(;;){var e=await this.promiseAnswer();if(!1===e)return;yield e}}};"undefined"!=typeof module?module.exports=function(t){r(e=t)}:r(e)}(pl),function(e){var r=function(){return{"future/3":function(r,t,n){var i=n.args[0],a=n.args[1],o=n.args[2];if(e.type.is_variable(o))if(e.type.is_callable(a)){var s=new e.type.Future,p=new e.type.Thread(r.session),y=r.next_free_variable();r.session.renamed_variables={};var w=new e.type.Term(",",[new e.type.Term("call",[a.rename(r)]),new e.type.Term("=",[y,i.rename(r)])]);p.add_goal(w);var l={success:function(e){s.done(e.links[y.id],1)},error:function(e){s.done(e.args[0],3)},fail:function(){s.done(null,2)},limit:function(){p.answer(l)}};p.answer(l),r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[o,s])),t.substitution,t)])}else r.throw_error(e.error.type("callable",a,n.indicator));else r.throw_error(e.error.instantiation(n.indicator))},"future_done/1":function(r,t,n){var i=n.args[0];e.type.is_variable(i)?r.throw_error(e.error.instantiation(n.indicator)):e.type.is_future_object(i)?0!==i.state&&r.success(t):r.throw_error(e.error.type("future",i,n.indicator))},"await/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i))r.throw_error(e.error.instantiation(n.indicator));else{if(e.type.is_future_object(i))return i.then((function(n){r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[a,n])),t.substitution,t)]),r.again()}),(function(e){r.throw_error(e),r.again()}),(function(){r.again()})),!0;r.throw_error(e.error.type("future",i,n.indicator))}},"future_all/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i)||!e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_list(i)){for(var o=[],s=i;e.type.is_term(s)&&"./2"===s.indicator;){var p=s.args[0];if(e.type.is_variable(p))return void r.throw_error(e.error.instantiation(n.indicator));if(!e.type.is_future_object(p))return void r.throw_error(e.error.type("future",p,n.indicator));o.push(p),s=s.args[1]}if(e.type.is_variable(s))return void r.throw_error(e.error.instantiation(n.indicator));if(!e.type.is_empty_list(s))return void r.throw_error(e.error.type("list",i,n.indicator));var y=new e.type.Future;y.expected=o.length;for(var w=[],l=0;l<o.length;l++)o[l].then(function(r){return function(t){if(w[r]=t,y.expected--,0===y.state&&0===y.expected){for(var n=new e.type.Term("[]",[]),i=w.length-1;i>=0;i--)n=new e.type.Term(".",[w[i],n]);y.done(n,1)}}}(l),(function(e){y.expected--,y.done(e,3)}),(function(){y.expected--,y.done(null,2)}));r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[a,y])),t.substitution,t)])}else r.throw_error(e.error.type("list",i,n.indicator))},"future_any/2":function(r,t,n){var i=n.args[0],a=n.args[1];if(e.type.is_variable(i)||!e.type.is_variable(a))r.throw_error(e.error.instantiation(n.indicator));else if(e.type.is_list(i)){for(var o=[],s=i;e.type.is_term(s)&&"./2"===s.indicator;){var p=s.args[0];if(e.type.is_variable(p))return void r.throw_error(e.error.instantiation(n.indicator));if(!e.type.is_future_object(p))return void r.throw_error(e.error.type("future",p,n.indicator));o.push(p),s=s.args[1]}if(e.type.is_variable(s))return void r.throw_error(e.error.instantiation(n.indicator));if(!e.type.is_empty_list(s))return void r.throw_error(e.error.type("list",i,n.indicator));var y=new e.type.Future;y.expected=o.length;for(var w=0;w<o.length;w++)o[w].then((function(e){y.expected--,0===y.state&&y.done(e,1)}),(function(e){y.expected--,y.done(e,3)}),(function(){y.expected--,0===y.expected&&y.done(null,2)}));r.prepend([new e.type.State(t.goal.replace(new e.type.Term("=",[a,y])),t.substitution,t)])}else r.throw_error(e.error.type("list",i,n.indicator))}}},t=["future/3","await/2","future_done/1","future_all/2","future_any/2"],n=function(e){e.type.is_future_object=function(r){return r instanceof e.type.Future},e.type.order.push(e.type.Future),e.type.Future=function(){this.value=null,this.state=0,this.tasks=[]},e.type.Future.prototype.done=function(e,r){if(this.value=e,this.state=r,1===r)for(;this.tasks.length>0;){this.tasks.shift().resolve(this.value)}else if(3===r)for(;this.tasks.length>0;){this.tasks.shift().reject(this.value)}else if(2===r)for(;this.tasks.length>0;){this.tasks.shift().fail()}},e.type.Future.prototype.then=function(e,r,t){1===this.state?e(this.value):3===this.state?r(this.value):2===this.state?t():this.tasks.push({resolve:e,reject:r,fail:t})},e.type.Future.prototype.toString=function(e){return null!==this.value?"<future>("+this.value.toString(e)+")":"<future>(pending)"},e.type.Future.prototype.clone=function(){var r=new e.type.Future;r.state=this.state,r.value=this.value},e.type.Future.prototype.equals=function(e){return e===this},e.type.Future.prototype.rename=function(e){return this},e.type.Future.prototype.variables=function(){return[]},e.type.Future.prototype.apply=function(e){return this},e.type.Future.prototype.unify=function(r,t){return r===this?new e.type.Substitution:null},e.type.Future.prototype.interpret=function(r){return e.error.instantiation(r)},e.type.Future.prototype.compare=function(e){return this===e?0:this<e?-1:1},e.type.Future.prototype.toJavaScript=function(){if(!Promise)return null;var e=this;return new Promise((function(r,t){e.then((function(e){r(e.toJavaScript())}),(function(e){t(e.toJavaScript())}),(function(){t(!1)}))}))},e.fromJavaScript.test.promise=function(e){return Promise&&e instanceof Promise},e.fromJavaScript.conversion.promise=function(r){var t=new e.type.Future;return r.then((function(r){t.done(e.fromJavaScript.apply(r),1)})).catch((function(r){t.done(e.fromJavaScript.apply(r),3)})),t}},i=function(){return{meta_predicates:{"future/3":new e.type.Term("future",[new e.type.Term("?"),new e.type.Num(0,!1),new e.type.Term("-")])}}};"undefined"!=typeof module?module.exports=function(a){n(e=a),new e.type.Module("concurrent",r(),t,i())}:(n(e),new e.type.Module("concurrent",r(),t,i()))}(pl);
